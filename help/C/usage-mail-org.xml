<chapter id="usage-mail-organize">
    <title>Organizing and Managing your Email</title>
    <para>
      Even if you only get a few email messages a day, you probably
      want to sort and organize them.  When you get a hundred a day
      and you want to refer to a message you received six weeks ago,
      you <emphasis>need</emphasis> to sort and organize them.
      Fortunately, <application>Ximian Evolution</application> has the tools
      to help you do it.
    </para>

  <sect1 id="importing-mail-and-settings">
    <title>Importing Your Old Email and Settings</title>
    <para>
      <application>Evolution</application> allows you to import old
      email and data so that you don't need to worry about losing your
      old information.
    </para>
    <sect2 id="importing-mail">
      <title>Importing Email and Other Data</title>
      <para>
        <application>Ximian Evolution</application> can import the
        following types of files:
        <variablelist>
          <varlistentry>
            <term>VCard (.vcf, gcrd):</term>
            <listitem>
              <para>
                The addressbook format used by the GNOME, KDE, and
                many other contact management applications. You
                should be able to export to VCard format from any
                address book application.
              </para>
            </listitem>
          </varlistentry>

	  <varlistentry>
	    <term>iCalendar (.ics):</term>
	    <listitem>
	      <para>
		A format for storing calendar files.  iCalendar is used by 
		PalmOS based handhelds, Ximian
                <application>Evolution</application>, and Microsoft
		<application>Outlook</application>.
	      </para>
	    </listitem>
	  </varlistentry>

          <varlistentry>
            <term>Microsoft Outlook Express 4 (.mbx):</term>
            <listitem>
              <para>
                Email file format used by Microsoft Outlook Express
                4. For other versions of Microsoft Outlook and Outlook Express, see
                the workaround described in the note below.
              </para>
            </listitem>
          </varlistentry>

          <varlistentry>
            <term>LDAP Data Interchange Format (LDIF):</term>
            <listitem>
              <para>
                A standard data format for address book cards.
              </para>
            </listitem>
          </varlistentry>

          <varlistentry>
            <term>MBox (mbox):</term>
            <listitem>
              <para>
                The email box format used by Mozilla, Netscape,
                Ximian Evolution, Eudora, and many other email clients.
              </para>
            </listitem>
          </varlistentry>
        </variablelist>
      </para>
      <para>
        To import your old email:
        <orderedlist numeration="arabic">
          <listitem>
            <para>
              Click <menuchoice><guimenu>File</guimenu><guimenuitem>Import</guimenuitem></menuchoice>.
            </para>
          </listitem>
          <listitem>
            <para>
              Click <guibutton>Next</guibutton> after reading the Welcome screen.
            </para>
          </listitem>
          <listitem>
            <para>
              Select <guibutton>Import a single file</guibutton>.
            </para>
          </listitem>
          <listitem>
            <para>
              Find the file that you wish to import into <application>Evolution</application>.
            </para>
          </listitem>
          <listitem>
            <para>
              Click <guibutton>Import</guibutton>
            </para>
          </listitem>
        </orderedlist>
      </para>
    </sect2>
    <sect2 id="importing-preferences">
      <title>Importing Preferences</title>
      <para>
        <application>Evolution</application> can import all your old
        mail, contacts, and other information from other applications,
        making your transition to <application>Evolution</application>
        easy.
      </para>
      <para>
        To import your old information:
        <orderedlist numeration="arabic">
          <listitem>
            <para>
              Click <menuchoice><guimenu>File</guimenu><guimenuitem>Import</guimenuitem></menuchoice>.
            </para>
          </listitem>
          <listitem>
            <para>
              Click <guibutton>Next</guibutton> after reading the Welcome screen.
            </para>
          </listitem>
          <listitem>
            <para>
              Select <guibutton>Import data and settings from older programs</guibutton>.
            </para>
          </listitem>
          <listitem>
            <para>
              The left-most column shows the application which your
              information will be imported from.  You then select
              checkboxes on each component to import different
              properties of each application.
            </para>
          </listitem>
          <listitem>
            <para>
              Click <guibutton>Next</guibutton>
            </para>
          </listitem>
          <listitem>
            <para>
              Click <guibutton>Import</guibutton>
            </para>
          </listitem>
        </orderedlist>
      </para>

      <para>
	<note>
	  <title>Microsoft Outlook and Outlook Express Users</title>
	  <para>
	    Microsoft Outlook, and versions of Outlook Express after
	    version 4, use proprietary formats that <application>Ximian
	      Evolution</application> cannot read or import.  For contacts,
	    you may have to email them to yourself and import them that
	    way.  For email, there is a simpler workaround:
	    <orderedlist numeration="arabic">
	      
	      <listitem>
		<para>
		  While using Windows, import the files into Mozilla Mail (or
		  another mailer, such as Netscape or Eudora, that uses the
		  standard mbox format).
		</para>
	      </listitem>
	      
	      <listitem>
		<para>
		  Copy the files to the system or partition you use for
		  <application>Ximian Evolution</application>.  
		</para>
	      </listitem>
	      
	      <listitem>
		<para>
		  Use the <application>Ximian Evolution</application> import
		  tool to import the files.  There's more information about
		  why this works, and how, at the Ximian support website.
		</para>
	      </listitem>
	    </orderedlist>
	  </para>
	</note>     
	
	<note>
	  <title>Netscape Users</title>
	  <para>
	    Before importing mail from Netscape, make sure you select
	    <menuchoice><guimenu>File</guimenu><guimenuitem>Compact All
		Folders</guimenuitem></menuchoice>. If you don't,
	    <application>Ximian Evolution</application> will import and undelete
	    the messages in your Trash folders.
	  </para>
	</note>     
	
      </para>
      
    </sect2>
  </sect1>
  <sect1 id="usage-mail-organize-columns">
    <title>Sorting Mail with Column Headers</title>
    <para>
      By default, the message list has columns with the following
      headings: an envelope icon indicating whether you have read
      or replied to a message, an exclamation point indicating priority, and the
      <guilabel>From</guilabel>, <guilabel>Subject</guilabel>, and
      <guilabel>Date</guilabel> fields. You can change their order
      and remove them by dragging and dropping them.  
      
      To add columns:
      <orderedlist numeration="arabic">
	<listitem>
	  <para>
	    Right click on the column header
	  </para>
	</listitem>
	<listitem>
	  <para>
	    Click <guimenuitem>Add a Column</guimenuitem>
	  </para>
	</listitem>
	<listitem>
	  <para>
	    Click and drag a column you want into a space between
	    existing column headers.  A red arrow will show you where
	    the column will be placed.
	  </para>
	</listitem>
      </orderedlist>
      </para>
      <para>
	Right-click on one of the column headers to get a list of
	options:
	<variablelist>	  
	<varlistentry>
	  <term><guimenuitem>Sort Ascending</guimenuitem>:</term>
	  <listitem><para>
	      Sorts the messages top to bottom.
	    </para></listitem>
	</varlistentry>
	  
	  <varlistentry>
	    <term><guimenuitem>Sort Descending</guimenuitem>:</term>
	    <listitem><para>
		Sorts the messages bottom to top.
	      </para></listitem>
	  </varlistentry>
	  
	<varlistentry>
	  <term><guimenuitem>Remove this
	      Column</guimenuitem>:</term> 
	  <listitem>
	    <para>
	      Remove this column from the display. You can also remove
	      columns by dragging the header off the list and
	      letting it drop.  
	    </para>
	  </listitem>
	</varlistentry>
	  
	  <varlistentry>
	    <term><guimenuitem>Customize Current
	      View</guimenuitem>:</term> <listitem><para> Choose this
	      item to pick a more complex sort order for messages, or
	      to choose which columns of information about your
	      messages you wish to display
            </para></listitem>
	</varlistentry>
	</variablelist>
      </para>

      <sect2 id="usage-mail-organize-columns-followup">
        <title>Column Sorting with the Follow Up Feature</title>
        <para>
          One way to make sure you don't forget about a message is
          with the <guilabel>Follow Up</guilabel> feature. To use it,
        select one or more messages, and then right-click on one and select
        <guimenuitem>Follow Up</guimenuitem>.  A dialog box will open
        and allow you to set the type of flag and the due date.
      </para>
      <para>
        The <guilabel>Flag</guilabel> itself is the action you
        want to remind yourself about. Several are provided for you, such as
        <guilabel>Call</guilabel>, <guilabel>Forward</guilabel>, and
        <guilabel>Reply</guilabel>, but you can enter your own note or
        action if you wish. You may set a deadline date for the flag
        as well, if you wish.
      </para>
      <para>
        Once you have added a flag, you can mark it as complete or
        remove it entirely by right-clicking on the message and
        selecting <guilabel>Flag Completed</guilabel> or <guilabel>Clear
        Flag</guilabel>.
      </para>

      <para>
         When you read a flagged message, its flag status will be
         displayed right at the top, before the message headers. An
        overdue message might tell you <guilabel>Overdue: Call by April 07, 2003, 5:00 PM</guilabel>
      </para>

      <para>
        Flags can help you organize your work in a number of ways. For
        example, you might add a Flag Status column to your message
        list and sort that way. Alternately, you could create a vFolder
        that displays all your flagged messages, and clear the flags
        when you're done, so the vFolder contains only messages with
        upcoming deadlines.
      </para>

      </sect2>

    </sect1>

    <sect1 id="usage-mail-organize-folders">
      <title>Getting Organized with Folders</title>
      <para>
	<application>Ximian Evolution</application> keeps mail, as well as
	address cards and calendars, in folders.  You start out with a
	few mail folders, such as <guilabel>Inbox</guilabel>,
	<guilabel>Outbox</guilabel>, and <guilabel>Drafts</guilabel>,
	but you can create as many as you like.  Create new folders by
	selecting <guisubmenu>New</guisubmenu> and then
	<guimenuitem>Folder</guimenuitem> from the
	<guimenu>File</guimenu> menu.
	<application>Ximian Evolution</application> will as you for the name
	and the type of the folder, and will provide you with a folder
	tree so you can pick where it goes.
      </para>
      <para>
        When you click <guibutton>OK</guibutton>, your new folder will
	appear in the <interface>folder view</interface>.  You can
	then put messages in it by dragging and dropping them, or by
	using the <guibutton>Move</guibutton> button in the
	toolbar. If you want to move several messages at once, click
	on the ones you want to move while holding down the
	<keycap>Ctrl</keycap> key, or use <keycap>Shift</keycap> to
	select a range of messages.  If you create a filter with the
	<interface>filter assistant</interface>, you can have mail
	filed automatically.
      </para>

      <warning id="imap-subfolders">
        <title>Subfolders in IMAP</title>
        <para>
          The INBOX folder on most IMAP servers cannot contain both
          subfolders and messages. When you create additional folders
          on your IMAP mail server, branch them from the root of the
          IMAP account's folder, tree, not from INBOX. If you create
          subfolders in your INBOX folder, you will lose the ability
          to read messages that exist in your INBOX until you move the
          folders out of the way.
        </para>
      </warning>

  </sect1>    

  <sect1 id="usage-mail-organize-search">
    <title>Searching for Messages</title>
    <para>
      Most mail clients can search through your messages for you,
      but <application>Ximian Evolution</application> does it faster. You
      can search through just the message subjects, just the message
      body, or both body and subject.
    </para>
    <para>
      To start searching, enter a word or phrase in the text area
      right below the toolbar, and choose a search type:
      <variablelist>
	<varlistentry>
	  <term><guilabel>Body or subject contains</guilabel>:</term>
	  <listitem>
	    <para>
	      This will search message subjects and the messages
	      themselves for the word or phrase you've entered in
	      the search field.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry>
	  <term> <guilabel>Body contains</guilabel>:</term>
	  <listitem>
	    <para>
	      This will search only in message text, not the subject
	      lines.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry>
	  <term><guilabel>Subject contains:</guilabel></term>
	  <listitem>
	    <para>
	      This will show you messages where the search text is
	      in the subject line.  It will not search in the
	      message body.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry>
	  <term><guilabel>Body does not contain:</guilabel></term>
	  <listitem>
	    <para>
	      This finds every email message that does not have the
	      search text in the message body.  It will still show
	      messages that have the search text in the subject
	      line, if it is not also in the body.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry>
	  <term><guilabel>Subject does not contain:</guilabel></term>
	  <listitem>
	    <para>
	      This finds every mail whose subject does not contain
	      the search text.
	    </para>
	  </listitem>
	</varlistentry>
      </variablelist>
      
      When you've entered your search phrase, press
      <keycap>Enter</keycap>.  <application>Ximian Evolution</application>
      will show your search results in the message list.
    </para>
    
    <para>
      If you think you'll want to return to a search again, you can
      save it and execute it later. Just click <guilabel> Save
      Search</guilabel> from the <guimenu>Search</guimenu> menu. Then,
      you can run that search on any folder by selecting it from the
      <guimenu>Search</guimenu> menu. You may also want to create a
      vFolder instead; see <xref
      linkend="usage-mail-organize-vfolders" /> for more detail.
    </para>

      <para>
         When you're done with the search, go back to seeing all your
         messages by choosing <guimenuitem>Show All</guimenuitem> from
         the <guilabel>Search</guilabel> drop-down box, or enter a
         blank search.
      </para>

      <para>
        If you'd like to perform a more complex search, open the
        advanced search dialog by selecting
        <guilabel>Advanced...</guilabel> from the
        <guilabel>Search</guilabel> drop-down menu.  Then, create your
        search criteria (each with the same options you saw in the
        regular search bar), and decide whether you want to find
        messages that match all of them, or messages that match even
        one. Then, click <guibutton>Search</guibutton> to go and find
        those messages.
     </para>

     <para>
        You'll see a similar approach to sorting messages when you
        create filters and vFolders in the next few sections.
     </para>

    </sect1>

    <sect1 id="usage-mail-organize-filters">
      <title>Create Rules to Automatically Organize Mail</title>
      <para>
	Filters work very much like the mail room in a large company.
	Their purpose is to bundle, sort, and distribute mail to the
	various folders.  In addition, you can have multiple filters
	performing multiple actions that may effect the same message
	in several ways.  For example, your filters could put copies
	of one message into multiple folders, or keep a copy and send
	one to another person as well, and it can do that quickly. Of
	course, it's also faster and more flexible than an actual
	person with a pile of envelopes.
      </para>

      
	  <tip id="easy-filter">
	      <title>Quick Filter Creation</title>
	      <para>
		There is an easy shortcut for fast filter or vFolder
                creation. Right-click on the message in the message
                list, and select one of the items under the
                <guimenuitem>Create Rule from Message</guimenuitem>
                submenu.
	      </para>
	    </tip>

    <sect2 id="usage-mail-org-filters-new">
      <title>Making New Filters</title>
      <para>
	To create a new filter:
	<orderedlist numeration="arabic">
	  <listitem>
	    <para>
	      Click 
	      <menuchoice>
		<guimenu>Tools</guimenu>
		<guimenuitem>Filters</guimenuitem>
	      </menuchoice>
	    </para>
	  </listitem>
	  <listitem>
	    <para>
	      Press the <guibutton>Add</guibutton> button.
	    </para>
	  </listitem>
	  <listitem>
	    <para>
	      Name your filter in the <guilabel>Rule name</guilabel> field.
	      For each filter criterion, you must first select 
	      which of the following parts of the message you want the filter to 
	      examine:
	      
	      <itemizedlist>
		<listitem><para>
		    Sender - The sender's address.
		  </para></listitem>
		
		
		<listitem><para>
		    Recipients - The recipients of the message.
		  </para></listitem>
	  
		<listitem><para>
		    Subject - The subject line of the message.
		  </para></listitem>
		
		<listitem><para>
		    Specific Header - The filter can look at any header you
		    want, even obscure or custom ones. Enter the header name
		    in the first text box, and put your search text in the
		    second one.
        

      <note id="multiple-repeated-headers">
        <title>Repeated Headers</title>
         <para>
            If a message uses a header more than once, Evolution will
	    pay attention only to the first instance, even if the
	    message defines the header differently the second
	    time. For example, if a message declares the Resent-From:
	    header as "engineering@rupertcorp.com" and then restates
	    it as "marketing@rupertcorp.com," Evolution will filter as
	    though the second declaration had not occurred.  To filter
	    on messages that use headers multiple times, use a regular
	    expression.
         </para>
      </note>

		  </para></listitem>
		
		<listitem><para>
		    Message Body - Search in the actual text of the message.
		  </para></listitem>
		
		<listitem>
		  <para>
		    Expression - For programmers only: match a message according to an
		    expression you write in the Scheme language, used to
		    define filters in <application>Ximian Evolution</application>.
		  </para>

<para>

   <figure id="usage-mail-filter-fig-createrule">
	<title>Creating a Mail Filter</title>
	<screenshot>
	  <screeninfo>Creating a Mail Filter</screeninfo>
	    <mediaobject>
	      <imageobject>
		<imagedata fileref="figures/filter-new-fig" format="PNG"
			   srccredit="Aaron Weber"/>
	      </imageobject>
	    </mediaobject>
	  </screenshot>
	</figure>

      <note id="lots-of-filters">
        <title>What if Multiple Filters Match One Message?</title>
         <para>
            If you have several filters that match a single message,
            they will all be applied to the message, in order, unless
            one of the filters has the action <guibutton>Stop
            Processing</guibutton>. If you use that action in a
            filter, the messages that it affects will not be touched
            by other filters.
         </para>
         <para>
           When you first open the filters dialog, you are shown the
           list of filters sorted in the order in which they will be
           applied. You can move them up and down in the priority list
           by clicking the <guibutton>Up</guibutton> and
           <guibutton>Down</guibutton> buttons.
         </para>
      </note>
</para>
		</listitem>
	

	
		<listitem><para> Date sent - Filter messages according to the date on
		    which they were sent: First, choose the conditions you
		    want a message to meet -- <guilabel>before</guilabel>
		    a given time, <guilabel>after</guilabel> it, and so forth.
		    Then, choose the time. The filter will compare the
		    message's time-stamp to the system clock when the filter
		    is run, or to a specific time and date you choose from a
		    calendar.  You can even have it look for messages within a
		    range of time relative to the filter -- perhaps you're
		    looking for messages less than two days old.
		  </para></listitem>
		
		<listitem><para>
		    Date Received - This works the same way as the <guilabel>Date Sent</guilabel> 
		    option, except that it compares the time you got the message 
		    with the dates you specify.
		  </para></listitem>
		
		<listitem><para>
        Score - Set the message score to any whole number greater than
        0.  To use filters with scoring, use one filter to score a
        message, and then apply other filters only to messages with
        the scores you seek.
		  </para></listitem>
		
		<listitem>
		  <para>
		    Size (kb) - Sorts based on the size of the message in kilobytes.
		  </para>
		</listitem>

		<listitem>
		  <para>
		    Status - Filters according to the status of a message, such as
		    'New'.
		  </para>
		</listitem>
		
		<listitem>
		  <para>
		    Attachments - Create a filter based on whether or not you 
		    have an attachment in the email.
		  </para>
		</listitem>
		
		<listitem>
		  <para>
		    Mailing List - Filter based on the mailing list it came from.
		  </para>
		  <note>
		    <title>How Does Filtering on Mailing Lists Work?</title>
		    <para>
		      Filtering on mailing list actually looks for a
		      specific mailing-list header called the
		      <computeroutput>X-BeenThere</computeroutput>
		      header, used to identify mailing lists or other
		      redistributors of mail.
		    </para>
		  </note>
		</listitem>
		
		<listitem>
		  <para>
		    Expression - If you know your way around a
		    <glossterm
		    linkend="regular-expression">regex</glossterm>, or
		    regular expression, put your knowledge to use
		    here. This allows you to search for complex
		    patterns of letters, so that you can find, for
		    example, all words that start with a and ends with
		    m, and are between six and fifteen letters long,
		    or all messages that declare a particular header
		    twice. For information about how to use regular
		    expressions, check the manual page for the
		    <command>grep</command> command.
		  </para>
		</listitem>
		
		<listitem>
		  <para>
		    Source Account - Filter messages according the server you got them from.
		    You can enter a URL or choose one from the drop-down
		    list.  This ability is only relevant if you use more
		    than one mail source.
		  </para>
		</listitem>
	      </itemizedlist>
	    </para>
	  </listitem>
	  <listitem>
	    <para>
	      Select the criterion for the condition.   If you want multiple
	      criteria for this filter, press <guibutton>Add
		criterion</guibutton> and repeat the previous step.
	    </para>
	  </listitem>
	  <listitem>
	    <para>
	      Select the actions for the filter in the <guilabel>Then</guilabel>
	      section.  You can select any of the following options.
	      <itemizedlist>
		<listitem><para>
		    Move to Folder - If you select this item, <application>Ximian Evolution</application>
		    will put the messages into a folder you specify.  Click the 
		    <guibutton>&lt;click here to select a folder&gt;</guibutton> button
		    to select a folder. 
		  </para></listitem>

		<listitem><para>
		    Copy to Folder - If you select this item, <application>Ximian Evolution</application>
		    will put the messages into a folder you specify.  Click the 
		    <guibutton>&lt;click here to select a folder&gt;</guibutton> button
		    to select a folder. 
		  </para></listitem>
		
		<listitem><para>
		    Forward to Address - Select this, enter an address, and the addressee will
		    get a copy of the message.
		  </para></listitem>

		<listitem><para>
		    Delete - Marks the message for deletion.  You can still get the message
		    back, at least until you <guimenuitem>Expunge</guimenuitem> your
		    mail yourself.
		  </para></listitem>
		
		<listitem><para>
		    Stop Processing - Select this if you want to tell all other filters to ignore 
		    this message, because whatever you've done with it so far
		    is plenty.
		  </para></listitem>
		
		<listitem><para>
		    Assign Color - Select this item, and <application>Ximian Evolution</application>
		    will mark the message with whatever color you please.
		  </para></listitem>
		
		<listitem><para> 
		    Assign Score - If you know that all mail with
		    "important" somewhere in the message body line is
		    important, you can give it a high priority score. In a subsequent filter you can 
		    then arrange your messages by their priority score.
		  </para></listitem>
	      </itemizedlist>
	    </para>
	  </listitem>
	  <listitem>
	    <para>
	      Set Status - If you want to add multiple actions for this filter, press
	      <guibutton>Add action</guibutton> and repeat the previous step.
	    </para>
	  </listitem>
	  <listitem>
	    <para>
	      Press <guibutton>OK</guibutton>.
	    </para>
	  </listitem>
	</orderedlist>
      </para>
      
      <note id="when-filters-go-wrong">
        <title>When Are Filters Applied?</title>
         <para>
           If you use Ximian Connector to store your mail on an
           Exchange server, filters are not applied until you open
           your INBOX folder and select
           <menuchoice><guimenu>Actions</guimenu><guimenuitem>Apply
           Filters</guimenuitem></menuchoice> or press
           <keycombo><keycap>Ctrl</keycap><keycap>Y</keycap></keycombo>
         </para>
      </note>

      <example id="filter-example">
         <title>Using a Filter to Avoid Spam</title>
         <para>
           Spam, also known as unsolicited commercial email (UCE), is
           the bane of many people's Inboxes, but it doesn't have to
           be. Using Ximian Evolution filters and an external Spam
           detection tool like SpamAssassin (<ulink
           url="http://spamassassin.org/">http://spamassassin.org/</ulink>),
           you can catch the vast majority of junk mail and drop it
           directly into the trash.
         </para>
         <para>
           The easiest way to do this is to get your system
           administrator to install SpamAssassin (or its equivalent)
           on your mail server. There, it will flag messages it
           suspects of being Spam with the "X-Spam-Status" header to
           your mail, which you can then search for in a
           filter. Because SpamAssassin scores mails based on the
           likelihood that messages are junk, you can even choose how
           strict you want it to be. If you don't have a friendly
           network administrator, never fear: you can install
           SpamAssassin on your own system, then pipe messages through
           it before reading them.
         </para>

         <para>
           If your system administrator or ISP has SpamAssassin, here's how to siphon off the junk mail:
            <orderedlist>

             <listitem><para>
                 Select <menuchoice><guimenu>Tools</guimenu><guimenuitem>Filters</guimenuitem></menuchoice>.
             </para></listitem>

             <listitem><para>
                 Click <guibutton>Add</guibutton>.
             </para></listitem>

             <listitem><para>
               Set the first part of your search criterion to look in a <guilabel>Specific header</guilabel>.
             </para></listitem>

             <listitem><para>
               Enter <userinput>X-Spam-Flag</userinput> as the name of the header.
             </para></listitem>

             <listitem><para>
               Choose <guilabel>contains</guilabel> at the second drop-down box.
             </para></listitem>

             <listitem><para>
               Enter <userinput>YES</userinput> as the content to search for. 
               You're now working with all email that has the word "YES" in the 
               "X-Spam-Status" header.
             </para></listitem>

             <listitem><para>
               For actions, choose what you'd like to do with the
             messages. You can delete the messages automatically, but
             it's more prudent to place them in a "Possible Junk Mail"
             folder, and check them over just to make sure a genuine
             message didn't get flagged by accident.
             </para></listitem>

             <listitem><para>
                Click OK. You're done.
             </para></listitem>
	   </orderedlist>
         </para>
         <para>
           If you don't have SpamAssassin or other junk mail filtering
           on your mail server, there's still hope, although it's not
           quite as simple. First, download
           and install SpamAssassin from <ulink
           url="http://spamassassin.org">http://spamassassin.org</ulink>
         You'll need to download the "spamassassin"
         and "perl-Mail-SpamAssassin"
         packages, and you can install them with Red Carpet by
         selecting <guimenuitem>Install Local Packages</guimenuitem>
         from the
         <guimenu>File</guimenu> menu. Further instructions are at the
         SpamAssassin web site. Once you have the software
         installed, do the following: 

         <orderedlist>
           <listitem>
           <para>
             Open a new create a text file with any text editor (
             <menuchoice>
               <guimenu>
                 Programs
               </guimenu>
               <guisubmenu>
                 Accessories
               </guisubmenu>
               <guimenuitem>
                 Text Editor
               </guimenuitem>
             </menuchoice> is the most convenient) and paste in the following:
             <screen>
               spamassassin -e
             </screen>
             This will run the SpamAssassin command and report back 0
             if the message is not junk.
           </para>
         </listitem>
         <listitem>
           <para>
             Save the file as "spam-filter.sh"
           </para>
         </listitem>
         <listitem>
           <para>
              Mark the file as an executable program: 
             Open your home directory in Nautilus, right-click on
             spam-filter.sh there, and select
             <guimenuitem>Properties</guimenuitem>. Then, click the
             "Permissions" tab and check the box in the
             <guilabel>Execute</guilabel> column and the
             <guilabel>Owner</guilabel> row. Alternately, open a terminal
             (<menuchoice>
             <guimenu>
               Programs
             </guimenu>
             <guisubmenu>
               Accessories
             </guisubmenu>
             <guimenuitem>
               Terminal
             </guimenuitem>
           </menuchoice>) and enter the command: chmod +x spam-filter.sh.
       </para>
     </listitem>
     <listitem>
       <para>
          Back in Evolution, create a new filter: Select
         <menuchoice><guimenu>Tools</guimenu><guimenuitem>Filters</guimenuitem></menuchoice>,
         then click <guibutton>Add</guibutton>.
     </para>
   </listitem>

             <listitem><para> 
             Select "Pipe Message to Shell Command" as the first portion of the criterion.
               </para></listitem>

             <listitem><para> 
             Enter "/home/username/spam-filter.sh" as the shell command, then select
             "Does Not Return" and "0" as the remaining two
             items. Substitute your username for "username" so that
             Evolution can find the script.
           </para></listitem>

             <listitem><para>
               For actions, choose what you'd like to do with the
             messages. You can delete the messages automatically, but
             it's more prudent to place them in a "Possible Junk Mail"
             folder, and check them over just to make sure a genuine
             message didn't get flagged by accident.
             </para></listitem>
           <listitem>
             <para>
               You're done. Click "OK" to close the filter and "OK" to
               close the filter editor.
             </para>
           </listitem>
         </orderedlist>
       </para>
     </example>
   </sect2>
   
   <sect2 id="filters-edit">
      <title>Editing Filters</title>
      <para>
	To edit a filter:
	<orderedlist numeration="arabic">
	  <listitem>
	    <para>
	      Select
	      <menuchoice>
		<guimenu>Tools</guimenu>
		<guimenuitem>Filters</guimenuitem>
	      </menuchoice>
	    </para>
	  </listitem>
	  <listitem>
	    <para>
	      Select the filter in the <guilabel>Filter Rules</guilabel> section
	      and press <guibutton>Edit</guibutton>.
	    </para>
	  </listitem>
	  <listitem>
	    <para>
	      Change the desired settings.
	    </para>
	  </listitem>
	  <listitem>
	    <para>
	      Press <guibutton>OK</guibutton> in the filter editor window.
	    </para>
	  </listitem>
	  <listitem>
	    <para>
	      Press <guibutton>OK</guibutton> in the filter manager window.
	    </para>
	  </listitem>
	</orderedlist>
      </para>
    </sect2>
    
    <sect2 id="filters-deleting">
      <title>Deleting Filters</title>
      <para>
	To delete a filter:
	<orderedlist numeration="arabic">
	  <listitem>
	    <para>
	      Select
	      <menuchoice>
		<guimenu>Tools</guimenu>
		<guimenu>Filters</guimenu>
	    </menuchoice>
	    </para>
	  </listitem>
	  <listitem>
	    <para>
	      Select the filter and press <guibutton>Delete</guibutton>.
	    </para>
	  </listitem>
	</orderedlist>
      </para>
      <para>
	<note>
	  <title>Changing Folder Names and Filters</title>
	  <para>
	    <itemizedlist>
	      <listitem>
		<para>
		  Incoming email that your filters don't move goes
		  into the Inbox; outgoing mail that they don't move
		  ends up in the Sent folder.  So be sure to change
		  the filters that go with it.
		</para>
	      </listitem>
	    </itemizedlist>
	  </para>
	</note>
      </para>
    </sect2>
  </sect1>
    
    <sect1 id="usage-mail-organize-vfolders">
      <title>Getting Really Organized with vFolders</title>
      <para>
	If filters aren't flexible enough for you, or you find
	yourself performing the same search again and again, consider
	a vFolder. vFolders, or virtual folders, are an advanced way
	of viewing your email messages within
	<application>Ximian Evolution</application>.  If you get a lot of
	mail or often forget where you put messages, vFolders
	can help you stay on top of things.
      </para>
      <para>
	A vFolder is really a hybrid of all the other organizational
	tools: it looks like a folder, it acts like a search, and you
	set it up like a filter.  In other words, while a conventional
	folder actually contains messages, a vFolder is a view of
	messages that may be in several different folders.  The
	messages it contains are determined on the fly using a set of
	criteria you choose in advance.
      </para>

      <para>
	As messages that meet the vFolder criteria arrive or are
	deleted, <application>Ximian Evolution</application> will
	automatically place them in and remove them from the
	vFolder contents list.  When you delete a message, it gets
	erased from the folder in which it actually exists, as well as
	any vFolders which display it.
      </para>

      <para>
	Imagine a business trying to keep track of mail from hundreds
	of vendors and clients, or a university with overlapping and
	changing groups of faculty, staff, administrators and
	students.  The more mail you need to organize, the less you
	can afford the sort of confusion that stems from an
	organizational system that's not flexible enough.  vFolders
	make for better organization because they can accept
	overlapping groups in a way that regular folders and filing
	systems can't.
      </para>


    <note id="unmatched-vfolder">
      <title>The "Unmatched" vFolder</title>
      <para>
	 The Unmatched vFolder is the mirror of all your other
         vFolders: it displays whatever messages are not matched by
         other vFolders.
      </para>
      <para>
        If you use remote email storage like IMAP or Microsoft
        Exchange, and have created vFolders to search through them,
        the Unmatched vFolder will follow your lead, and search the
        remote folders as well. If you do not create any vFolders that
        search in remote mail stores, the Unmatched vFolder will not
        search in them either.
      </para>
    </note>


    <example id="usage-mail-organize-vfolders-ex">
      <title>Using Folders, Searches, and vFolders</title>
      <para>
	To organize his mailbox, Jim sets up a virtual folder for emails from
	his friend and co-worker Anna.  He has another one for messages that
	have ximian.com in the address and <application>Ximian Evolution</application> in the subject line, so he
	can keep a record of what people from work send him about
	<application>evolution</application>.  If Anna sends him a message about
	anything other than <application>Ximian Evolution</application>, it only shows up in the "Anna" folder.
	When Anna sends him mail about the user interface for
	<application>evolution</application>, he can see that message both in
	the "Anna" vFolder and in the "Internal Evolution Discussion"
	vFolder.
       </para>
      </example>

	<!--  (INSERT SCREENSHOT HERE: vFolders in action) -->

    <sect2 id="vfolder-create">
      <title>Creating vFolders</title>
      <para>
	To create a vFolder:
	<orderedlist numeration="arabic">
	  <listitem>
	    <para>
	    <menuchoice>
	      <guimenu>Tools</guimenu>
	      <guimenuitem>Virtual Folder Editor</guimenuitem>
	    </menuchoice>
	    </para>
	  </listitem>
	  <listitem>
	    <para>
	      Click <guibutton>Add</guibutton>
	    </para>
	  </listitem>
	  <listitem>
	    <para>
	      Name your vFolder in the <guilabel>Rule name</guilabel> field.

	    </para>
	  </listitem>
	  <listitem>
	    <para>
	      Select your search criteria. For each criterion, you
	      must first select which of the following parts of the
	      message you want the search to examine:

      <figure id="usage-mail-vfolder-fig-createrule">
	<title>Selecting a vFolder Rule</title>
	<screenshot>
	  <screeninfo>Creating a vFolder Rule</screeninfo>
	    <mediaobject>
	      <imageobject>
		<imagedata fileref="figures/vfolder-createrule-fig" format="PNG"
			   srccredit="Aaron Weber"/>
	      </imageobject>
	    </mediaobject>
	  </screenshot>
	</figure>
      </para>
       <para>
	      <itemizedlist>
		<listitem><para>
		    Sender - The sender's address.
		  </para></listitem>
		
		
		<listitem><para>
		    Recipients - The recipients of the message.
		  </para></listitem>
	  
		<listitem><para>
		    Subject - The subject line of the message.
		  </para></listitem>

<!--		No, can't vfolder on arbitrary headers
		<listitem><para>
		    Specific Header - The vFolder can look at any header you
		    want, even obscure or custom ones. Enter the header name
		    in the first text box, and put your search text in the
		    second one.
		  </para></listitem>
-->	

		<listitem><para>
		    Message Body - Search in the actual text of the message.
		  </para></listitem>
		
		<listitem>
		  <para>
		    Expression - For programmers only: match a message according to an
		    expression you write in the Scheme language, used to
		    define vFolders in <application>Ximian Evolution</application>.
		  </para>
		</listitem>
		
		<listitem><para> Date sent - Search messages according to the date on
		    which they were sent: First, choose the conditions you
		    want a message to meet -- <guilabel>before</guilabel>
		    a given time, <guilabel>after</guilabel> it, and so forth.
		    Then, choose the time. The vFolder will compare the
		    message's time-stamp to the system clock when the filter
		    is run, or to a specific time and date you choose from a
		    calendar.  You can even have it look for messages within a
		    range of time relative to the filter -- perhaps you're
		    looking for messages less than two days old.
		  </para></listitem>
		
		<listitem><para>
		    Date Received - This works the same way as the <guilabel>Date Sent</guilabel> 
		    option, except that it compares the time you got the message 
		    with the dates you specify.
		  </para></listitem>
		
		<listitem><para>
		    Label - This works the same way as the <guilabel>Score</guilabel> 
		    option, although it allows you to select from various labels applied to the message,
                such as <guilabel>Important, Personal, To Do,
                Work</guilabel> or <guilabel>Later</guilabel>.
		  </para></listitem>
		
		<listitem><para>
		    Score - Emails have a standard priority range from -3 (least
		    important) to 3 (most important). You can have vFolders set the
		    priority of messages you receive, and then have other
		    vFolders 
		    applied only to those messages which have a certain priority.
		  </para></listitem>
		
		<listitem>
		  <para>
		    Size (kb) - Sorts based on the size of the message in kilobytes.
		  </para>
		</listitem>
		
		<listitem>
		  <para>
		    Status - Searches according to the status of a message, such as
		    'New'.
		  </para>
		</listitem>
		
		<listitem>
		  <para>
		    Attachments - Create a vFolder based on  whether or not you have an
		    attachment in the email.
		  </para>
		</listitem>
		
		<listitem>
		  <para>
		    Mailing List - Search based on the mailing list it came from.
		  </para>
		</listitem>
		
		<listitem>
		  <para>
		    Source Account - Search messages according the server you got them from.
		    You can enter a URL or choose one from the drop-down
		    list.  This ability is only relevant if you use more
		    than one mail source.
		  </para>
		</listitem>
	      </itemizedlist>
	    </para>
	  </listitem>
	  <listitem>
	    <para>
	      Select the folder sources.  You can select:
	      <itemizedlist>
		<listitem>
		  <para>
		    Specific folders only
		    <note>
		      <para>
			If you select specific folders only, you need to specify the
			source folders in the box below.
		      </para>
		    </note>
		  </para>
		</listitem>
		<listitem>
		  <para>
		    With all local folders
		  </para>
		</listitem>
		<listitem>
		  <para>
		    With all active remote folders
		  </para>
		</listitem>
		<listitem>
		  <para>
		    With all local and active folders
		  </para>
		</listitem>
	      </itemizedlist>
	      
	    </para>
	  </listitem>
	</orderedlist>
      </para>
      <para>
	Remote folders are considered active if you are connected to the
	server; you must be connected to your mail server for the vFolder to
	include any messages from that source.
      </para>
   
    </sect2>
  </sect1>
</chapter>
