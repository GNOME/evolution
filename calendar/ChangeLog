2003-12-09  Rodrigo Moya <rodrigo@novell.com>

	* gui/e-calendar-view.c (on_unrecur_appointment): keep a local copy
	of the ECal.

2004-12-08  Hans Petter Jansson  <hpj@novell.com>

	* gui/e-meeting-list-view.c
	* gui/e-select-names-editable.c
	* gui/dialogs/alarm-dialog.c
	* gui/dialogs/e-delegate-dialog.c: Include <libebook/e-destination.h>
	from evolution-data-server.

2004-12-08  Harish Krishnaswamy <kharish@novell.com>
	
	* gui/e-week.c (time_range_changed_cb, e_week_view_set_first_day_shown):
	update the query so currently held events can be cleared off.

2004-12-08  David Mosberger <davidm@napali.hpl.hp.com>

	* gui/main.c: include plugin headers to fix 64 bit problems.

2004-12-06  Rodrigo Moya <rodrigo@novell.com>

	Fixes #67403

	* gui/dialogs/event-page.c (sensitize_widgets): don't unsensitize
	the 'Customize' button, to allow users to look at the alarm list
	for read only events.

	* gui/dialogs/alarm-list-dialog.c (sensitize_buttons): unsensitize
	buttons if the event is read only.

2004-12-02  Chenthill Palanisamy  <pchenthill@novell.com>

	* gui/dialogs/task-editor.[ch] (task_editor_new), (task_editor_construct),
	(show_assignment):
	Add a boolean variable to denote assigned task and construct the 
	meeting page only for the assigned task. Set it as a group item
	in component editor.
	(_TaskEditorPrivate): added the boolean variable (is_assigned).
	(task_editor_init): initialized the variable.
	* gui/dialogs/comp-editor.[ch]: Added functions to set and get whether comp
	 is a group item or individual item.
	* gui/comp-editor.c (make_title_from_string), (make_title_from_comp):
	Set the Title for the appointment editor window as "Meeting" or "Assigned
	Task" if its a group calendar/task item.
	(_CompEditorPrivate): added a boolean variable (is_group_item).
	(comp_editor_init): initialized the same.
	* gui/dialogs/event-editor.c (event_editor_construct), (show_meeting): Set whether
	the component is a group item or not in comp editor.
	* gui/e-calendar-table.c (e_calendar_table_open_task), (e_calendar_table_open_selected),
	(open_task_by_row): Check whether the component being opened is an assigned task by
	checking for attendees and call open_task with proper value for boolean variable assign.
	* gui/comp-editor-factory.c (edit_existing):
	* gui/e-calendar-table.c (open_task):
	* gui/e-tasks.c (e_tasks_new_task):
	* gui/gnome-cal.c (gnome_calendar_new_task):
	* gui/tasks-component.c (create_new_todo):
	Called the function task_editor_new with a added argument.

2004-12-02  Chenthill Palanisamy  <pchenthill@novell.com>

	* gui/e-day-view.c (e_day_view_finish_resize), (e_day_view_reshape_day_event)
       	(e_day_view_change_event_time): Free the string day_view->last_edited_comp_string
	before changing assigning it another value.
	* gui/e-week-view.c (e_week_view_change_event_time): Free the string
	week_view->last_edited_comp_string for the same reason above.
	
2004-11-29  Chenthill Palanisamy  <pchenthill@novell.com>

	* calendar-errors.xml.h: committng this file. Missed to
	commit this one.

2004-11-29  Chenthill Palanisamy  <pchenthill@novell.com>
	
	* gui/dialogs/comp-editor.c (response_cb): Moved the call
	for the warning dialog (send_component_prompt_subject) after 
	the component is saved (save_comp_with_send). 
	
2004-11-26  JP Rosevear  <jpr@novell.com>

	* gui/alarm-notify/alarm-queue.c (display_notification): ditto

	* gui/e-timezone-entry.c (e_timezone_entry_init): get the image
	directly from the icon factory

2004-11-26  JP Rosevear  <jpr@novell.com>
	
	* gui/alarm-notify/alarm-queue.c (display_notification): prevent
	crash if there is no description

2004-11-25  Harish Krishnaswamy  <kharish@novell.com>

	* gui/calendar-component.c: 
	(new_calendar_cb), (edit_calendar_cb): Use modified_setup_edit_calendar call.
	(popup_event_cb): If source is null (Rt click on a source group), show the new 
	calendar popup menu item. Else, do not show the new calendar option. 
	* gui/dialogs/calendar-setup.[ch] (eccp_get_source_type): Compare the
	source_groups by their uid and not the pointers, so that the correct option
	is activated on the combo box.
	(calendar_setup_edit_calendar) : add a source_group parameter to the function.
	(calendar_setup_new_calendar): Use modified signature of the above function.
	* gui/e-calendar-view.c (on_edit_appointment): check the icalcomponent
	to see if it is a meeting and set the argument to e_calendar_view_edit_appointment
	correctly.

2004-11-25  Chenthill Palanisamy  <pchenthill@novell.com>
		
	* gui/dialogs/event-deitor.c (show_meeting): removed the
	call for comp_editor_show_page, so that the event page
	shows up at first instead of meeting page when a meeting
	is opened.

2004-11-25  Chenthill Palanisamy  <pchenthill@novell.com>

	* calendar-errors.xml: Added two error ids to display use
	it when the meeting is created without a summary.
	* gui/dialogs/send-comp.[ch] (send_component_prompt_subject): Added a 
	function to prompt for a dialog when a meeting/assigned task is sent 
	without a summary.
	* gui/dialogs/comp-editor.c (response_cb): Called the above mentioned
	function when the summary is not present.
	
2004-11-23  Rodney Dawes  <dobey@novell.com>

	* gui/alarm-notify/alarm-notify-dialog.[ch]:
	Add gtkimage.h to includes, and remove gtkhtml headers
	Add and remove some widgets in the AlarmNotify struct
	(dialog_destroy_cb, delete_event_cb, close_clicked_cb):
	(snooze_clicked_cb, edit_clicked_cb, url_requested_cb):
	(make_html_display, write_times, write_html_heading):
	(alarm_notify_dialog_disable_buttons): 
	Remove all these unneeded functions (no more GtkHTML in the dialog)
	(alarm_notify_dialog): Add description and location arguments
	Rename message argument to summary
	Update gtk-doc comment block to reflect API changes
	Clean up code to use gtk_dialog_run () and use a HIG compliant dialog

	* gui/alarm-notify/alarm-notify.glade: Update the alarm notify
	dialog to be HIG compliant and not use GtkHTML, and display more
	information that is relevant to the appointment we are alerting of

	* gui/alarm-notify/alarm-queue.c: Add new variables to the
	TrayIconData structure so we can access the description and location
	(on_dialog_objs_removed_cb): Remove alarm_dialog bits
	(notify_dialog_cb): Remove alarm_dialog bits
	(tray_icon_destroyed_cb): Free the description and location as well
	(open_alarm_dialog): alarm_notify_dialog does all the work now, we
	don't need to trap the dialog widget here
	(display_notification): Add code to get the description and location
	information from the cal component
	Avoid using an alarm component which has less useful API
	Fix a warning when creating the tray_icon widget
	
2004-11-15  Not Zed  <NotZed@Ximian.com>

	* gui/dialogs/Makefile.am (libcal_dialogs_la_LIBADD): add
	libeabutil, since we use e-destination.

2004-11-08  Rodney Dawes  <dobey@novell.com>

	* gui/alarm-notify/alarm-notify-dialog.c (write_html_heading):
	Don't try to convert the results of timet_to_str_with_zone to UTF-8,
	since the return value is already encoded in UTF-8

	Fixes #47529

2004-11-04  Rodrigo Moya <rodrigo@novell.com>

	* gui/dialogs/event-page.glade:
	* gui/dialogs/task-page.glade: expand the horizontal box so that it
	fills all available space.

2004-11-03  David Trowbridge  <trowbrds@cs.colorado.edu>

	* gui/e-cal-config.c: added EConfig subclass for calendars
	* gui/calendar-component.c, gui/tasks-component.c: initialize
	  plugin hooks on component startup.
	* gui/dialogs/calendar-setup.c: Converted to use EConfig

2004-11-04  Li Yuan  <li.yuan@sun.com>

	Fixes #6767

	* gui/e-day-view-main-item.c:
	(e_day_view_main_item_draw_day_event):
	use widget->style instead of hard code colors.
	* gui/e-day-view.c: (e_day_view_realize), (e_day_view_set_colors),
	(e_day_view_style_set), (e_day_view_reshape_long_event),
	(e_day_view_reshape_day_event):
	ditto.
	* gui/e-week-view.c: (e_week_view_realize),
	(e_week_view_set_colors), (e_week_view_style_set),
	(e_week_view_reshape_event_span):
	ditto.

2004-11-02  JP Rosevear  <jpr@novell.com>

	* gui/e-day-view-config.c (set_twentyfour_hour): make sure the day
	view times redraw themselves if we switch 24/12 hour modes

2004-11-02  JP Rosevear  <jpr@novell.com>
	
	Fixes #68707
	
	* gui/e-week-view-event-item.c (e_week_view_event_item_draw):
	restrict the range to 0-23 (midnight end times became '24')

2004-10-28  Not Zed  <NotZed@Ximian.com>

	* gui/tasks-component.c (popup_event_cb): 
	* gui/e-calendar-view.c (e_calendar_view_create_popup_menu): 
	* gui/e-calendar-table.c (e_calendar_table_show_popup_menu):
	* gui/calendar-component.c (popup_event_cb): added hook doco.

2004-10-27  Rodrigo Moya <rodrigo@novell.com>

	* gui/e-cal-list-view.c (e_cal_list_view_new): don't expand recurrences
	for the list view.

2004-10-21  Harish Krishnaswamy  <kharish@novell.com>

	* gui/e-cal-popup.[ch]: (e_cal_popup_target_new_source):
	Add status bits to denote if the calendar source is available offline
	so that plugins to calendar popups can use the status qualifier to denote 
	their visibility preferences.

2004-10-21  Rodrigo Moya <rodrigo@novell.com>

	* gui/dialogs/select-source-dialog.c: use the new source selector
	dialog in libedataserverui.

2004-10-20  JP Rosevear  <jpr@novell.com>

	* gui/calendar-component.c: put an icon on the properties menu item

	* gui/tasks-component.c: ditto
	
	* gui/main.c (initialize): register plugin hooks for tasks and
	calendar

2004-10-20  JP Rosevear  <jpr@novell.com>
	
	* gui/e-cal-popup.c (ecalph_class_init): correct classid

2004-10-19  JP Rosevear  <jpr@novell.com>

	* gui/calendar-component.c, gui/e-cal-menu.c, gui/e-cal-popup.c,
	gui/e-calendar-table.c, gui/e-calendar-view.c, gui/gnome-cal.c,
	gui/tasks-component.c, gui/alarm-notify/alarm-queue.c,
	gui/dialogs/meeting-page.c: convert to org.gnome hook names

2004-10-19  Harish Krishnaswamy  <kharish@novell.com>

	* gui/comp-editor-factory.c: (edit_existing):
	Use e_cal_component_has_attendees to test if it is a meeting.
	* gui/dialogs/event-editor.c: (event_editor_init):
	By default, the event is not a meeting.
	(event_editor_construct): Do not add the invitation, scheduling pages
	to the editor if it is not a meeting. 
	* gui/e-day-view.c: (e_day_view_on_event_double_click):
	check the icalproperty to test if the event is a meeting.
	
2004-10-19  JP Rosevear  <jpr@novell.com>

	* gui/gnome-cal.c (connect_list_view_focus): listen to the canvas
	for focus events
	(setup_widgets): listen for listen view selection changes

	* gui/e-cal-list-view.c (setup_e_table): listen for the cursor to
	move
	(e_cal_list_view_cursor_change_cb): indicate the selection changed

2004-10-19  Harish Krishnaswamy  <kharish@novell.com>

	* gui/calendar-component.c (create_new_event):
	* gui/e-calendar-view.c: (e_calendar_view_edit_appointment):
	* gui/comp-editor-factory.c (edit_existing), (edit_new):
	* gui/dialogs/event-editor.c (event_editor_edit_comp),
	 (event_editor_new): updated the calls to event_editor_new 
	with additional argument.
	* gui/dialogs/event-editor.h: add parameter is_meeting to
	distinguish between events and  meetings.
	* gui/dialogs/meeting-page.c: (sensitize_widgets):
	use explicit GError variable so that BUSY_ERROR
	conditions do not lead us to think the calendar is readonly.
	* gui/e-meeting-store.c: (refresh_queue_remove), (ems_init),
	(e_meeting_store_remove_attendee), (freebusy_async),
	(refresh_busy_periods), (refresh_queue_add): Make free-busy calls 
	to backends async. Fixed the problem of spurious attendees getting 
	added to the refresh_data.
	
2004-10-14  Not Zed  <NotZed@Ximian.com>

	* gui/e-cal-menu.c (e_cal_menu_target_new_select): dont access a
	NULL client.

	* gui/gnome-cal.c (gnome_calendar_get_taskpad_menu)
	(gnome_calendar_get_calendar_menu): accessors to get the menu
	managers.
	(gnome_calendar_init): setup menu managers.

2004-10-13  Not Zed  <NotZed@Ximian.com>

	* gui/calendar-commands.c (calendar_control_activate)
	(calendar_control_deactivate): activate and deactivate the
	calendar and taskpad menu handlers.
	(sensitize_items): helper to sensitise items based on target
	masks.
	(calendar_control_sensitize_calendar_commands): update the
	calendar menu manager target appropriately.
	(sensitize_taskpad_commands): same for the taskpad.

	* gui/e-cal-menu.[ch]: Targets for main menu management.

	* gui/e-cal-popup.c (e_cal_popup_target_new_select): fix cast.
	Also include the tasks stuff in the hook metadata.

2004-10-15  JP Rosevear  <jpr@novell.com>

	* gui/calendar-commands.c (calendar_control_activate): remove
	useless ifdef'd out statement (its been unused for 3+ years)
	
2004-10-15  JP Rosevear  <jpr@novell.com>
	
	* gui/calendar-commands.h (calendar_goto_today): remove prototype

	* gui/calendar-commands.c: remove dead function

2004-10-14  JP Rosevear  <jpr@novell.com>

	* gui/e-meeting-attendee.c: convert to G_DEFINE_TYPE

	* gui/e-meeting-list-view.c: ditto

	* gui/e-meeting-time-sel.c: ditto

	* gui/e-meeting-time-sel-item.c: ditto

	* gui/e-select-names-renderer.c: ditto

	* gui/e-timezone-entry.c: ditto

	* gui/e-tasks.c: ditto

	* gui/gnome-cal.c: ditto

	* gui/weekday-picker.c: ditto

2004-10-14  JP Rosevear  <jpr@novell.com>
	
	* gui/e-cell-date-edit-config.c: convert to G_DEFINE_TYPE

	* gui/e-cell-date-edit-text.c: ditto

	* gui/e-comp-editor-registry.c: ditto

	* gui/e-date-edit-config.c: ditto

	* gui/e-mini-calendar-config.c: ditto

2004-10-14  JP Rosevear  <jpr@novell.com>
	
	* gui/e-cal-list-view-config.c: convert to G_DEFINE_TYPE

	* gui/e-cal-list-view.c: ditto

	* gui/e-cal-model-calendar.c: ditto

	* gui/e-cal-model-tasks.c: ditto

	* gui/e-cal-model.c: ditto

	* gui/e-calendar-table-config.c: ditto

	* gui/e-calendar-table.c: ditto

	* gui/e-calendar-view.c: ditto

2004-10-14  JP Rosevear  <jpr@novell.com>
	
	* gui/calendar-view.c: convert to G_DEFINE_TYPE

	* gui/calendar-view-factory.c: ditto

	* gui/cal-search-bar.c: ditto

	* gui/e-cal-component-preview.c: ditto

2004-10-14  JP Rosevear  <jpr@novell.com>
	
	* gui/e-week-view-config.c: convert to G_DEFINE_TYPE

	* gui/e-week-view-event-item.c: ditto

	* gui/e-week-view-main-item.c: ditto

	* gui/e-week-view-titles-item.c: ditto

	* gui/e-week-view.c: ditto

2004-10-14  JP Rosevear  <jpr@novell.com>
	
	* gui/e-day-view.c: convert to G_DEFINE_TYPE
	
	* gui/e-day-view-config.c: ditto

	* gui/e-day-view-main-item.c: ditto

	* gui/e-day-view-time-item.c: ditto

	* gui/e-day-view-top-item.c: ditto

2004-10-14  JP Rosevear  <jpr@novell.com>
	
	* gui/dialogs/comp-editor.c: convert to G_DEFINE_TYPE
	
	* gui/dialogs/meeting-page.c: ditto

	* gui/dialogs/recurrence-page.c: ditto

	* gui/dialogs/schedule-page.c: ditto

	* gui/dialogs/e-delegate-dialog.c: ditto

	* gui/dialogs/event-editor.c: ditto

	* gui/dialogs/task-editor.c: ditto

	* gui/dialogs/task-details-page.c: ditto

	* gui/dialogs/select-source-dialog.c
	(primary_selection_changed_cb): fix warning
	
2004-10-13  JP Rosevear  <jpr@novell.com>

	* gui/dialogs/task-page.c: ditto

	* gui/calendar-component.h: remove e-source-selector include

	* gui/tasks-component.h: ditto
	
	* gui/calendar-component.c: update include to libedataserverui for
	source selector and option menus
	
	* gui/e-cal-popup.c: ditto

	* gui/dialogs/url-editor-dialog.h: ditto

	* gui/dialogs/select-source-dialog.c: ditto

	* gui/tasks-component.c: ditto

	* importers/icalendar-importer.c: ditto
	
	* gui/e-itip-control.c: ditto; use G_DEFINE_TYPE instead of
	E_MAKE_TYPE
	
	* gui/dialogs/event-page.c: ditto	

	* gui/dialogs/task-page.c: ditto
	
2004-10-12  Li Yuan  <li.yuan@sun.com>

	* gui/e-day-view.c: (e_day_view_on_main_canvas_button_press):
	* gui/e-week-view.c: (e_week_view_on_button_press):
	If main_canvas has focus, do not grub it. Emit the 
	selected_time_changed signal after the selection day changed.

2004-10-12  Not Zed  <NotZed@Ximian.com>

	* gui/dialogs/meeting-page.c (button_press_event): convert menu to
	epopup.

2004-10-12  Not Zed  <NotZed@Ximian.com>

	* gui/e-calendar-table.c (setup_popup_icons): removed.
	(e_calendar_table_show_popup_menu): convert to use e-popup for
	pluggable popup menu.
	(e_calendar_table_on_open_task, e_calendar_table_on_save_as)
	(e_calendar_table_on_print_task, e_calendar_table_on_cut)
	(e_calendar_table_on_copy, e_calendar_table_on_paste)
	(e_calendar_table_on_assign, e_calendar_table_on_forward)
	(delete_cb):
	(mark_as_complete_cb, open_url_cb): convert to epopup callbacks.
	Moved all of the callbacks above the table rather than maintaining
	forward declarations for some of them.

	* gui/e-cal-popup.c (e_cal_popup_target_new_select): add the task
	required masks, and make one vs many mutally exclusive.

	* gui/e-calendar-view.c (e_calendar_view_create_popup_menu):
	copy/setup the event list here.

	* gui/e-cal-popup.c (e_cal_popup_target_new_select): take model +
	events rather than the calendar view.

2004-10-12  Li Yuan  <li.yuan@sun.com>

	* gui/calendar-commands.c:
	(calendar_get_text_for_folder_bar_label):
	When the start year and the end year are the same, the num should
	be displayed in start time.
	* gui/dialogs/alarm-dialog.glade:
	Add names to comboxes in alarm-dialog page.
	* gui/dialogs/cal-prefs-dialog.glade:
	Add labbled_by relation for e_date_edit.
	Add names to comboxes in general tab and display tab.
	Add shortcut keys to start_of_day_label and end_of_day_label.
	* gui/dialogs/event-page.c: (init_widgets):
	Use the default text_buffer of gtk_text_view instead of
	creating one.
	* gui/dialogs/event-page.glade:
	Add labbled_by relation for e_date_edit.
	* gui/dialogs/meeting-page.glade:
	Set an atk name for organizer widget.
	* gui/dialogs/task-page.c: (init_widgets):
	Use the default text_buffer of gtk_text_view instead of
	creating one.
	* gui/dialogs/task-page.glade:
	Add labbled_by relation for e_date_edit.
	Add a11y names to task description and categories.
	* gui/e-alarm-list.c: (e_alarm_list_iter_n_children):
	Remove the iter checker. The iter can't have a valid value at this time.
	* gui/e-date-time-list.c: (e_date_time_list_iter_n_children):
	Remove the iter checker. The iter can't have a valid value at this time.
	* gui/e-meeting-time-sel.c: (e_meeting_time_selector_construct):
	Add labbled_by relation for e_date_edit.
	* gui/e-timezone-entry.c: (e_timezone_entry_class_init),
	(e_timezone_entry_init), (e_timezone_entry_mnemonic_activate),
	(e_timezone_entry_focus):
	Add a focus handler for e-timezone-entry. Set an atk name for the
	button.
	* gui/e-week-view.c: (e_week_view_do_cursor_key_up),
	(e_week_view_do_cursor_key_down), (e_week_view_do_cursor_key_left),
	(e_week_view_do_cursor_key_right), (e_month_view_do_cursor_key_up),
	(e_month_view_do_cursor_key_down),
	(e_month_view_do_cursor_key_left),
	(e_month_view_do_cursor_key_right):
	Emit the selected_time_changed signal after the selection day changed.

2004-10-11  Not Zed  <NotZed@Ximian.com>

	* gui/alarm-notify/alarm-queue.c (tray_icon_clicked_cb): convert
	to epopup.
	(add_popup_menu_item): removed, now redundant.

2004-10-08  Rodrigo Moya <rodrigo@novell.com>

	Fixes #45951

	* gui/dialogs/event-page.glade:
	* gui/dialogs/task-page.glade: attach the description field correctly
	to the table so that it scrolls correctly instead of making the dialog
	bigger as you write.

	* gui/dialogs/comp-editor.c (setup_widgets): no need to create an extra
	GtkVBox, just use the GtkDialog's one.

2004-10-07  JP Rosevear  <jpr@novell.com>

	* gui/dialogs/cal-prefs-dialog.c: remove useless include

	* gui/dialogs/url-editor-dialog.c: ditto
	
2004-10-07  JP Rosevear  <jpr@novell.com>
	
	* gui/print.c: guard config.h

	* gui/tasks-control.c: guard config.h, remove useless include

	* gui/migration.c: remove useless include

	* gui/main.c: remove useless include

	* gui/e-calendar-view.h: #define the type

	* gui/calendar-offline-handler.c: remove useless include

	* gui/calendar-config.c: tidy header

2004-10-07  JP Rosevear  <jpr@novell.com>
	
	* gui/calendar-commands.c: guard config.h include, kill warning
	and remove useless include

2004-10-06  Rodrigo Moya <rodrigo@novell.com>

	Fixes #65932

	* common/authentication.c: keep a hash table of all the source lists.
	(auth_new_cal_from_uri): do a search in the source list for the given
	URI, and use that ESource if we find it. Also, keep the hash table of
	source lists up to date.

	* gui/comp-editor-factory.c (cal_opened_cb): don't assert on error
	cases, just display an error dialog.

2004-10-06  Not Zed  <NotZed@Ximian.com>

	* gui/gnome-cal.c (gnome_calendar_setup_view_popup): rename to
	view_popup_factory.  Make it build an epopup item list directly.
	Can't re-use the galview cruft :-/
	(gnome_calendar_discard_view_popup): no longer needed.
	(gc_set_view, gc_save_custom_view, gc_define_views_response) 
	(gc_define_views): implement the gal-view popup menu items.

	* gui/gnome-cal.h:
	* gui/e-week-view.h:
	* gui/e-day-view.h:
	* gui/e-cal-list-view.h: removed old e-popup-menu header.

	* gui/e-calendar-view.c (setup_popup_icons): removed.
	(e_calendar_view_create_popup_menu): converted to use e-popup.
	(on_paste, on_copy, on_cut, on_delete_occurrence) 
	(on_unrecur_appointment, on_delete_appointment, on_publish) 
	(on_forward, on_meeting, on_move_to, on_copy_to, on_print_event) 
	(on_save_as, on_print, on_edit_appointment, on_goto_today) 
	(on_goto_date, on_new_task, on_new_meeting, on_new_event) 
	(on_new_appointment): convert to use e-popup stuff.

	* gui/tasks-component.c (popup_event_cb): e-popup api changes.

	* gui/e-cal-popup.c (e_cal_popup_target_new_select): implement the
	selection target.
	(ecalp_target_free): and free it.

	* gui/e-cal-model.h: Make the ECalModel struct non-anonymous so it
	can be forward-declared.

	* gui/calendar-component.c (popup_event_cb): e-popup api changes.

2004-10-06  Rodrigo Moya <rodrigo@novell.com>

	Revert fix for #60551

	* gui/dialogs/task-page.c (task_page_fill_component): start date
	can be after the due date, no need to compare.

2004-10-02  Iván Frade <frade@asturlinux.org>

	Fixes #48116

	* gui/dialogs/task-details.page.c (task_details_page_fill_component):
	Validation: completed date is not a future date.
	
2004-10-01  Not Zed  <NotZed@Ximian.com>

	* gui/tasks-component.c (create_component_view): cast warning
	away.
	(create_component_view): connect to popup_event rather than
	fill_popup_menu.

	* gui/calendar-component.c (create_component_view): cast a warning
	away.

	* calendar-errors.xml: add prompt-delete-task-list.

	* gui/tasks-component.c (fill_popup_menu_cb): renamed to
	popup_event_cb, make use e-cal-popup.
	(edit_task_list_cb, new_task_list_cb, delete_task_list_cb) 
	(copy_task_list_cb): deja-vu.  update for api.
	(add_popup_menu_item): killed. murdered. drawn and quatered.
	(delete_task_list_cb): use e-error for the delete prompt.

	* gui/calendar-component.c (create_component_view): hook onto
	popup event instead of fill_popup_menu.

	* calendar-errors.xml: added prompt-delete-calendar.

	* gui/calendar-component.c (fill_popup_menu_cb): rename to
	popup_event_cb, make use e-cal-popup.
	(edit_calendar_cb, new_calendar_cb, delete_calendar_cb) 
	(copy_calendar_cb): fix for api changes.
	(add_popup_menu_item): removed.
	(delete_calendar_cb): use e-error for the delete thing.

	* gui/e-cal-popup.[ch]: calendar popup driver.

2004-09-29  Rodrigo Moya <rodrigo@novell.com>

	Fixes #64683

	* gui/e-meeting-time-sel.c (e_meeting_time_selector_construct): create
	a scrolled window for the attendees list, and synchronize it with the
	scrolling in the F/B area.

2004-09-28  Not Zed  <NotZed@Ximian.com>

	** See bug #66736.

	* gui/e-itip-control.c (e_itip_control_set_data): noop if we were
	destroyed (priv == null).

2004-09-28  JP Rosevear  <jpr@novell.com>
 
 	Fixes #61766
 	
 	* gui/migration.c (create_calendar_contact_source): set a color
 	for the contacts
 	(create_calendar_sources): set a color for the personal source and
 	make in primary and default if nothing else is either
 	(create_task_sources): ditto for tasks personal source
	
2004-09-24  Rodrigo Moya <rodrigo@novell.com>

	Fixes #65599

	* gui/itip-utils.c (comp_fb_normalize): don't use NULL properties.

	* gui/e-pub-utils.c (e_pub_publish): use auth_new_cal_from_source()
	instead of auth_new_cal_from_uri().

2004-09-24  JP Rosevear  <jpr@novell.com>

	Fixes #64955, Vincent Noel <vnoel@cox.net>
	
	* libecal/e-cal.c (e_cal_get_alarms_in_range): fix c99-ism

2004-09-24  JP Rosevear  <jpr@novell.com>
 
 	Fixes #66344
 
 	* gui/e-cal-model-calendar.c (get_dtend): check for existence of
 	property and null time instead of sending through bad data
 
 	* gui/e-cal-model.c (get_dtstart): ditto
 
 	* gui/e-cal-model-tasks.c (get_completed): ditto
 	(get_due): ditto

2004-09-24  Chenthill Palanisamy  <pchenthill@novell.com>

	Fixes #63513
	* gui/e-itip-control.c
	(ok_clicked_cb): Now the myaddress can be set to ecal address
	since ok will be sentized only when ecal is loaded.

2004-09-22  JP Rosevear  <jpr@novell.com>

	* gui/calendar-component.c (fill_popup_menu_cb): ditto

	* gui/tasks-component.c (fill_popup_menu_cb): don't allow a delete
	of the system calendar

2004-09-21  JP Rosevear  <jpr@novell.com>
 
 	Fixes #60904
 	
 	* gui/gnome-cal.c (set_week_start): update the view
 	(get_times_for_views): mimic the work week guessing code exactly
 	for calculating the time range needed instead of hardcoding 5 days
 	(set_working_days): new routine to update the view
 	(working_days_changed_cb): use above when getting config change
 	notification
 	(setup_config): set working days and add notification
	
2004-09-21  JP Rosevear  <jpr@novell.com>
 
 	Fixes #66158
 	
 	* gui/e-cal-model-tasks.c (e_cal_model_tasks_mark_task_complete):
 	notify of change so completion status updates immediately
	
2004-09-21  JP Rosevear  <jpr@novell.com>
 
	Fixes #59194
 	
 	* gui/e-cal-model-calendar.c (get_location): return "" instead of
 	NULL
	
2004-09-21  Chenthill Palanisamy  <pchenthill@novell.com>

	Fixes #65682
	* gui/itip-utils.c 
	(itip_send_comp): check the static capability before
	booking the deletion.

2004-09-15  JP Rosevear  <jpr@novell.com>
 
 	Fixes #55172
 	
 	* conduits/calendar/calendar-conduit.c (local_record_from_comp):
 	handle -1 (last) for monthly recurrences and check both by_set_pos
 	and by_day since either can indicate this type of recurrence
	
2004-09-20  Tony Tsui <ttsui9@gmail.com>

	Fixes #66174

	* gui/dialogs/meeting-page.c (existing_attendee): fixed memory leak.

2004-09-10   Hannah & Fazlu <hannah_lins@yahoo.co.in>

	Fixes bug #65051

	* calendar/gui/dialogs/task-page.c (task_page_fill_component):
	Compared the dates and time

2004-09-10  Rodrigo Moya <rodrigo@novell.com>

	Fixes #62374

	* gui/alarm-notify/alarm-queue.c (load_missed_alarms): removed this
	function.
	(cal_opened_cb): no need to call load_missed_alarms,
	load_alarms_for_today will do everything.
	(alarm_queue_add_client): ditto.
	(load_alarms_for_today): take into account the last saved notification
	time.
	(load_alarms): unref the previous query, this function should now
	only be called once per time range.

2004-09-09  JP Rosevear  <jpr@novell.com>
 
 	Fixes #65454
 	
 	* gui/e-itip-control.c (class_init): only use a destroy function,
 	no finalize
 	(cleanup_ecal): util function
 	(init): use above for hash table and killed destroyed flag
 	(weren't using it anywhere)
 	(destroy): collapse finalize work into here and guard against
 	multiple destroy calls

2004-09-08  JP Rosevear  <jpr@novell.com>

	Fixes #62728
	
	* gui/e-week-view.c (e_week_view_set_week_start_day): trigger a
	redraw when changing the start day

2004-09-05  Chenthill Palanisamy  <pchenthill@novell.com>

	* gui/e-calendar-table.c
	(e_calendar_table_show_popup_menu): Check the
	static capability to enable or disable the assign
	tasks in the popup menu.

	* gui/dialogs/recurrence-page.c
	(sensitize_buttons): Check for the static capability
	to convert a existing appointment to recurrence appointment
	for enabling or diabling the recurrence widgets.

2004-08-31  Rodrigo Moya <rodrigo@novell.com>

	Fixes #62392

	* gui/alarm-notify/alarm-queue.c (display_notification): ref the
	client's query object so that it doesn't disappear on us.
	(tray_icon_destroyed_cb): unref the query previously ref'ed.

2004-08-31  Rodrigo Moya <rodrigo@novell.com>

	* gui/e-cal-model-tasks.c: include missing string.h, to avoid
	problems in 64 bit builds.
	
2004-08-27  Not Zed  <NotZed@Ximian.com>

	* common/authentication.c (auth_func_cb): constify the strings to
	remove a warning.

	** See bug #64856 (workaround).

	* common/authentication.c (auth_func_cb): 
	* gui/e-pub-utils.c(e_pub_publish): add ONLINE flag to password
	request.

2004-08-28  JP Rosevear  <jpr@novell.com>

	* gui/e-itip-control.c (rsvp_clicked_cb): get the active state
	(insert_rsvp): set inital rsvp state

	* gui/alarm-notify/alarm-queue.c (alarm_queue_add_client): load
	immediately if they are loaded

2004-08-27  Rodrigo Moya <rodrigo@novell.com>

	* gui/alarm-notify/alarm-queue.c (load_alarms): use the
	new 'has-alarms-in-range' query.
	(alarm_queue_add_client): make sure we don't add twice the same alarm.

2004-08-27  JP Rosevear  <jpr@novell.com>

	Fixes #62911, #54101
	
	* gui/e-itip-control.c (set_ok_sens): util routine to set
	sensitivity of OK button
	(cal_opened_cb): cal back when calendar opens, sensitize ok button
	(start_calendar_server): open async and take call back arg
	(source_selected_cb): desensitize ok button until calendar is
	loaded
	(find_cal_opened_cb): check to see if the calendar contains the
	object we are looking for, if none do show the source selector
	option menu
	(find_server): search async for the server
	(destroy): clean up html widget
	(finalize): instead of here
	(get_publish_options): use only object tag
	(get_request_options): ditto
	(get_request_fb_options): ditto
	(get_reply_options): ditto
	(get_refresh_options): ditto
	(get_cancel_options): ditto
	(show_current_event): use new options, remove groupwise NEEDS
	ACTION check, handle async loading
	(show_current_todo): use new options, handle async loading
	(option_activated_cb): record action
	(add_option): add action item
	(insert_boxes): layout widgets
	(insert_label): insert label
	(rsvp_clicked_cb): record rsvp status
	(insert_rsvp): insert rsvp check box
	(insert_ok): insert ok button
	(publish_options_object): spit out relevant options
	(request_options_object): ditto
	(freebusy_options_object): ditto
	(reply_options_object): ditto
	(refresh_options_object): ditto
	(cancel_options_object): ditto
	(object_requested_cb): handle object requests
	(ok_clicked_cb): use recorded actions

2004-08-27  JP Rosevear  <jpr@novell.com>
	
	* gui/alarm-notify/alarm-notify.h: update proto

	* gui/alarm-notify/alarm-notify.c (list_changed_cb): use per
	source type client hash
	(alarm_notify_init): ditto
	(alarm_notify_finalize): ditto
	(cal_opened_cb): ditto
	(alarm_notify_add_calendar): ditto
	(alarm_notify_remove_calendar): ditto, take source_type arg
	(load_calendars_cb): don't call list_changed if the source list is
	NULL
	
2004-08-26  Christian Neumair  <chris@gnome-de.org>

	* gui/GNOME_Evolution_Calendar.server.in.in:
	Don't mark component menu accels for translation.

2004-08-25  JP Rosevear  <jpr@novell.com>

	* conduits/todo/todo-conduit.c (for_each): prepare the local
	record correctly, should fix copy to/from problems when syncing

	* conduits/calendar/calendar-conduit.c (for_each): ditto

2004-08-25  Frederic Crozat  <fcrozat@mandrakesoft.com>

	* gui/dialogs/recur-comp.c: (recur_component_dialog):
	Don't call gtk_dialog_set_has_separator on Gtk Message Dialog
        with GTK+ >= 2.4.0.

2004-08-25  Chenthill Palanisamy  <pchenthill@novell.com>

	* gui/e-tasks.c
	(default_client_cal_opened_cb): Reset the Status Bar message to
	NUll, if the status of the Calendar is returned OK.

2004-08-24  Rodrigo Moya <rodrigo@novell.com>

	Fixes #58824

	* gui/gnome-cal.c (open_ecal): Only try to open the calendar if not
	loaded yet.
	(update_query, client_cal_opened_cb, default_client_cal_opened_cb,
	backend_died_cb): use always the same view for status messages.
	(gnome_calendar_set_activity_handler): set the activity handlers on
	all views, not just the current one.
	(display_view): no need to set the activity handler here.

2004-08-13  Jeffrey Stedfast  <fejj@novell.com>

	* gui/dialogs/event-page.glade: Make the description scrolled
	window scroll policy "automatic" rather than "never". Fixes bug
	#62063.

2004-08-18  Sivaiah Nallagatla <snallagatla@novell.com>

	* gui/alarm-notify/alarm-notify.c (alarm-notify_init) :
	initialize the mutext needed to prevent concurrect access 
	priv->uri_clients_hash. Also install a timeout handler for
        loading sources which requires  auth later
	(alarm_notify_finalize) : free the new mutex
	(load_calendars_cb) : call back which adds sources again after
	one minute
	(alarm_notify_add_calendar) : lock ad unlock the new mutex
	before and after accessing uri_clients_hash  

2004-08-16  JP Rosevear  <jpr@ximian.com>

	Fixes #62706
	
	* gui/e-cal-model.c (e_cal_model_set_timezone): set the default
	timezone on the server

2004-08-16  Sivaiah Nallagatla <snallagatla@novell.com>
	
	* gui/alarm-notify/alarm-notify.h : change the prototype of 
	alarm_notify_add_calendar to take Esource instead of uri 

	* gui/alarm-notify/alarm-notify.c (alarm_notify_add_calendar) :
	use auth_new_cal_from_source instead of _from_uri to create cal
	client also do not try to load the cal backend which require auth
	and for which there is no password availble in e-password seesion
        (list_changed_cb) (load_calendars) : pass Esource insted of uri to
	alarm_notify_add_calendar
	 
2004-08-14  Sivaiah Nallagatla <snallagatla@novell.com>

	* gui/e-tasks.c (e_tasks_init) : initialize priv->default_lcient
        (default_client_cal_opened_cb) : unref priv->default_client and
	make it NULL
	(client_cal_opened_cb) : don't unref client explicitly as removing
	from priv->clients already does that.  Remove client based on uid
	instead of uri
	(backend_died_cb) : Remove client based on uid insted of uri Fixes
	#62869

2004-08-12  JP Rosevear  <jpr@ximian.com>

	* gui/dialogs/calendar-setup.glade: make the button say Add Task
	List instead of Add Group (matches menu item)

2004-08-12  Carlos Garnacho Parro  <carlosg@gnome.org>

	* gui/dialogs/alarm-dialog.glade: added the property
	"use_filechooser" to the GnomeFileEntry

2004-08-10  Not Zed  <NotZed@Ximian.com>

	* gui/e-pub-utils.c (e_pub_publish): 
	* common/authentication.c (auth_func_cb): epasswords api change.

2004-08-11  JP Rosevear  <jpr@ximian.com>

	Fixes #61555
	
	* gui/dialogs/meeting-page.c (existing_attendee): check if an
	attendee was pre-existing
	(remove_attendee): only add the attendee to the cancel comp if it
	was pre-existing

2004-08-10  Rodrigo Moya <rodrigo@novell.com>

	* gui/e-cal-model.c (e_cal_model_set_search_query): guard against
	re-running the same query.

2004-08-10  Rodrigo Moya <rodrigo@novell.com>

	* gui/alarm-notify/alarm-queue.c (tray_icon_destroyed_cb): disconnect
	from signals also when using only the system tray. Fixes a crash when
	removing an event that had an alarm popup recently.

2004-08-09  Rodrigo Moya <rodrigo@novell.com>

	* gui/e-calendar-view.c: re-added 'Make this occurrence movable' menu
	item, gone by mistake.
	(on_unrecur_appointment): new callback for the new menu item.

2004-08-06  JP Rosevear  <jpr@ximian.com>
 
	Fixes #62452
 	
	* gui/e-itip-control.c (find_my_address): take option to retrieve
	current status as well, actually look for the delegator in the
	list so we can retrieve status there as well
	(show_current_event): use find_my_address to get the status so we
	properly handle not finding the address in the list of attendees
	(show_current): pass extra param
	(ok_clicked_cb): ditto

2004-08-06  JP Rosevear  <jpr@ximian.com>
 
	Fixes #62021
 	
	* gui/dialogs/event-page.c (source_changed_cb): set the default
	timezone
 
	* gui/e-itip-control.c (start_calendar_server): set the default
	timezone
 
	* gui/calendar-component.c (setup_create_ecal): set the default
	timezone, as the component view is not alive and hence has not set
	it

	* gui/tasks-component.c (setup_create_ecal): ditto

2004-08-05  Parthasarathi S A   <sparthasarathi@novell.com>

	Fix for bug #61673.
	* calendar/gui/dialogs/save_comp.c(save_component_dialog):
	  The function takes two arguments now, instead of one. The second
	  argument is the pointer to the ECalComponent from which the component
	  type can be determined. Based on the component type the corresponding
	  error message is displayed.
	* calendar/gui/dialogs/save_comp.h:
	  Function definition updated for save_component_dialog.
	* calendar/gui/dialogs/comp_editor.c(prompt_to_save_changes):
	  passing the ECalComponent pointer to the 'save_component_dialog' function
	* calendar/calendar-errors.xml: New error message string for task included
	* calendar/calendar-errors.xml.h

2004-08-05  Rodrigo Moya <rodrigo@novell.com>

	Fixes #62030

	* gui/alarm-notify/alarm-queue.c (tray_icon_destroyed_cb):
	only remove the tray icon blinking timeout if we installed
	it.
	(display_notification): only install the tray icon blinking
	timeout if using the system tray.
	(tray_icon_blink_cb): use g_object_unref instead of the
	deprecated gdk_pixbuf_unref.

	* gui/alarm-notify/alarm.c (alarm_add): added missing argument
	documentation.

2004-08-03  JP Rosevear  <jpr@novell.com>
 
	* gui/gnome-cal.c (gnome_calendar_destroy): clean up all the
 	default clients
 	(default_client_cal_opened_cb): change the if statement to a
 	switch to be consistent with the other code bits and set the
 	default client for the source type
 	(gnome_calendar_add_source): look at the default based on the
 	source type
 	(gnome_calendar_set_default_source): set the default for the
 	source type
 	(gnome_calendar_new_task): bail out if we have no ecal
 
	* gui/gnome-cal.c (set_timezone): set the timezone for all the
 	default clients
 
	* gui/calendar-component.c (update_primary_task_selection): look
	in the task source list, not the plain source list
	
2004-08-05  JP Rosevear  <jpr@novell.com>

	* gui/tasks-control.c (tasks_control_sensitize_commands): kill
 	warning by checking if there is a default client first (can happen
 	when first starting up)
	
2004-08-05  JP Rosevear  <jpr@novell.com>

	Fixes #62363
	
	* gui/calendar-component.c (create_new_event):
	commit the sequence

2004-08-04  Harish Krishnaswamy  <kharish@novell.com>

	* gui/e-itip-control.c: (ok_clicked_cb): Handle decline request by
	using update_item rather than remove_item, so the backend receives
	the notification and can handle it. Also, do not rsvp if the backend
	has the 'save_schedule' capability.

2004-08-01  JP Rosevear  <jpr@novell.com>
 
 	* conduits/todo/todo-conduit.c (todoconduit_load_configuration):
 	get source list and source
 	(todoconduit_dupe_configuration): copy source list and source
 	(todoconduit_destroy_configuration): unref source list and source
 	(start_calendar_server): open the source that was set earlier
 	(fill_widgets): set the source option menu value
 	(create_settings_window): pass source list to pilot settings
 	(save_settings): mark source with pilot-sync property

 	* conduits/calendar/calendar-conduit.c: as above
 	
 	* conduits/todo/Makefile.am: link to and include misc. widgets
 
 	* conduits/calendar/Makefile.am: ditto	
	
2004-07-30  Rodrigo Moya <rodrigo@novell.com>

	Fixes #57622

	* gui/e-cal-model.h: added ECalModelFlags enum type.

	* gui/e-cal-model.c (e_cal_model_set_flags, e_cal_model_get_flags):
	new functions.
	(e_cal_model_init): initialize the new internal field to keep the flags.
	(e_cal_view_objects_added_cb): expand recurrences if the model flags
	contain the EXPAND_RECUR bit.
	(e_cal_view_objects_modified_cb): if EXPAND_RECUR is on, remove all
	recurrences and regenerate them.
	(e_cal_view_objects_removed_cb): remove all instances for given UIDs.
	(add_new_client): killed warning.
	(get_dtstart): use the instance_start time when dealing with recurrences.

	* gui/e-cal-model-calendar.c (get_dtend): use the instance_end time
	when dealing with recurrences.

	* gui/e-cal-list-view.c (e_cal_list_view_new): set the EXPAND_RECUR
	flag on the model for the list view.

	* gui/e-week-view.c (e_week_view_add_event):
	* gui/e-day-view.c (e_day_view_add_event): fill in the instance's
	start and end times in the ECalModelComponent struct.

	* gui/e-calendar-view.c (e_calendar_view_delete_selected_occurrence):
	use the instance_start field to retrieve the RECUR-ID, now that all the
	views fill it in.

2004-07-29  JP Rosevear  <jpr@novell.com>
 
 	* gui/e-calendar-view.c: creating new items no longer needs to be
 	disabled since the user can switch to a writable calendar and the
 	editor ui is disabled properly
	
2004-07-31  JP Rosevear  <jpr@novell.com>
 
 	* gui/dialogs/event-editor.c (show_meeting): use Invitations not
 	Meetings
 	(event_editor_edit_comp): ditto
	
2004-07-31  JP Rosevear  <jpr@novell.com>

	* gui/e-day-view.c (e_day_view_finish_long_event_resize): guard
	with is_instance instead of has_recurrences because most of the
	backends don't support this yet
	(e_day_view_finish_resize): ditto
	(e_day_view_change_event_time): ditto
	(e_day_view_on_editing_stopped): ditto
	(e_day_view_on_top_canvas_drag_data_received): ditto
	(e_day_view_on_main_canvas_drag_data_received): ditto

	* gui/e-week-view.c (e_week_view_change_event_time): ditto
	(e_week_view_on_editing_stopped): ditto
	
2004-07-30  Harish Krishnaswamy  <kharish@novell.com>
	
	* gui/e-tasks.c: (client_cal_opened_cb),
	(default_client_cal_opened_cb):
	* gui/gnome-cal.c: (client_cal_opened_cb),
	(default_client_cal_opened_cb):
	Handle E_CALENDAR_STATUS_BUSY conditions and do not 
	remove the source from the gnome-calendar. The fix
	for #59335 exposed this problem.

2004-07-28  Larry Ewing  <lewing@novell.com>

	* gui/dialogs/calendar-setup.c (dialog_hide_unused_options): hide
	dialog items that don't apply when editing properties.
	(general_update_dialog): check to make sure we have a source
	before checking its state.

2004-07-27  JP Rosevear  <jpr@novell.com>

	Fixes #62006
	
	* gui/e-cal-model.c (add_new_client): don't load the events if we
	are already doing the query

2004-07-25  JP Rosevear  <jpr@ximian.com>
 
 	Fixes #61058
 	
 	* gui/e-week-view.c (process_component_recur_cb): add but don't
 	prepend
 	(process_component): use above as call back so we can pass the
 	prepend bool
 	(e_week_view_add_event): take a prepend bool and prepend to the
 	events array if asked so the event will be shown first when drawn
 	(e_week_view_do_key_press): If the event can't be fit on the
 	screen, ie not even one event can be shown in the day, don't try
 	to edit it
	
2004-07-26  Rodney Dawes  <dobey@novell.com>

	* gui/dialogs/event-page.glade: Fix mnemonic for "Location" to not
	be duplicated with "OK"

	* gui/dialogs/meeting-page.c (get_widgets): Get the "Attendees" label
	(meeting_page_construct): Fix padding of GtkScrolledWindow widget
	Set the mnemonic widget for the "Attendees" label

	* gui/dialogs/meeting-page.glade: Fix HIG spacing to be correct
	Fix the mnemonic for "Organizer" to not conflict
	Add mnemonic for "Attendees"

	* gui/dialogs/task-page.glade: Add mnemonic for "Description"

2004-07-26  JP Rosevear  <jpr@novell.com>
 
 	* gui/dialogs/calendar-setup.c (calendar_setup_edit_calendar): set
 	a different title if we are editing; de-sensitize option menu if
 	we are editing
 	(calendar_setup_edit_task_list): set a different title if we are editing
 
 	* gui/dialogs/calendar-setup.glade: use task list instead of tasks
 	group
 
 	* gui/tasks-component.c (impl__get_userCreatableItems): add
 	assigned task as an item, use task list instead of tasks group
 
 	* gui/calendar--component.c (impl__get_userCreatableItems): fiddle
 	with shortcuts
	
2004-07-25 pchenthill <pchenthill@novell.com>

	Fixes #59983
	If the ecal component is already loaded, check for the participation 
	status of the attendee and display the menu for selecting the 
	calendar.

2004-07-23  JP Rosevear  <jpr@ximian.com>
 
 	Fixes #61571
 	
 	* gui/e-week-view.c (e_week_view_start_editing_event): if the
 	event moves, find it again using the model data as the invariant
 	and then find the span again
	
2004-07-23  JP Rosevear  <jpr@novell.com>
 
 	Fixes #61760
 	
 	* gui/e-cal-model.c (add_new_client): don't check against the URI,
 	just against the client
 
2004-07-23 pchenthill <pchenthill@novell.com>

	* Retracting the commit made below for #59983 as it has
	results in crash some cases

2004-07-23 pchenthill <pchenthill@novell.com>

        Fixes #59983
        * gui/e-itip-control.c (show_current_event):
        If the ecal component is already loaded, check for the participation
        status of the attendee and display the menu for selecting the
        calendar.

2004-07-22  Larry Ewing  <lewing@ximian.com>

	* gui/e-meeting-time-sel.c (e_meeting_time_selector_style_set):
	fix the row heights and tweek the offsets so that things come out
	OK.

2004-07-21  JP Rosevear  <jpr@novell.com>
 
  	Fixes #61776
		
 	* gui/e-calendar-table.c (clipboard_get_text_cb): make sure the
 	text is not NULL
	
2004-07-21  JP Rosevear  <jpr@novell.com>

	Fixes #61738
	
	* gui/dialogs/meeting-page.c (clear_widgets): by default we have a
	user as organizer
	(sensitize_widgets): use user_org to determine widget sensitivity
	(meeting_page_fill_widgets): set user_org value appropriately
	(change_clicked_cb): set user_org to TRUE

2004-07-21  JP Rosevear  <jpr@novell.com>

	Fixes #61779
	
	* gui/dialogs/task-page.c (init_widgets): listen for changes on
	start and due dates

	* gui/dialogs/task-details-page.c (init_widgets): listen for
	changes on completion date

2004-07-20  Not Zed  <NotZed@Ximian.com>

	* gui/e-cal-model.c: 
	* importers/icalendar-importer.c: 
	* gui/dialogs/select-source-dialog.c: 
	* gui/dialogs/copy-source-dialog.c: 
	* gui/alarm-notify/util.c: 
	* common/authentication.c: 
	* gui/migration.c: include config.h.  See #61395.

2004-07-16  JP Rosevear  <jpr@novell.com>

	Fixes #61451

	* gui/e-itip-control.c (get_cancel_options): don't give a cancel
	option if the event is no where to be found
	(show_current_event): pass in kind
	(show_current_todo): ditto

2004-07-16  Larry Ewing  <lewing@ximian.com>

	* gui/e-meeting-time-sel.c (e_meeting_time_selector_style_set):
	fix the row heights and tweek the offsets so that things come out
	OK.

2004-07-16  Larry Ewing  <lewing@ximian.com>

	* gui/calendar-component.c (set_info): use short month forms to
	limit the maximum width of the label.

2004-07-15  Rodrigo Moya <rodrigo@novell.com>

	Fixes #57142

	* gui/e-day-view.c (e_day_view_on_editing_stopped): commit the
	sequence on the object before sending it to the backend.
	(e_day_view_add_event): s/abort_sequence/commit_sequence.

	* gui/e-week-view.c (e_week_view_on_editing_stopped): commit the
	sequence here also.
	(e_week_view_add_event): s/abort_sequence/commit_sequence.

	* gui/comp-util.c (cal_comp_event_new_with_current_time): don't
	commit the sequence here.

2004-07-14  JP Rosevear  <jpr@novell.com>
 
 	Fixes #61572
 	
 	* gui/dialogs/schedule-page.c (times_changed_cb): call notify
 	changed
 
 	* gui/dialogs/comp-editor.c (page_summary_changed_cb): no need to
 	mark the editor changed here, it doesn't do the right thing anyhow
 	(page_dates_changed_cb): ditto
 	
2004-07-14  JP Rosevear  <jpr@novell.com>

	Fixes #60678
	
	* gui/dialogs/cancel-comp.c (cancel_component_dialog): flip the
	messages around, the "deleting" flag means something else is doing
	the deleting

2004-07-12  JP Rosevear  <jpr@novell.com>
 
 	Fixes #57287, 58748
 	
	* gui/tasks-component.c (source_added_cb): if the source was
 	added in the main calendar, select it because the user caused this
 	to happen by creating a task
 	(create_component_view): listen for source_added signal on the
 	tasks
 
 	* gui/gnome-cal.c (view_selection_changed_cb): if the user created
 	a task, make sure we are displaying the relevant event list
 	(set_timezone): set the default zone of the default client
 	(setup_widgets): listen for the user_created signal
 	(gnome_calendar_destroy): clean up default client
 	(client_cal_opened_cb): disconnect from the open signal
 	(default_client_cal_opened_cb): set the default client on the
 	models
 	(open_ecal): make the callback function a param
 	(gnome_calendar_add_source): include the default client when
 	searching for an existing client
 	(gnome_calendar_set_default_source): make the default client
 	independent of the rest of the clients
 
 	* gui/e-week-view.c (e_week_view_on_editing_stopped): emit
 	user_created signal
 
 	* gui/e-tasks.c (user_created_cb): if the user created a task,
 	make sure we are displaying the relevant task list
 	(set_timezone): set the timezone on the client
 	(setup_widgets): listen for user_created signal
 	(e_tasks_destroy): unref default client
 	(default_client_cal_opened_cb): set the default on the model when
 	it opens
 	(open_ecal): open a task list
 	(e_tasks_add_todo_source): include the default client when
 	searching for an existing client
 	(e_tasks_set_default_source): make the default client independent
 	of the rest of the clients
 
 	* gui/e-day-view.c (e_day_view_on_editing_stopped): emit
 	user_created signal
 
 	* gui/e-calendar-view.h: add signal proto
 
 	* gui/e-calendar-view.c (e_calendar_view_class_init): add
 	user_created signal
 
 	* gui/e-calendar-table.h: add signal proto
 
 	* gui/e-calendar-table.c (e_calendar_table_class_init): add
 	user_created signal
 	(row_appended_cb): if row is appended, emit user_created signal
 	(e_calendar_table_init): listen for row_appended signal
 
 	* gui/e-cal-model.h: add signal proto
 
 	* gui/e-cal-model.c (e_cal_model_class_init): add row_appended
	signal
 	(ecm_append_row): don't leak, emit row appended signal
 	(e_cal_model_set_default_client): remove the existing default if
 	it was only used as the default
 	(update_e_cal_view_for_client): short circuit query create
 	(add_new_client): look for an existing client and update its
 	record if found, handle opening things here
 	(e_cal_model_add_client): just call add_new_client
 	(remove_client_objects): just remove a client's objects
 	(remove_client): use above, handle removal of client if its
 	default
 
 	* gui/calendar-component.c (source_added_cb): if the source was
 	added in the main calendar, select it because the user caused this
 	to happen by creating an appointment
 	(create_component_view): listen for source_added signal on the
 	calendar
	
2004-07-08  Radek Doulik  <rodo@ximian.com>

	* gui/e-cal-model.c (e_cal_model_date_value_to_string): as below

	* gui/e-cal-model-calendar.c (ecmc_value_to_string): as below

	* gui/e-cal-model.c (ecm_value_to_string): as below

	* gui/e-cal-model-tasks.c (ecmt_value_to_string): dup the string
	value, it's free-ed later. instead of returning NULL return
	g_strdup ("") as gal does

	Fixes #56271

2004-07-12  Rodney Dawes  <dobey#novell.com>

	* gui/e-tasks.c (pane_realized): Add this callback so we can set the
	paned position on realize
	(setup_widgets): Move the paned widget to the priv structure so that
	we can access it elsewhere
	(display_view_cb): Set the paned position when the view gets displayed

	Fixes #55653

2004-07-12  Rodney Dawes  <dobey@novell.com>

	* gui/dialogs/recur-comp.c (recur_component_dialog):
	Update the layout of the dialog to be more usable

	Partially fixes #56171

2004-07-11  JÃ¼rg Billeter <j@bitron.ch>

	* gui/dialogs/event-page.c (event_page_fill_component):
	busy should be opaque, not transparent

2004-07-09  Rodrigo Moya <rodrigo@novell.com>

	Revert my patches from July 5th and 6th.

	* gui/gnome-cal.c (gnome_calendar_init): call setup_config/widgets
	in the previous order.
	(setup_widgets): set the timezone on the views when creating them.
	(set_timezone): no need to set the timezone on the views here.
	(client_cal_opened_cb): removed call to set_timezone().

2004-07-09  Rodney Dawes  <dobey@novell.com>

	* gui/e-day-view-top-item.c (e_day_view_top_item_draw_triangle):
	Add an argument for the event_num so we can get the event object
	Draw the left/right triangles with the right color for the event
	Fix a small alignment bug with the triangle points

	* gui/e-week-view-event-item.c (e_week_view_event_item_draw_triangle):
	Draw the left/right triangles with the right color for the event
	Fix a small alignment bug with the triangle points

2004-07-09  Rodrigo Moya <rodrigo@novell.com>

	Fixes #60289

	* gui/dialogs/select-source-dialog.c (select_source_dialog): set the
	absolute URI on the selected source, so that the ESource we keep
	around has a valid URI.

	* gui/e-calendar-view.c (transfer_item_to): when copying appointments,
	change the UID.
	(transfer_selected_items): don't pass hardcoded values to transfer_item_to.

2004-07-08  Frederic Crozat  <fcrozat@mandrakesoft.com>

	* gui/Makefile.am:
	tarball should ship .schemas.in.in files, not generated files.

2004-07-06  Rodrigo Moya <rodrigo@novell.com>

	* gui/gnome-cal.c (gnome_calendar_init): setup the widgets before
	the configuration.

2004-07-06  JP Rosevear  <jpr@novell.com>

	Fixes #60645
	
	* gui/e-calendar-view.c (e_calendar_view_new_appointment_full):
	guess when an item should be all day based on the selection time

2004-07-05  Rodrigo Moya <rodrigo@novell.com>

	* gui/gnome-cal.c (setup_widgets): don't set the timezone on the views
	here.
	(set_timezone): do it here.
	(client_cal_opened_cb): call set_timezone() here.

2004-07-02  Rodrigo Moya <rodrigo@novell.com>

	* gui/gnome-cal.c (set_view): update the internal current_view_type
	field and focus the newly selected view.

2004-07-02  Rodney Dawes  <dobey@novell.com>

	* gui/dialogs/url-editor-dialog.c (get_widgets):
	Get the label for the calendar list header also
	(init_widgets): Set the border widths for the dialog's vbox and
	action area to be more compliant with the HIG
	Set the mnemonic widget for the calendar label, to the Source Selector
	Remove the unneeded settings for the scrolled window, these are in the
	glade xml for the widget
	Set the icon list on the correct dialog widget, not the settings dialog

	* gui/dialogs/url-editor-dialog.h:
	Add the calendar_list_label widget here so we can access it

	* gui/dialogs/url-editor-dialog.glade:
	Change the dialog's layout to be HIG compliant and fix some strings
	to do the same
	Add mnemonics to all the labels that are associated with widgets

2004-06-29  Sivaiah Nallagatla <snallagatla@novell.com>

        * gui/e-tasks.c (e_tasks_add_todo_source)
         (e_tasks_remove_todo_source) : store and lookup  clients
        based on ESource uid instead of uri in priv->clients

2004-06-28  Not Zed  <NotZed@Ximian.com>

	* gui/tasks-component.c (impl__get_userCreatableItems): same.

	* gui/calendar-component.c (impl__get_userCreatableItems): fix up
	shortcuts.  #56746.

2004-06-25  JP Rosevear  <jpr@novell.com>

	* gui/dialogs/alarm-dialog.glade: don't show option tabs

2004-06-25  JP Rosevear  <jpr@novell.com>

	* gui/dialogs/task-editor.c (task_editor_construct): use "Task"
	instead of "Basic"

	* gui/dialogs/event-editor.c (event_editor_construct): use
	"Invitations" instead of "Meeting"

2004-06-25  JP Rosevear  <jpr@novell.com>

	* gui/dialogs/e-delegate-dialog.glade: use "Contacts..."

	* gui/dialogs/alarm-dialog.glade: add custom message email toggle

	* gui/dialogs/alarm-dialog.c (get_widgets): get custom email
	message toggle
	(check_custom_email): check the custom message when setting
	sensitivity of OK button
	(malarm_message_toggled_cb): check custom email
	(malarm_description_changed_cb): ditto
	(action_selection_done_cb): ditto

2004-06-25  JP Rosevear  <jpr@novell.com>

	* gui/dialogs/alarm-dialog.c (alarm_to_dialog): set the default
	address here if possible
	(dialog_to_alarm): don't set it here
	(check_custom_email): check for To: entries
	(malarm_addresses_changed_cb): update when the text in the to
	entry changes
	(action_selection_done_cb): for the custom email settings
	(init_widgets): listen for email To: changes
	(alarm_dialog_run): only save the alarm if the response was "OK"

2004-06-25  JP Rosevear  <jpr@novell.com>

	* gui/dialogs/event-page.c (event_page_init): init alarm interval
	to -1
	(clear_widgets): give the alarm time option menu a sensible
	default
	(is_custom_alarm): account for the user defined alarm time if it
	doesn't match the default set
	(event_page_fill_widgets): default the option menu to the 15
	minute or user define alarm if no alarm is currently set
	(event_page_fill_component): account for the user defined alarm
	tme
	(init_widgets): add in the user defined alarm time if it doesn't
	match the default set

2004-06-25  JP Rosevaer  <jpr@novell.com>

	* gui/dialogs/alarm-dialog.c (palarm_widgets_to_alarm): the args
	are optional, don't store them if they aren't there
	(check_custom_sound): sensitize the ok button based on whether or
	not there needs to be input
	(check_custom_message): ditto
	(check_custom_program): ditto
	(dalarm_message_toggled_cb): check custom message
	(dalarm_description_changed_cb): ditto
	(aalarm_sound_toggled_cb): check custom sound
	(aalarm_attach_changed_cb): ditto
	(palarm_program_changed_cb): check custom program
	(action_selection_done_cb): use above checks as appropriate
	(init_widgets): listen for changed signals

2004-06-25  JP Rosevear  <jpr@novell.com>

	* gui/dialogs/event-page.c (event_page_finalize): free old_summary
	(is_custom_alarm): take description into account when checking for
	custom alarm
	(is_custom_alarm_uid_list): pass old_summary
	(is_custom_alarm_store): ditto
	(is_custom_alarm_store): ditto
	(sensitize_widgets): ditto
	(event_page_fill_component): ditto
	(event_page_fill_widgets): store the initial summary
	(alarm_changed_cb): make sure the needs description property gets
	set on the default alarm
	(alarm_custom_clicked_cb): copy the current store in case the user
	hits cancel, if all the alarms are erased uncheck the alarm toggle

	* gui/dialogs/alarm-dialog.glade: add toggles for custom messages
	and sound

	* gui/dialogs/alarm-dialog.c (aalarm_widgets_to_alarm): store
	custom sound only if the toggle is checked
	(dalarm_widgets_to_alarm): store custom message only if toggle is
	checked
	(get_widgets): load new widgets
	(aalarm_sound_toggled_cb): sensitize sound entry
	(dalarm_message_toggled_cb): sensitize message entry
	(init_widgets): listen for toggle signals

2004-06-24  JP Rosevear  <jpr@novell.com>

	* gui/dialogs/alarm-list-dialog.c (selection_changed_cb):
	sensitize the buttons
	(init_widgets): listen for selection changes so we can delete
	alarms

2004-06-24  JP Rosevear  <jpr@novell.com>

	* gui/dialogs/event-page.c (event_page_fill_component): store all
	the custom alarms
	(alarm_custom_clicked_cb): emit changed signal if necessary

	* gui/dialogs/alarm-list-dialog.c (alarm_list_dialog_run): return
	true/false based on button pushed

	* gui/dialogs/alarm-dialog.c: move repeat options and per alarm
	type options here

	* gui/dialogs/alarm-dialog.glade: ditto
	
	* gui/dialogs/Makefile.am: remove alarm options dialog

2004-06-24  Rodney Dawes  <dobey@novell.com>

	* gui/calendar-component.c (create_component_view):
	* gui/tasks-component.c (create_component_view):
	Add a call to e_source_selector_set_select_new here so that we can
	select new sources when we create them

2004-06-23  Jeffrey Stedfast  <fejj@novell.com>

	* conduits/todo/todo-conduit.c: Bump the version to 0.1.5 to help
	track down bug #59726.

2004-06-23  JP Rosevear  <jpr@novell.com>

	* gui/dialogs/comp-editor.c (comp_editor_init): set the window
	type hint to normal so it can go below the shell window

2004-06-23  Rodrigo Moya <rodrigo@novell.com>

	* gui/dialogs/comp-editor.c (comp_editor_notify_client_changed):
	fixed gtk-doc comments and made it enable/disable the dialog's
	OK button depending on the selected source.

2004-06-23  Rodney Dawes  <dobey@novell.com>

	* gui/calendar-component.c: Revert previous change to add the
	callbacks for notification of calendar selection changes
	(create_new_view): Update the comment for watching notification on
	the tasks selection to state it is for the mini tasks view

2004-06-23 JP Rosevear  <jpr@novell.com>

	Fixes #57862
	
	* gui/gnome-cal.c (connect_day_view_focus): connect after the
	focus events happen so the day view knows what is selected

2004-06-23  JP Rosevear  <jpr@novell.com>

	* gui/e-itip-control.c (update_attendee_status): tidy up to work
	again
	(ok_clicked_cb): use above when replying

2004-06-23  JP Rosevear  <jpr@novell.com>

	* gui/dialogs/meeting-page.c (remove_attendee): util function to
	do the actual removal
	(remove_attendee_at_row): ditto based on row number
	(remove_clicked_cb): make the remove button work
	(popup_delete_cb): use utility routines to do removal
	(button_press_event): do the icon properly

2004-06-22  Rodney Dawes  <dobey@novell.com>

	* gui/calendar-component.c (config_calendars_selection_changed_cb):
	(config_primary_calendar_selection_changed_cb):
	Add these two callbacks so that we can update the selection in the
	calendar when the gconf key changes, like we do for tasks

	(create_component_view): Register the two callbacks that we created
	for updating the selection in the view, and their notification IDs


2004-06-22  JP Rosevear  <jpr@novell.com>

	* gui/e-meeting-time-sel.c (e_meeting_time_selector_construct):
	clean up mnemonic handling and put the proper icon in the contacts
	button

2004-06-22  JP Rosevear  <jpr@novell.com>

	* gui/dialogs/recurrence-page.glade: fix mnemonics

	* gui/dialogs/event-page.glade: ditto

2004-06-22  JP Rosevear  <jpr@novell.com>

	* gui/dialogs/comp-editor.c: kill warnings

2004-06-22  JP Rosevear  <jpr@novell.com>

	* gui/calendar-component.c (create_new_event): kill warning

2004-06-22  Rodrigo Moya <rodrigo@novell.com>

	* gui/dialogs/Makefile.am: removed alarm-page.*.

2004-06-22  JP Rosevear  <jpr@novell.com>

	 * gui/dialogs/Makefile.am, gui/dialogs/alarm-dialog.c,
	 gui/dialogs/alarm-dialog.glade, gui/dialogs/alarm-dialog.h,
	 gui/dialogs/alarm-list-dialog.c,
	 gui/dialogs/alarm-list-dialog.glade,
	 gui/dialogs/alarm-list-dialog.h, gui/dialogs/alarm-options.c,
	 gui/dialogs/alarm-options.h, gui/dialogs/alarm-page.c,
	 gui/dialogs/alarm-page.glade, gui/dialogs/alarm-page.h,
	 gui/dialogs/comp-editor.c, gui/dialogs/comp-editor.h,
	 gui/dialogs/event-editor.c, gui/dialogs/event-page.c,
	 gui/dialogs/event-page.glade, gui/dialogs/meeting-page.c,
	 gui/dialogs/meeting-page.glade, gui/dialogs/recurrence-page.c,
	 gui/dialogs/recurrence-page.glade,
	 gui/dialogs/task-details-page.c,
	 gui/dialogs/task-details-page.glade, gui/dialogs/task-editor.c,
	 gui/dialogs/task-page.c, gui/dialogs/task-page.glade: HIGify and
	 newer design; alarm page is gone, Cancel/OK buttons for the
	 dialog, no more menus; slightly improve read-only workings for
	 entry areas
	
2004-06-22  JP Rosevear  <jpr@novell.com>

	* gui/e-meeting-time-sel.c (e_meeting_time_selector_construct):
	rename widgets to be consistent with those else where
	(e_meeting_time_selector_set_read_only): cast properly
	(e_meeting_time_selector_on_invite_others_button_expose): remove,
	the widget sensitization is taken care of elsewhere

2004-06-22  Larry Ewing  <lewing@ximian.com>

	Fixes #59824
	
	* gui/e-week-view.h: increase some of the passing so that the text
	does not appear to run together.  Ideally this would be based on
	the font size but this will work for now.

2004-06-21  Rodney Dawes  <dobey@novell.com>

	Fixes #56892

	* gui/dialogs/select-source-dialog.c (row_activated_cb): Add this
	callback to activate the OK button when we double-click or press
	the Enter key on a row
	(select_source_dialog): Change the default size to be reasonable
	Use ensure_style instead of realize on the dialog
	Set the default response for the dialog to OK
	Fix the packing of the group label to not have extraneous padding
	Connect up the callback for row_activated

2004-06-18  Jeffrey Stedfast  <fejj@novell.com>

	Fixes bug #57592

	* conduits/calendar/calendar-conduit.c (pre_sync): Same as below.

	* conduits/todo/todo-conduit.c (pre_sync):
	s/wombat/evolution-data-server/g

2004-06-18  Rodrigo Moya <rodrigo@novell.com>

	Fixes #58747

	* gui/dialogs/comp-editor.c (prompt_to_save_changes): if the source
	is read only, don't prompt the user.

2004-06-18  Rodrigo Moya <rodrigo@novell.com>

	Fixes #56323

	* gui/calendar-component.c (create_new_event): removed read-only
	check, just call the editor with the currently selected client and
	let it do the job.

	* gui/tasks-component.c (create_new_todo): ditto.

2004-06-18  Rodrigo Moya <rodrigo@novell.com>

	Fixes #60293

	* gui/dialogs/recurrence-page.c (type_toggled_cb): make sure
	we enable/disable correctly the 'Add' button.

2004-06-17 Sivaiah Nallagatla <snallagatla@novell.com>

        * gui/itip-utils.c (itip_publish_comp) : check for
        host being non-NULL in soup uri. host can be null
        for uri's of the form file:/foo or http:/foo etc

2004-06-17  Rodrigo Moya <rodrigo@novell.com>

	Fixes #60309

	* gui/meeting-page.c (sensitize_widgets): moved up in the file, to
	be declared before any use.

2004-06-16  Rodrigo Moya <rodrigo@novell.com>

	* gui/e-itip-control.c: use e-util's HTML conversion function,
	instead of camel's.
	(write_html): use e_text_to_html_full().

2004-06-15  JP Rosevear  <jpr@novell.com>

	Fixes #56197
	
	* gui/e-cal-list-view.etspec: add back categories

	* gui/e-calendar-table.etspec: ditto
	
2004-06-15  JP Rosevear  <jpr@novell.com>

	Fixes #59401
	
	* gui/e-week-view.c (e_week_view_on_text_item_event): if we are
	editing the event, don't ignore the right click, stop editing the
	event and continue on

2004-06-15  JP Rosevear  <jpr@novell.com>

	Fixes #57393
	
	* gui/e-week-view.c (e_week_view_set_compress_weekend): redraw the
	titles as well since the spacing is different

2004-06-15  Rodrigo Moya <rodrigo@novell.com>

	* gui/dialogs/meeting-page.c (meeting_page_construct): connect
	to "client_changed" signal on the page.
	(client_changed_cb): new callback.
	(sensitize_widgets): new function.
	(meeting_page_fill_widgets): call sensitize_widgets().

	* gui/e-meeting-time-sel.[ch]
	(e_meeting_time_selector_set_read_only): new function.
	(e_meeting_time_selector_construct): store some missing buttons
	in the EMeetingTimeSelector structure.

	* gui/dialogs/schedule-page.c (schedule_page_construct):
	connect to "client_changed" signal on the page.
	(client_changed_cb): new callback.
	(sensitize_widgets): new function.
	(schedule_page_fill_widgets): call sensitize_widgets().

2004-06-10  Rodrigo Moya <rodrigo@novell.com>

	* gui/e-cal-model.c (e_cal_view_objects_modified_cb): removed
	g_assert call, since we shouldn't crash when getting wrong
	notifications from a backend.

2004-06-10  JP Rosevear  <jpr@novell.com>

	* gui/gnome-cal.c
	(gnome_calendar_on_date_navigator_selection_changed): only do the
	range selected hack in one case

2004-06-10  JP Rosevear  <jpr@novell.com>

	* gui/gnome-cal.c (setup_widgets): set 6 weeks shown
	(display_view): ditto

2004-06-10  Rodrigo Moya <rodrigo@novell.com>

	Fixes #58748

	* gui/gnome-cal.c (setup_widgets): set the timezone on all views
	when creating them.

2004-06-10  Rodrigo Moya <rodrigo@novell.com>

	* gui/e-calendar-table.c (e_calendar_table_init): don't set
	the "bg_color_column" property on the ECellToggle class.

2004-06-10  Rodrigo Moya <rodrigo@novell.com>

	Fixes #58799

	* gui/e-calendar-view.c (e_calendar_view_delete_selected_occurrence):
	Use the timezone for getting the RECUR-ID from the instance start
	date if available. Also, use dates only as the recurrence ID, and
	do nothing if not a recurrent appointment.

2004-06-09  JP Rosevear  <jpr@novell.com>

	Fixes #59242, #57404, ##55394
	
	* gui/gnome-cal.c (get_times_for_views): calculate the work week,
	week, and month views more exactly
	(update_adjustment): update the view based on week view scrolling
	(setup_widgets): listen for the scroll bar moving on the week
	views
	(gnome_calendar_update_date_navigator): adjust for compressed
	weekends in the month view
	(gnome_calendar_on_date_navigator_selection_changed): ditto

	* gui/e-week-view.h: add protos

	* gui/e-week-view.c (time_range_changed_cb): calculate the
	base_date and first_day_shown more simply, allows multi-week
	selection to work better; update the base date when told to do so
	(e_week_view_init): init update_base_value var
	(e_week_view_get_update_base_date): accessor
	(e_week_view_set_update_base_date): ditto

2004-06-08  Rodrigo Moya <rodrigo@novell.com>

	Fixes #57578

	* gui/e-calendar-view.c (on_move_to, on_copy_to): simplified to
	just call transfer_selected_items() with the approppriate
	arguments.
	(transfer_selected_items): new function to transfer all selected
	items to another calendar.
	(transfer_item_to): added missing implementation.

2004-06-08  Rodrigo Moya <rodrigo@novell.com>

	Fixes #57579

	* gui/dialogs/select-source-dialog.c (select_source_dialog): start
	with the OK button disabled.
	(primary_selection_changed_cb): enable/disable the OK button depending
	on the selection on the ESourceSelector.

2004-06-08  Rodrigo Moya <rodrigo@novell.com>

	* gui/dialogs/comp-editor.[ch] (comp_editor_notify_client_changed):
	new function for notifying all pages of the client change.
	(page_client_changed_cb): no need for this callback.
	(comp_editor_append_page): no need to connect to "client_changed"
	signal on the pages.

	* gui/dialogs/comp-editor-page.c
	(comp_editor_page_notify_client_changed): re-added the call to
	comp_editor_page_set_e_cal(), the client was not being set anywhere.

	* gui/dialogs/event-page.c (source_changed_cb): use
	comp_editor_notify_client_changed() so that all pages get informed
	of the client change.

	* gui/dialogs/task-page.c (source_changed_cb): ditto.

2004-06-08  Rodrigo Moya <rodrigo@novell.com>

	* gui/dialogs/comp-editor-page.c
	(comp_editor_page_notify_client_changed): do not set the private
	client here, it is set in comp-editor.c.

	* gui/dialogs/event-page.c (sensitize_widgets): new function.
	(source_changed_cb): call sensitize_buttons().

	* gui/dialogs/recurrence-page.c (sensitize_buttons): new
	function, to deal correctly with the sensitivity of all widgets
	in the page.
	(recurrence_page_fill_widgets, type_toggled_cb, client_changed_cb):
	call sensitize_buttons() instead of sensitize_recur_widgets().
	(recurrence_page_construct): g_signal_connect_after for
	"client_changed", to get notifications after CompEditorPage
	gets his.

	* gui/dialogs/alarm-page.c (sensitize_buttons): sensitize the missing
	widgets in the page.
	(alarm_page_construct): g_signal_connect_after for "client_changed",
	to get notifications after CompEditorPage gets his.

2004-06-08  JP Rosevear  <jpr@novell.com>

	* gui/e-week-view.c (e_week_view_do_key_press): cast week view
	correctly

2004-06-08  Rodrigo Moya <rodrigo@novell.com>

	* gui/dialogs/recurrence-page.c (recurrence_page_construct): connect
	to "client_changed" signal on the page.
	(client_changed_cb): new callback.

	* gui/dialogs/alarm-page.c (sensitize_buttons): fixed missing stuff
	in last commit.

2004-06-08  Rodrigo Moya <rodrigo@novell.com>

	Fixes #59650

	* gui/dialogs/alarm-page.c (alarm_page_construct): connect to
	"client_changed" signal on the page.
	(client_changed_cb): new callback.
	(sensitize_buttons): added code for dealing with read only calendars
	and disable/enable buttons approppriately.

2004-06-07  Dan Winship  <danw@novell.com>

	* gui/dialogs/comp-editor.c (pixmaps): s/stock_save_as/stock_save-as/

2004-06-07  Rodrigo Moya <rodrigo@novell.com>

	* gui/e-tasks.c (e_tasks_add_todo_source): open task lists
	asynchronously.
	(client_cal_opened_cb): callback from the client when opened.

	* gui/gnome-cal.c (client_cal_opened_cb): disconnect from all
	signals of the client when opening it fails. Clean up the status
	messages correctly, based on source type.
	(open_ecal): for tasks, use e_calendar_table_set_status_message
	not e_calendar_view_set_status_message.
	(gnome_calendar_remove_source_by_uid): call update_query only when
	removing calendars, not tasks lists.
	(update_query): set meaningful status messages.

2004-06-06 Vardhman Jain <vardhman@students.iiit.net>

	* Bug #36247
	* gui/e-itip-control.c (write_html, set_date_label):
	Changes to improve the performance of _(str) function call on strings
	str of the type <tar>str</tag> to avoid translation of tag.

2004-06-04    <jpr@novell.com>

	* gui/gnome-cal.c: define G_MAXINT32 if it isn't already

2004-06-04  JP Rosevear  <jpr@novell.com>

	Fixes #58739
	
	* gui/migration.c (migrate_calendars): guard against NULL
	gconf_val

2004-06-04  JP Rosevear  <jpr@novell.com>

	Fixes #59058
	
	* gui/gnome-cal.c (gnome_calendar_purge): make purging actually
	work

2004-06-04  JP Rosevear  <jpr@novell.com>

	* gui/dialogs/task-page.c (task_page_fill_widgets): guard
	against the text value being NULL

	* gui/dialogs/event-page.c (event_page_fill_widgets): add guards
	here as well
	
2004-06-03  Jeffrey Stedfast  <fejj@novell.com>

	* conduits/calendar/calendar-conduit.c
	(calconduit_load_configuration): If the last_uri string value is
	the Evolution 1.4 URI, change it to the new URI. Fixes bug #54134.

2004-06-03  Rodrigo Moya <rodrigo@novell.com>

	Fixes #59481
	
	* gui/e-tasks.c (set_status_message): don't use vsprintf with
	NULL strings, crashes on FreeBSD.

2004-06-03  Rodrigo Moya <rodrigo@novell.com>

	* gui/dialogs/comp-editor-page.c
	(comp_editor_page_notify_client_changed): update the internal client
	when it changes.

2004-06-03  Rodrigo Moya <rodrigo@novell.com>

	Fixes #56875

	* gui/dialogs/event-editor.c (event_editor_construct): connect to
	"client_changed" signal on the EventPage.
	(client_changed_cb): set menu sensibility when the client changes.

	* gui/dialogs/task-editor.c (task_editor_construct): connect to
	"client_changed signal on the TaskPage.
	(client_changed_cb): set menu sensibility when the client changes.

2004-06-02  JP Rosevear  <jpr@novell.com>
	
	* gui/alarm-notify/alarm-notify.c (process_removal_in_hash): free
	the correct uri, preventing bad memory corruption
	(list_changed_cb): track the removals in a list so we don't
	clobber the hash table data during the foreach loop

2004-06-02  Chris Toshok  <toshok@ximian.com>

	* gui/migration.c (migrate_calendars): remove absolute_uri from
	ESource's.
	(migrate_tasks): same.

2004-06-02  Rodrigo Moya <rodrigo@novell.com>

	* gui/e-meeting-list-view.c (start_addressbook_server): removed
	pre-completion code, not needed anymore.
	(emlv_finalize): no need to unref the book anymore.
	(emlv_init): don't call start_addressbook_server.

	* gui/dialogs/copy-source-dialog.c (copy_source): fixed
	leak and pass the correct icalcomponent to e_cal_modify_object.

2004-06-02  Rodrigo Moya <rodrigo@novell.com>

	Fixes #59333

	* gui/dialogs/task-page.c (task_page_fill_widgets): guard against
	list items being NULL.

2004-06-02  Larry Ewing  <lewing@ximian.com>

	* gui/e-tasks.c (table_drag_data_delete): add a drag delete handler.
	(table_drag_data_get): support text/vcard drags.
	(setup_widgets): setup the etable as a drag source.

	* gui/tasks-component.c: add source selector Drag & Drop handlers.

2004-06-01  Larry Ewing  <lewing@ximian.com>

	* gui/dialogs/calendar-setup.c: rename can_add to is_mutable, add
	sensitivity logic for both readonly and mutable cases.  The
	esource attributes are a complete mess and need discussion.

	* gui/dialogs/calendar-setup.glade: remove edit dialogs and name
	the tables.


2004-06-01  Rodrigo Moya <rodrigo@novell.com>

	Fixes #59369

	* gui/e-calendar-view.c (clipboard_get_text_cb): don't pass NULL strings
	to libical functions.

2004-05-31  Priyanshu Raj <Priyanshu@students.iiit.net>

	* Bug #51968 "Invite others.." button confusing in Appointment
	editor dialog(Fixed)"

2004-05-29  Priyanshu Raj <priyanshu@students.iiit.net>

	* Bug #48134: Menu items in Scheduling tab should have sentence
	capitalization (Fixed)
	
2004-05-28  Kidd Wang  <kidd.wang@sun.com>

	* gui/e-week-view.c: (e_week_view_event_move),
	(e_week_view_get_day_offset_of_event): a more straightforward way
	to calculate the offset of a day within the week.

2004-05-26  Jeffrey Stedfast  <fejj@novell.com>

	Fix for bug #57818.

	* gui/e-tasks.c (setup_widgets): Same.

	* gui/gnome-cal.c (setup_widgets): Updated to pass a set of
	bitflags to cal_search_bar_new().

	* gui/cal-search-bar.c (cal_search_bar_new): Now takes a bit flag
	argument specifying which search options to present.
	(cal_search_bar_construct): Same as above. Construct the search
	menu to use based on the bit flags.

	* gui/apps_evolution_calendar.schemas.in.in: Changed the default
	"Tasks due today" colour to be a light-blue (one of the default
	colour values in the colour picker dialog). Fixes bug #53412.

2004-05-26  Rodrigo Moya <rodrigo@ximian.com>

	Fixes #57759

	* gui/gnome-cal.c (gnome_calendar_remove_source_by_uid): remove all
	queries we've got for the removed source.

2004-05-26  Kidd Wang  <kidd.wang@sun.com>

	* gui/e-week-view.c: (e_week_view_event_move),
	(e_week_view_get_day_offset_of_event): a more straightforward way
	to calculate the offset of a day within the week.

2004-05-26  Kidd Wang  <kidd.wang@sun.com>

	* gui/e-week-view.c: (e_week_view_event_move),
	(e_week_view_change_event_time): In week view all-day events should
	keep all-dayness when moved around.

2004-05-25  Larry Ewing  <lewing@ximian.com>

	* gui/dialogs/calendar-setup.c: remove now unused functions.
	(source_group_can_add): fix can add logic, remove more unused
	functions.

	* gui/dialogs/calendar-setup.c (calendar_setup_edit_task_list):
	use the new dialog.
	(calendar_setup_edit_calendar): use the new dialog.
	(key_press_event): look for escape press and destroy dialog.

2004-05-25  Jeffrey Stedfast  <fejj@novell.com>

	* gui/dialogs/url-editor-dialog.c (init_widgets): Use
	gtk_window_set_icon_list() here instead of gtk_window_set_icon().

	* gui/dialogs/select-source-dialog.c (select_source_dialog): Use
	gtk_window_set_icon_list() here instead of gtk_window_set_icon().

	* gui/dialogs/calendar-setup.c (source_to_dialog): Huh?? Why are
	integer colours in an array of char*? Fixed to be an array of
	guint32.

	* gui/dialogs/changed-comp.c (changed_component_dialog): Use
	gtk_window_set_icon_list() here instead of gtk_window_set_icon().

	* gui/dialogs/calendar-setup.c (calendar_setup_new_calendar):
	Don't bother calling tk_window_set_icon() if we are gonna call
	gtk_window_set_icon_list a few lines later.
	(calendar_setup_edit_calendar): Same.
	instead.
	(calendar_setup_new_task_list): Same.
	(calendar_setup_edit_task_list): Same.

	* gui/dialogs/alarm-options.c (alarm_options_dialog_run): Use
	gtk_window_set_icon_list() instead of gtk_window_set_icon() so gtk
	can do the Right Thing (tm).

2004-05-25  Jeffrey Stedfast  <fejj@novell.com>

	* Makefile.am: Make calendar-errors.xml.h and install the xml
	file.

	* calendar-errors.xml: New error definitions file.

	* gui/gnome-cal.c (backend_died_cb): Use e-error

	* gui/e-tasks.c (backend_died_cb): Use e-error

	* gui/dialogs/send-comp.c (send_component_dialog): Use e-error

	* gui/dialogs/save-comp.c (save_component_dialog): Use e-error

	* gui/dialogs/delete-comp.c (delete_component_dialog): Use e-error

	* gui/dialogs/cancel-comp.c (cancel_component_dialog): Use e-error

2004-05-25  Sivaiah Nallagatla <snallagatla@novell.com>

	* common/authentication.c (auth_func_cb): read the "auth-domain"
	property to use as component name for e-password calls instead of
	hard coded component name

2004-05-25  Trent Lloyd  <lathiat@bur.st>

	Fixes: #57472

	* gui/dialogs/alarm-options.c:
	* gui/dialogs/calendar-setup.c:
	* gui/dialogs/cancel-comp.c:
	* gui/dialogs/changed-comp.c:
	* gui/dialogs/delete-comp.c:
	* gui/dialogs/delete-error.c:
	* gui/dialogs/save-comp.c:
	* gui/dialogs/select-source-dialog.c:
	* gui/dialogs/send-comp.c
	* gui/dialogs/url-editor-dialog.c:
	- Add include of e-icon-factory.h
	- Set icon on window to be calendar/tasks icon rather than mail icon

2004-05-21  Larry Ewing  <lewing@ximian.com>

	* gui/dialogs/calendar-setup.c: set the dialog icons appropriately
	for add task and calendar dialogs.

2004-05-21  Larry Ewing  <lewing@ximian.com>

	* gui/dialogs/calendar-setup.c: remove references to the uri
	buttons.

	* gui/dialogs/calendar-setup.glade: remove uri buttons, make add
	task window wider and make the button spacing larger.

2004-05-21  H P Nadig  <hpnadig@pacific.net.in>

       * gui/dialogs/calendar-setup.glade: Adjusted the default size of
       New Calendar Dialog. Fixes 57469.

2004-05-20  JP Rosevear  <jpr@ximian.com>

	* gui/e-itip-control.c (find_server): proper look for figuring out
	if the object is on the server

2004-05-20  JP Rosevear  <jpr@novell.com>

	* gui/tag-calendar.c (tag_calendar_by_comp): pass the client
	properly

2004-05-19  Chris Toshok  <toshok@ximian.com>

	* gui/e-meeting-store.c (start_addressbook_server): use the new
	e_book_new_* and e_book_open apis.

	* gui/e-meeting-list-view.c (start_addressbook_server): use the
	new e_book_new_* and e_book_open apis.

2004-05-19  William Jon McCann  <mccann@jhu.edu>

	* gui/GNOME_Evolution_Calendar.server.in.in: Add menu_label and
	menu_accelerator.

2004-05-18  JP Rosevear  <jpr@novell.com>

	* idl/evolution-calendar.idl: add arg

	* gui/alarm-notify/alarm-queue.c (edit_component): send a mode
	type

	* gui/alarm-notify/alarm-notify.c: add fixme note

	* gui/comp-editor-factory.c (impl_editExisting): take a editor
	mode and twist it into a source type
	(impl_editNew): ditto
	(open_client): take a source type for creating the client
	(lookup_open_client): ditto

2004-05-18  JP Rosevear  <jpr@novell.com>

	* gui/alarm-notify/notify-main.c (init_alarm_service): just set up
	the alarm notify object

	* gui/alarm-notify/alarm-notify.h: update proto

	* gui/alarm-notify/alarm-notify.c (process_removal_in_hash):
	process removals using the source list
	(list_changed_cb): when the list changes, update
	(load_calendars): initially load the calendars
	(alarm_notify_init): load the calendars here and don't listen for
	a selection notification
	(alarm_notify_add_calendar): get the source type when adding a
	calendar

	* gui/alarm-notify/notify-main.c (main): no need to init/shutdown
	gnome vfs

	* gui/alarm-notify/config-data.h: new proto

	* gui/alarm-notify/config-data.c
	(config_data_get_notify_with_tray): routine to get schema value

	* gui/alarm-notify/alarm.c (alarm_ready_cb): no timeout checking
	here, setup_timeout does that
	(queue_alarm): ditto
	(setup_timeout): calculate the timeout better

	* gui/alarm-notify/alarm-queue.c (query_objects_changed_cb): tidy
	(edit_component): clean up exception handling
	(display_notification): don't show the tray icon if we aren't
	notifying with the tray

	* gui/apps_evolution_calendar.schemas.in.in: add notify_with_tray
	option

2004-05-18  Kidd Wang  <kidd.wang@sun.com>

	* gui/e-week-view.c: (e_week_view_do_cursor_key_up),
	(e_week_view_do_cursor_key_down), (e_week_view_do_cursor_key_left),
	(e_week_view_do_cursor_key_right), (e_month_view_do_cursor_key_up),
	(e_month_view_do_cursor_key_down),
	(e_month_view_do_cursor_key_left),
	(e_month_view_do_cursor_key_right), (e_week_view_cursor_key_up),
	(e_week_view_cursor_key_down), (e_week_view_cursor_key_left),
	(e_week_view_cursor_key_right), (e_week_view_do_key_press): make
	the focus movable in week/month view when no events are selected.

2004-05-17  Jeffrey Stedfast  <fejj@novell.com>

	* gui/dialogs/event-editor.c: Same.

	* gui/dialogs/comp-editor.c: Change E_PIXMAP size args
	over to E_ICON_SIZE_* values.

	* gui/alarm-notify/alarm-queue.c (tray_icon_blink_cb): Use
	E_ICON_SIZE enum here.
	(display_notification): Same.

	* gui/alarm-notify/alarm-notify-dialog.c (write_html_heading): Use
	E_ICON_SIZE_DIALOG here.

	* gui/e-week-view.c (e_week_view_realize): Same as below.

	* gui/e-day-view.c (e_day_view_realize): Use E_ICON_SIZE_MENU for
	the icon sizes rather than using pixel values.

	* gui/calendar-commands.c (pixmaps): Change E_PIXMAP size args
	over to E_ICON_SIZE_* values.

	* gui/tasks-component.c (add_popup_menu_item): Use
	E_ICON_SIZE_MENU

	* gui/e-timezone-entry.c (e_timezone_entry_init): Use
	E_ICON_SIZE_BUTTON

	* gui/e-itip-control.c (write_error_html): Use E_ICON_SIZE enums.
	(write_html): Same.

	* gui/e-calendar-view.c (e_calendar_view_set_status_message): Use
	E_ICON_SIZE_STATUS
	(setup_popup_icons): Use E_ICON_SIZE_MENU

	* gui/e-calendar-table.c (e_calendar_table_init): Use
	E_ICON_SIZE_LIST rather than a hard-coded value of 16 pixels.
	(e_calendar_table_set_status_message): Use E_ICON_SIZE_STATUS

	* gui/calendar-component.c (add_popup_menu_item): Use
	E_ICON_SIZE_MENU rather than hard-coding the pixel size.

2004-05-17  JP Rosevear  <jpr@novell.com>

	Fixes #56373
	
	* gui/comp-editor-factory.c (open_client): guess its an event for
	now

2004-05-17  V Ravi Kumar Raju <vravikr@yahoo.co.uk>

	*  gui/e-alarm-list.c (get_alarm_string):
	*  gui/dialogs/alarm-page.glade: Change dropdown list item 'Display
	a message' for reminder types to 'Pop up an alert'

2004-05-17  Rodrigo Moya <rodrigo@ximian.com>

	* gui/e-calendar-view.c (e_calendar_view_delete_selected_occurrence):
	if we don't have a RECURRENCE-ID, remove nothing, and use the instance
	start time for the RECURRENCE-ID as the default.

2004-05-17  H P Nadig  <hpnadig@pacific.net.in>

	Fixes #56885
	
	* gui/dialogs/select-source-dialog.c (select_source_dialog): Changed
	the window size of source dialog and a minor naming issue. 

2004-05-14  Rodrigo Moya <rodrigo@ximian.com>

	* gui/e-day-view.c (process_component):
	* gui/e-week-view.c (process_component):
	* gui/gnome-cal.c (gnome_calendar_purge):
	* gui/tag-calendar.c (tag_calendar_by_comp):
	* gui/e-cal-model.c (e_cal_model_generate_instances): use
	e_cal_generate_instances_for_object instead of
	e_cal_recur_generate_instances.

2004-05-14  Nicel KM  <mnicel@novell.com>

	* gui/dialogs/alarm-page.c (button_options_clicked_cb): invoke options 
	dialog even if backend does not support email alarms and get email 
	address only if supported.

2004-05-13  Rodrigo Moya <rodrigo@ximian.com>

	* gui/dialogs/alarm-page.c (add_clicked_cb): only get the email address
	for alarms if the backend supports email alarms.

2004-05-13  Not Zed  <NotZed@Ximian.com>

	Fixes #57644.

	* gui/e-day-view.c (row_deleted_check_cb): strdup the uid, as
	below.
	(remove_uid_cb): and free it.

	* gui/e-week-view.c (row_deleted_check_cb): strdup the uid, 'cause
	otherwise it can go away later as we delete stuff.
	(remove_uid_cb): free the uid.

	* gui/e-week-view-event-item.c (e_week_view_event_item_draw): add
	some array bounds checking as an attempt to isolate the crash in
	#57644.

2004-05-11  Not Zed  <NotZed@Ximian.com>

	* gui/migration.c (migrate_calendars, migrate_tasks): add GError
	return for error details & return errors.

	* gui/calendar-component.c (impl_upgradeFromVersion): fix for api
	change, and erturn exception if we need to.

2004-05-11  Rodrigo Moya <rodrigo@ximian.com>

	* gui/e-itip-control.c (update_item): get error information from
	the call to e_cal_receive_objects, and use that as the error message.

2004-05-11  Dan Winship  <danw@ximian.com>

	* gui/GNOME_Evolution_Calendar.server.in.in: Remove the calendar
	and task list controls

	* gui/main.c (factory): Remove support for the calendar and task
	list controls

	* gui/control-factory.c: Remove the property-bag stuff

	* gui/tasks-control.c: Likewise

2004-05-11  Rodrigo Moya <rodrigo@ximian.com>

	Fixes #53137

	* gui/dialogs/schedule-page.c (schedule_page_fill_widgets): check dates
	from the ECalComponent before using them.

2004-05-11  Rodrigo Moya <rodrigo@ximian.com>

	* gui/e-cal-model-tasks.c (set_due): use/set the DUE date, not
	the DTEND date.

2004-05-07  Umeshtej <umeshtej@gawab.com>

	Fixes #58014
	
	* gui/e-meeting-list-view.c (process_section):Run the for loop 
	for the number of elements in cards.
	
2004-05-10  Trent Lloyd  <lathiat@bur.st>

	* gui/dialogs/select-source-dialog.c: Include gtkhbox.h and gtkvbox.h
	to fix implicit declaration
	* gui/dialogs/meeting-page.c: (get_current_page) Cast GTK_ENTRY from
	GTK_COMBO to fix compiler warning
	* gui/dialogs/cal-prefs-dialog.c: Remove lvalue casts, produces
	compiler warnings and are not necessary
	
2004-05-07  JP Rosevear  <jpr@ximian.com>

	Fixes #52294
	
	* gui/e-cal-model.c (set_dtstart): set the tzid properly
	(ecm_is_cell_editable): set check properly

	* gui/e-cal-model-tasks.c (set_due): set the tzid properly
	(ecmt_is_cell_editable): set check properly

	* gui/e-cal-model-calendar.c (set_dtend): set the tzid properly
	(ecmc_is_cell_editable): kill fixme and set check properly

2004-05-07  JP Rosevear  <jpr@ximian.com>

	* gui/e-cal-model.c (ecm_is_cell_editable): fix comment and check

	* gui/e-cal-model-tasks.c (ecmt_set_value_at): set a parent field
	properly
	(ecmt_is_cell_editable): fix comment and check

2004-05-06  Larry Ewing  <lewing@ximian.com>

	* gui/dialogs/calendar-setup.c (source_to_dialog): use random
	color for calendar default.

2004-05-05  JP Rosevear  <jpr@ximian.com>

	Fixes #58025
	
	* gui/gnome-cal.c (set_search_query): kill warning
	(setup_config): don't set time out here
	(setup_widgets): set it here
	(gnome_calendar_destroy): clear the time out

	* gui/e-tasks.c (search_bar_sexp_changed_cb): kill warning
	(setup_config): don't set time out here
	(setup_widgets): set it here and remember the time out id
	(e_tasks_destroy): clear the time out

2004-05-05  Larry Ewing  <lewing@ximian.com>

	* gui/dialogs/calendar-setup.c: make sure that we don't crash if
	there are no sources.
	(calendar_setup_new_task_list): fix the previous fix to work if
	there are sources.

2004-05-04  Larry Ewing  <lewing@ximian.com>

	* gui/dialogs/calendar-setup.c: fix logic error.
	(source_group_can_add): helper function to fix groupwise case.
	I'm still not happy with this but it will work for now.

	* gui/dialogs/calendar-setup.c (source_to_dialog): convert units.
	(dialog_to_source): convert time units.

	* gui/dialogs/calendar-setup.glade. name the unit option menus.

2004-05-03  Rodney Dawes  <dobey@ximian.com>

	* gui/dialogs/select-source-dialog.c (select_source_dialog):
	Make this dialog be HIG-compliant and accessible

2004-05-03  Edgar Luna DÃ­az  <eald@linuxuanl.org>

	* gui/dialogs/select-source-dialog.c (select_source_dialog):
	Set the default window size to 276 x 320

	Fixes #57298

2004-05-03  Larry Ewing  <lewing@ximian.com>

	* gui/dialogs/calendar-setup.glade: rename the cancel button.

2004-04-29  Larry Ewing  <lewing@ximian.com>

	* gui/e-cal-model.c (ecm_get_color_for_component): use the source
	color if it is set.  Yay for ugly colors.

	* gui/e-cal-model.h: add a color holder to the ECalModelComponent
	since the return value of the color stuff is const.

2004-05-03  JP Rosevear  <jpr@ximian.com>

	Fixes #51714
	
	* gui/e-cal-list-view.c (setup_e_table): listen for double click
	signal
	(e_cal_list_view_on_table_double_click): edit the appointment that
	was double clicked on

2004-05-03  JP Rosevear  <jpr@ximian.com>

	* gui/calendar-component.c (set_info): set the info label
	(calendar_dates_changed_cb): call back for when the dates of the
	calendar change
	(create_component_view): store the info label for later use;
	listen for date changes to set the info label

2004-05-03  JP Rosevear  <jpr@ximian.com>

	Fixes #57897
	
	* gui/e-tasks.c (setup_widgets): no need to listen for the deleted
	signal, the cursor will change in that case

2004-05-03  JP Rosevear  <jpr@ximian.com>

	* gui/e-cal-model-tasks.c (set_completed): remove useless debug
	statement

2004-05-03  JP Rosevear  <jpr@ximian.com>

	* gui/tasks-component.c (set_info): set the info label message
	(model_changed_cb): call above
	(table_selection_change_cb): ditto
	(model_rows_inserted_cb): ditto
	(model_rows_deleted_cb): ditto
	(create_component_view): remember the info in the view struct;
	listen for events that require the info label to be updated

2004-05-03  JP Rosevear  <jpr@ximian.com>

	Fixes #57899
	
	* gui/e-day-view.c (e_day_view_do_key_press): bail if the client
	is read only (or we get an error trying to find out)

	* gui/e-week-view.c (e_week_view_do_key_press): ditto
	
2004-05-03  JP Rosevear  <jpr@ximian.com>

	Fixes #57894
	
	* gui/gnome-cal.c (gnome_calendar_new_task): make sure we use the
	default component of the correct model

2004-04-30  Rodney Dawes  <dobey@ximian.com>

	* gui/alarm-notify/alarm-notify-dialog.c (alarm_notify_dialog):
	* gui/alarm-notify/alarm-notify.glade:
	Update the alarm notify dialog to be HIG compliant

	Fixes #41224

2004-04-30  Gary Ekker  <gekker@novell.com>

	* gui/e-tasks.c: (e_tasks_init): Set up the model to use the correct 
	query. Setup callbacks for gconf changes. Add an idle timeout to hide 
	completed items.
	Add update_view, update_view_cb, and 
	config_hide_completed_tasks_changed_cb to update the model view.

	* gui/gnome-cal.c: ditto
	
	* gui/calendar-config.h: Add notifications for hide_completed_tasks
	settings.

	* gui/calendar-config.c: ditto

2004-04-30  Not Zed  <NotZed@Ximian.com>

	* gui/dialogs/meeting-page.c (get_widgets): make the entry
	non-editable.  Quick fix for #48132 (could convert to optionmenu
	but then we need to change again for gnome >?2.6).

2004-04-29  Rodney Dawes  <dobey@ximian.com>

	* gui/dialogs/cal-prefs-dialog.glade: Update the prefs dialog pages
	for the calendar and tasks components to be HIG compliant

2004-04-29  JP Rosevear  <jpr@ximian.com>

	* gui/tasks-component.h (tasks_component_peek_source_list): remove
	prototypes

	* gui/tasks-component.c (source_removed_cb):  unselect the
	source in the selector if source removed from calendar
	(create_component_view): create the activity handler and listen to
	source remove signal

	* gui/gnome-cal.h: add signals, protos

	* gui/gnome-cal.c (gnome_calendar_class_init): add source added
	and removed signals
	(client_cal_opened_cb): emit source removed signal
	(open_ecal): set the status message
	(backend_died_cb): emit source removed signal
	(gnome_calendar_set_activity_handler): allow an activity handler
	to be set
	(gnome_calendar_add_source): emit source added signal
	(gnome_calendar_remove_source): emit source removed signal
	(display_view): update the active activity handler
	
	* gui/e-tasks.h: add signal prototypes

	* gui/e-tasks.c (e_tasks_class_init): add source added and removed
	signals
	(backend_died_cb): emit source removed signal
	(e_tasks_add_todo_source): emit source added/removed signals
	(e_tasks_remove_todo_source): emit source removed signal

	* gui/e-calendar-view.h: add proto

	* gui/e-calendar-view.c (e_calendar_view_set_activity_handler):
	allow an activity handler to be set
	(e_calendar_view_set_status_message): use private activity handler
	(if any) to set status message

	* gui/e-calendar-table.h: add data member and proto

	* gui/e-calendar-table.c (e_calendar_table_set_activity_handler):
	allow an activity handler to be set
	(e_calendar_table_set_status_message): use private activity
	handler (if any) to set status message

	* gui/e-calendar-marshal.list: add extra marshallers

	* gui/calendar-component.h: kill protos

	* gui/calendar-component.c (source_removed_cb): unselect the
	source in the selector if source removed from calendar
	(create_component_view): create the activity handler and listen to
	source remove signal

2004-04-29  JP Rosevear  <jpr@ximian.com>

	* gui/dialogs/comp-editor.c (send_timezone): ditto

	* gui/dialogs/task-page.c (task_page_fill_component): kill warning

2004-04-29  JP Rosevear  <jpr@ximian.com>

	* gui/e-cal-model.c (e_cal_model_set_default_client): kill warning

2004-04-29  Jeffrey Stedfast  <fejj@ximian.com>

	* gui/migration.c (migrate_pilot_data): Removed the terminating
	NULL vararg since we don't need it for g_strdup_printf, it was
	only needed when it was g_build_filename(). Gets rid of a gcc
	warning.

2004-04-29  Not Zed  <NotZed@Ximian.com>

	* gui/e-itip-control.c (e_itip_control_set_data): check we find
	any usable components of the icalendar entry before dereferncing
	it.  Fixes crash in #57264.

2004-04-28  Not Zed  <NotZed@Ximian.com>

	* gui/e-itip-control.c (object_requested_cb): dont shadow source
	with another source in the fallback case.  Related to #54094.

2004-04-27  JP Rosevear  <jpr@ximian.com>

	* gui/cal-search-bar.c: disable comment searching which is
	currently useless

2004-04-27  JP Rosevear  <jpr@ximian.com>

	Fixes #52270 and #57593
	
	* gui/e-cal-model-tasks.c (ecmt_set_value_at): remove checks for
	start after due
	(ecmt_duplicate_value): copy the completed and due dates properly
	(ecmt_fill_component_from_model): only set the percent and status
	if the completion isn't set
	(ensure_task_partially_complete): ensure the task is not complete,
	in progress and make the percentage sensible if its 0 or 100
	(set_status): make sure the status and related vars are set
	properly
	(ecmt_set_value_at): handle status
	(ecmt_fill_component_from_model): make sure the click to add
	fields don't clobber each other
	(ecmt_is_cell_editable): status is editable

	* gui/e-cal-model-calendar.c (ecmc_duplicate_value): copy the
	dtend correctly

2004-04-27  Larry Ewing  <lewing@ximian.com>

	* gui/dialogs/calendar-setup.c: hook up the color picker and test
	buttons in the new task dialog.

	* gui/dialogs/calendar-setup.glade: fix visibility and color
	picker names.

2004-04-27  Larry Ewing  <lewing@ximian.com>

	* gui/dialogs/calendar-setup.c (new_calendar_test_uri): add
	handler for test button.
	(calendar_setup_new_calendar): connect test button, fill in color
	picker member.
	(source_to_dialog): set the color picker color if the source has
	one.
	(dialog_to_source): set the source color.
	
2004-04-27  Jeffrey Stedfast  <fejj@ximian.com>

	* gui/migration.c (migrate_tasks): Fixed the version checks for
	migrating pilot data.
	(migrate_calendars): Same.
	(migrate_pilot_data): Doh. Take a third argument to specify what
	component we are migrating ("todo" vs "calendar") so that we can
	compare against the correct filename. Might help :-)
	(migrate_pilot_db_key): Just set an empty value for the data since
	there's no way to actually get it and I don't think it really
	matters anyway.

2004-04-27  Kidd Wang  <kidd.wang@sun.com>

	* gui/e-cal-model-tasks.c: (ecmt_set_value_at): compare the start
	time and the due time only when both are not null.

2004-04-26  Jeffrey Stedfast  <fejj@ximian.com>

	* gui/migration.c (migrate_pilot_data): New function to migrate
	pilot data.
	(migrate_calendars): Migrate pilot data if upgrade version <=1.5.9
	(migrate_tasks): Same.

2004-04-23  Rodney Dawes  <dobey@ximian.com>

	* gui/alarm-notify/notify-main.c (main): Call e_icon_factory_init ()

	Fixes #57497

2004-04-22  Jeffrey Stedfast  <fejj@ximian.com>

	* conduits/calendar/calendar-conduit.c (start_calendar_server):
	Use e_cal_open_default() instead of e_cal_open().
	(map_name): Changed the path for the pilot map filename.
	(pre_sync): Changed the query to "#t" instead of "(#t)" and
	removed a duplicate block of code (seems to have been a paste-o?).

	* conduits/todo/todo-conduit.c (start_calendar_server): Use
	e_cal_open_default() instead of e_cal_open().
	(map_name): Changed the path for the pilot map filename.
	(pre_sync): Changed the query to "#t" instead of "(#t)" and
	removed a duplicate block of code (seems to have been a paste-o?).

2004-04-22  JP Rosevear  <jpr@ximian.com>

	Fixes #56092
	
	* gui/e-day-view.c (e_day_view_show_popup_menu): weak ref for the
	menu to be destroyed
	(popup_destroyed_cb): reset popup_event_num and popup_event_day

	* gui/e-week-view.c (e_week_view_show_popup_menu): weak ref for
	the menu to be destroyed
	(popup_destroyed_cb): reset the popup_event_num

2004-04-21  JP Rosevear  <jpr@ximian.com>

	* gui/calendar-component.c (create_new_event): make sure we don't
	deref a NULL pointer

2004-04-21  JP Rosevear  <jpr@ximian.com>

	Fixes #56504
	
	* gui/gnome-cal.c (gnome_calendar_destroy): no need to destroy the
	creatable item handler
	(gnome_calendar_set_ui_component): don't do the creatable
	item stuff here

	* gui/e-tasks.c (e_tasks_set_ui_component): don't do the creatable
	item stuff here
	(e_tasks_destroy): no need to destroy creatable item handler

	* gui/e-calendar-table.c (e_calendar_table_set_status_message):
	comment out temporarily

	* gui/e-calendar-view.c (e_calendar_view_set_status_message): ditto
	
	* gui/calendar-component.c: switch to using per component view
	information; don't listen for config changes to the primary
	selection and selection so that different windows can have
	different calendar selections; use a local creatable items handler
	so that the new button is associated with the right window when
	setting the default times

	* gui/tasks-component.c: ditto
	
2004-04-21  JP Rosevear <jpr@ximian.com>

	* gui/e-tasks.c (set_timezone): only set the preview zone if the
	preview has been created
	(setup_widgets): set the default zone for the preview pane

2004-04-21  JP Rosevear <jpr@ximian.com>

	Fixes #55797
	
	* gui/calendar-component.c (create_new_event): force an all day
	event if we are viewing the week, month or list view, which mimics
	double click in the view

2004-04-21  Frederic Crozat  <fcrozat@mandrakesoft.com>

	* gui/migration.c: (migrate_calendars):
	Fix crash when gconf value are not existing in the gconf
        database.

2004-04-21  Not Zed  <NotZed@Ximian.com>

	** Fixes #57034.
	
	* gui/dialogs/calendar-setup.c (create_new_source_with_group):
	NULL out source if we can't open the calendar.
	(source_group_menu_add_groups): if the group is readonly, then
	desensitise it.
	(source_group_menu_add_groups): return the first non-readonly
	calendar index.
	(calendar_setup_new_calendar): set the group history to the first
	non-readonly group.
	(calendar_setup_new_task_list): same.

	* gui/gnome-cal.c (gnome_calendar_set_ui_component): fix for
	user_creatable_items api changes.

	* gui/e-tasks.c (e_tasks_set_ui_component): fix for
	user_creatable_items api changes.

2004-04-19  Michael Terry  <mike@mterry.name>

	* gui/GNOME_Evolution_Calendar.server.in.in:
	* gui/calendar-commands.c:
	* gui/calendar-component.c:
	* gui/e-calendar-table.c:
	* gui/e-calendar-view.c:
	* gui/e-day-view-main-item.c:
	* gui/e-day-view-top-item.c:
	* gui/e-day-view.c:
	* gui/e-day-view.h:
	* gui/e-itip-control.c:
	* gui/e-timezone-entry.c:
	* gui/e-week-view-event-item.c:
	* gui/e-week-view.c:
	* gui/e-week-view.h:
	* gui/tasks-component.c:
	* gui/alarm-notify/alarm-notify-dialog.c:
	* gui/alarm-notify/alarm-queue.c:
	* gui/dialogs/comp-editor.c:
	* gui/dialogs/event-editor.c: Update the calendar to use the icon theme
	through the EIconFactory object in e-util

2004-04-19  JP Rosevear <jpr@ximian.com>

	* gui/gnome-cal.c (set_view): take a range_selected boolean for
	internal use
	(gnome_calendar_set_view): use above
	(display_view): use priv->range_selected, we'll set it correctly
	before this
	(display_view_cb): only pass focus boolean
	(gnome_calendar_on_date_navigator_selection_changed): set the view
	so the view menu is accurate

2004-04-18  JP Rosevear <jpr@ximian.com>

	Fixes #54021
	
	* importers/icalendar-importer.c (update_single_object): ensure
	UID exists

2004-04-18  JP Rosevear <jpr@ximian.com>

	Fixes #53124
	
	* gui/e-tasks.c: remove preview pieces, they are in their own
	class now; use the new class for preview

	* gui/e-cal-component-preview.[hc]: implement a preview area for
	tasks and events

2004-04-17  Trent Lloyd  <lathiat@sixlabs.org>

	* gui/e-calendar-view.c: include libecal/e-cal-component.h to kill
	implicit declaration of e_cal_component_get_recur_id_as_string at line
	869.

2004-04-15 Gary Ekker <gekker@novell.com>

	Fixes #52271

	* gui/e-cal-model-tasks.c: (set_percent): shouldn't call 
	ensure_task_not_complete here, it removes the percent property that 
	we just set.
	

2004-04-15  JP Rosevear  <jpr@ximian.com>

	* gui/dialogs/task-page.c (task_page_fill_component): don't
	actually check if start date is after due date, its perfectly
	valid for that to occur

2004-04-15  JP Rosevear  <jpr@ximian.com>

	Fixes #53903
	
	* gui/dialogs/meeting-page.c (meeting_page_fill_widgets):
	show/hide add button properly
	(change_clicked_cb): ditto

	* gui/dialogs/comp-editor.c (needs_send_cb): call back when "needs_send"
	(page_changed_cb): use accessor
	
2004-04-15  JP Rosevear  <jpr@ximian.com>

	* gui/dialogs/comp-editor.c (save_comp): stop listening to changes
	since we are just going to save and close
	(save_cmd): remove, its ok since we are toasting menus shortly
	anyhow
	(obj_modified_cb): no need to look at update flag
	(obj_removed_cb): ditto

2004-04-15  Gary Ekker  <gekker@novell.com>

	* gui/calendar-component.h: move the calendar publishing initialization
	from createControls to main.c

	* gui/calendar-component.c: (create_controls): Ditto

	* gui/main.c: (initialize): Ditto

	* gui/dialogs/cal-prefs-dialog.c: (url_list_changed): remove a gfree
	that was freeing a before it should have been. Also removed cruft from 
	a previous attempt to fix the crash.

2004-04-15  Rodrigo Moya <rodrigo@ximian.com>

	* gui/dialogs/select-source-dialog.c (select_source_dialog): added some
	spacing.

	* gui/e-calendar-view.c (e_calendar_view_delete_selected_occurrence):
	use the DTSTART for the recur-id if it's not available.

2004-04-14  Larry Ewing  <lewing@ximian.com>

	* gui/calendar-component.c (selector_tree_drag_motion): fix
	missing parameters, wow that was a mess.

	* gui/dialogs/calendar-setup.glade: add the new "new" dialogs,
	remove the old druids.

	* gui/dialogs/calendar-setup.c (calendar_setup_new_calendar): use
	the new dialogs, colors are still not functional.
	(calendar_setup_new_task_list): use the new dialogs, with no colors.

2004-04-14  JP Rosevear <jpr@ximian.com>

	Fixes #56613
	
	* gui/gnome-cal.h: add proto

	* gui/gnome-cal.c (client_cal_opened_cb): key the clients by uid
	(backend_died_cb): ditto
	(gnome_calendar_add_source): ditto
	(gnome_calendar_remove_source): use remove_source_by_uid
	(gnome_calendar_remove_source_by_uid): new function to remove a
	source by uid
	(gnome_calendar_set_default_source): key the clients by uid

	* gui/calendar-component.c (update_task_selection): the source
	could be NULL if the source was deleted rather than unchecked
	(update_primary_task_selection): look at the task source list

2004-04-14  JP Rosevear <jpr@ximian.com>

	Fixes #56553
	
	* importers/icalendar-importer.c (prepare_events): don't double
	free or continue, we need to move to the next item
	 (prepare_tasks): don't continue, move to the next item
	
2004-04-14  Not Zed  <NotZed@Ximian.com>

	* gui/tasks-component.c (impl_createControls): Same as below for
	the tasks component.

	* gui/calendar-component.c (impl_createControls): add the info
	area label widget to the sidebar control (c&p the addressbook
	code).

2004-04-12  Gary Ekker  <gekker@novell.com>

        Fixes #56628
	
	* gui/calendar-component.c (create_new_event): Add informational dialog
	when user attempts event creation in read-only calendar.
	

2004-04-09  Gary Ekker  <gekker@novell.com>

	* gui/dialogs/url-editor-dialog.c: Fixed to use e-passwords.

	* gui/dialogs/cal-prefs-dialog.c: Fixed crash and bugs created by 
	changes made for instant apply.

	* gui/itip-utils.c: Fixed to use e-passwords.

	* gui/e-pub-utils.c: Fixed to use e-passwords.
	(just_published): Fixed error in logic.
	(e_pub_publish): Fixed crash if ESource is NULL.
	

2004-04-09  Chris Toshok  <toshok@ximian.com>

	* gui/dialogs/e-delegate-dialog.c (e_delegate_dialog_construct):
	EABDestination -> EDestination.
	(e_delegate_dialog_get_delegate): same.
	(e_delegate_dialog_get_delegate_name): same.

	* gui/dialogs/alarm-options.c (alarm_to_malarm_widgets):
	EABDestination -> EDestination.
	(malarm_widgets_to_alarm): same.

	* gui/e-select-names-editable.c
	(e_select_names_editable_get_address): EABDestination ->
	EDestination.
	(e_select_names_editable_get_name): same.

	* gui/e-meeting-list-view.c (process_section): EABDestination ->
	EDestination.
	(select_names_ok_cb): same.

2004-04-09  Dan Winship  <danw@ximian.com>

	* gui/gnome-cal.c (gnome_calendar_set_ui_component): Create an
	EUserCreatableItemsHandler for the view if there isn't one yet,
	and then activate it.
	(gnome_calendar_destroy): destroy it.

	* gui/calendar-component.c (impl__get_userCreatableItems): add
	object/folder flags to items.

	* gui/e-tasks.c (e_tasks_set_ui_component): Create an
	EUserCreatableItemsHandler for the view if there isn't one yet,
	and then activate it.
	(e_tasks_destroy): destroy it.

	* gui/tasks-component.c (impl__get_userCreatableItems): add
	object/folder flags. Change "Task List" to "Tasks Group" per new
	specs.

	* gui/calendar-commands.c (calendar_control_deactivate): clear the
	GnomeCal's ui_component rather than setting it again

2004-04-07  Jeffrey Stedfast  <fejj@ximian.com>

	* gui/dialogs/cal-prefs-dialog.c: Fixed to be instant-apply.

2004-04-07  JP Rosevear <jpr@ximian.com>

	* gui/e-cal-model.c (e_cal_model_set_default_client): just add the
	client, we have protection against re-adding it any how
	(cal_opened_cb): stop listening to the open signal

2004-04-07  JP Rosevear <jpr@ximian.com>

	* gui/gnome-cal.c (gnome_calendar_dayjump): remove extra set view
	params
	(gnome_calendar_set_view): simplify, just set the current view id
	and let the gal view stuff do the rest
	(display_view): modify from set_view, don't set the view id here
	or update the default view config setting
	(display_view_cb): update the date navigator
	(gnome_calendar_construct): kill the default view stuff, gal view
	handles that
	(gnome_calendar_on_date_navigator_selection_changed): use display_view

	* gui/e-week-view.c (time_range_changed_cb): ditto
	(e_week_view_set_selected_time_range): just set the selection,
	don't fool with the base date
	(e_week_view_on_button_press): do a full day event if double
	clicked on

	* gui/e-day-view.c (time_range_changed_cb): only set the selection
	if we can't preserve an existing selection

	* gui/control-factory.c (set_prop): allow list view, remove
	default view usage

	* gui/calendar-config.h: remove protos

	* gui/calendar-config.c: remove default view calls

	* gui/calendar-commands.c (show_day_view_clicked): remove extra
	params to gnome_calendar_set_view
	(show_work_week_view_clicked): ditto
	(show_week_view_clicked): ditto
	(show_month_view_clicked): ditto
	(show_list_view_clicked): ditto

	* gui/apps_evolution_calendar.schemas.in.in: remove default view
	setting, gal view remembers this for us

2004-04-05  JP Rosevear <jpr@ximian.com>

	* gui/e-week-view.c (time_range_changed_cb): only select one day

2004-04-05  Rodrigo Moya <rodrigo@ximian.com>

	* gui/alarm-notify/alarm-queue.c: removed commented code.

	* gui/alarm-notify/notify-main.c (main): removed useless call to set
	the POA after construction.

2004-04-05  Rodrigo Moya <rodrigo@ximian.com>

	Fixes #56316

	* gui/dialogs/comp-editor-page.[ch]: added "fill_timezones" virtual
	method to CompEditorPage class.
	(comp_editor_page_fill_timezones): new function.
	(comp_editor_page_class_init): initialize new virtual method.

	* gui/dialogs/event-page.c (event_page_fill_timezones,
	event_page_class_init):
	* gui/dialogs/task-page.c (task_page_fill_timezones,
	task_page_class_init):
	* gui/dialogs/task-details-page.c (task_details_page_fill_timezones,
	task_details_page_class_init): implemented new virtual method for pages
	dealing with timezones.

	* gui/dialogs/comp-editor.c (save_comp): call the "fill_timezones"
	method on all pages, and call...
	(send_timezone): ...this function for each hash table item.

2004-04-01  Rodrigo Moya <rodrigo@ximian.com>

	* gui/gnome-cal.c (client_cal_opened_cb): set the default timezone
	on all clients when opened.

2004-04-01  Radek Doulik  <rodo@ximian.com>

	* gui/e-calendar-view.c
	(e_calendar_view_delete_selected_occurrence): fix small typo

2004-04-01  Rodrigo Moya <rodrigo@ximian.com>

	* gui/dialogs/recur-comp.c (recur_component_dialog): return correct
	values (boolean).

2004-03-31  JP Rosevear <jpr@ximian.com>

	* gui/migration.c (migrate_calendars): make sure we unset the
	float value for the panes if converting from 1.4 and earlier

2004-03-31  JP Rosevear  <jpr@ximian.com>

	Fixes #56120
	
	* gui/gnome-cal.c (append_category_cb): update the correct element
	(client_categories_changed_cb): pass the array, not a reference to
	it

2004-03-31  Rodrigo Moya <rodrigo@ximian.com>

	* gui/gnome-cal.c: fixed documentation typos.

2004-03-31  Sarfraaz Ahmed <asarfraaz@novell.com>

	* gui/config-control.c (set_prop) : Replaced add_event_source 
	with add_source and passed the VEVENT type as argument.

2004-03-30  William Jon McCann  <mccann@jhu.edu>

	* gui/dialogs/calendar-setup.glade:
	* gui/dialogs/calendar-setup.c (new_task_list_finish)
	(calendar_setup_new_task_list, calendar_setup_edit_task_list):
	add remote calendar setup page to task list setup assistant and
	edit dialog.  Remove separators from dialog.

2004-03-29  Larry Ewing  <lewing@ximian.com>

	* gui/calendar-component.c (selector_tree_drag_data_received):
	deal with the action type a properly. in the normal case.
	
	* gui/calendar-component.c (selector_tree_drag_data_received):
	call drag_finish properly, change the uid.
	(selector_tree_drag_motion): set drag status properly.

2004-03-29  William Jon McCann  <mccann@jhu.edu>

	* gui/tasks-component.c (delete_task_list_cb): 
	* gui/calendar-component.c (delete_calendar_cb):
	don't require client to be loaded in order to remove the source

	* gui/migration.c (create_task_sources, migrate_tasks): create
	On The Web source group for tasks.

2004-03-29  Hari Prasad Nadig  <hp@ndeepak.info>

	* gui/goto-dialog.glade: Naming issue, Go to Date -> Select Date,
	Go to Today -> Select today. Solves 48293
	
	* gui/e-calendar-view.c: gives aid to the above change.

2004-03-29  Rodrigo Moya <rodrigo@ximian.com>

	* gui/alarm-notify/alarm-queue.c (query_objects_changed_cb): removed
	misplaced return statement that prevented the rest of the objects list
	to be processed.

2004-03-29  Kidd Wang  <kidd.wang@sun.com>

	* gui/e-calendar-view.c: (e_calendar_view_class_init): remove the
 	EVENT_MOVE signal which was binded to Alt + Arrows.
 	* gui/e-calendar-view.h: ditto.
 	* gui/e-day-view.c: (e_day_view_class_init),
	(e_day_view_do_key_press), (e_day_view_event_move): handle Alt + Arrows
	in the more general place e_day_view_do_key_press so that we can avoid
	the conflicting accessible key. When an appointment is selected,
	pressing Alt + Arrows causes it to be moved around. Otherwise, pressing
	Alt + LEFT/RIGHT will move the focus to the same day in the
	previous/next week.
	* gui/e-week-view.c: (e_week_view_class_init),
	(e_week_view_event_move), (e_week_view_do_key_press): ditto.

2004-03-26  JP Rosevear <jpr@ximian.com>

	* gui/e-cal-model.c (update_e_cal_view_for_client): guard against
	the case that we redo queries while still waiting for a client to
	open

2004-03-26  JP Rosevear  <jpr@ximian.com>

	Fixes #53134
	
	* gui/e-cal-model.c (get_description): make sure to set the string
	to NULL so that if this component doesn't have a description we
	don't double free next time we are called

2004-03-26  JP Rosevear <jpr@ximian.com>

	* gui/migration.c (migrate_calendars): no need to explicitly add
	the contacts group, the create function does this properly

2004-03-26  JP Rosevear <jpr@ximian.com>

	* gui/migration.c (migrate_calendars): make sure we always sync
	the source list and just do it once; unref the sources we get
	(migrate_tasks): make sure we always sync
	the source list and just do it once

2004-03-26  JP Rosevear <jpr@ximian.com>

	Fixes #55648
	
	* gui/print.c (print_todo_details): get the default from the model

	* gui/gnome-cal.h: remove and update protos

	* gui/gnome-cal.c (update_query): the clients and client_list
	members are now arrays of source types
	(setup_widgets): default the query to everything for tasks, cast
	the config items
	(gnome_calendar_init): init all the client hashs
	(gnome_calendar_destroy): clean them up, clean up all categories
	(client_cal_opened_cb): handle based on source type
	(append_category_cb): don't track the size in the closure
	(client_categories_changed_cb): do all the merging here
	(backend_died_cb): handle based on source type
	(gnome_calendar_construct): we don't special case the task stuff
	any more
	(gnome_calendar_get_default_client): return the default of the
	current view
	(gnome_calendar_add_source): take a source type argument and
	append accordingly
	(gnome_calendar_remove_source): similar, but remove accordingly
	(gnome_calendar_set_default_source): take a source type argument and
	set the default accordingly
	(gnome_calendar_new_task): use the default of the task model

	* gui/e-calendar-view.c (e_calendar_view_add_event): kill warning

	* gui/calendar-component.c (update_uris_for_selection): pass
	source type when adding/removing
	(update_uri_for_primary_selection): ditto
	(update_task_selection): make sure we show the correct list of
	tasks
	(update_primary_task_selection): make sure we track the primary
	task correctly
	(delete_calendar_cb): pass source type when removing
	(config_primary_selection_changed_cb): config listener callback
	for tasks
	(config_tasks_selection_changed_cb): ditto
	(impl_createControls): load the initial task selection, listen for
	changes
	(calendar_component_init): get the source lists

	* gui/calendar-commands.c (sensitize_taskpad_commands): get the
	task pad and then the default client from that

2004-03-26  JP Rosevear <jpr@ximian.com>

	* gui/e-cal-model.c (find_client_data): finds the client data for
	a client
	(cal_opened_cb): update the query
	(add_new_client): return client data
	(e_cal_model_add_client): add the client immediately no matter
	what, and possibly wait for it to open
	(remove_client): guard against NULL query
	(e_cal_model_remove_client): use find_client_data
	(e_cal_model_dispose): guard against a NULL query

2004-03-25  JP Rosevear <jpr@ximian.com>

	* gui/e-cal-model.c (remove_client): fix off by one error when
	emitting deleted signal

2004-03-25  JP Rosevear <jpr@ximian.com>

	Fixes #53499
	
	* gui/gnome-cal.c (setup_widgets): don't give the state file to
	the list view
	(set_view): ensure that if the list view was in custom mode it
	stays that way
	(display_view_cb): attach to the etable of the list view
	(gnome_calendar_setup_view_menus): use an etable gal view for the
	list view and don't set the view twice

	* gui/e-tasks.c (e_tasks_setup_view_menus): the instance should no
	longer be per task uri since all the uris are shown together

	* gui/e-cal-list-view.h: update/add protos

	* gui/e-cal-list-view.etspec: limit the available columns to what
	product design agreed on

	* gui/e-calendar-table.etspec: ditto

	* gui/e-cal-list-view.c (e_cal_list_view_class_init): ignore
	update query calls
	(e_cal_list_view_load_state): make public
	(e_cal_list_view_save_state): ditto
	(setup_e_table): don't handle state saving ourselves
	(e_cal_list_view_construct): ditto
	(e_cal_list_view_new): ditto
	(e_cal_list_view_destroy): ditto

	* gui/calendar-view.c (calendar_view_get_type_code): we don't
	handle the list view here

	* gui/calendar-view-factory.c
	(calendar_view_factory_get_type_code): we don't handle the list
	view here
	(calendar_view_factory_get_title): ditto

2004-03-24  Rodrigo Moya <rodrigo@ximian.com>

	* gui/gnome-cal.c (update_query): don't create queries for the clients
	that are not loaded yet.

2004-03-24  JP Rosevear <jpr@ximian.com>

	* gui/gnome-cal.c (client_cal_opened_cb): remove debug code that
	slipped in

2004-03-24  Danilo Å egan  <dsegan@gmx.net>

	* gui/e-alarm-list.c (get_alarm_duration_string): Use ngettext for
	handling plural forms (fixes bug #53464). 
	* gui/dialogs/delete-comp.c (delete_component_dialog): Likewise.
	* gui/e-itip-control.c (write_recurrence_piece): Likewise.

2004-03-23  JP Rosevear <jpr@ximian.com>

	Fixes #51948
	
	* gui/dialogs/meeting-page.c (button_press_event): compile this
	again, determine the row with a different method
	(button_press_event): pass mpage
	(meeting_page_construct): listen for button press event

	* gui/e-meeting-list-view.c: remove commit that wasn't supposed to
	go in

2004-03-23  JP Rosevear <jpr@ximian.com>

	* gui/e-calendar-view.c: make the flow control correct

2004-03-23  JP Rosevear <jpr@ximian.com>

	* gui/migration.c (create_calendar_sources, create_task_sources):
	ensure that only one Personal calendar/task list gets created when
	moving between minor versions

2004-03-23  JP Rosevear  <jpr@ximian.com>

	* gui/dialogs/copy-source-dialog.c (copy_source): remove unused
	variable

	* gui/e-cal-model.c (e_cal_model_copy_component_data): make the
	precondition return NULL

	* gui/control-factory.c (get_prop): make sure this code isn't
	reached

	* gui/calendar-component.c
	(calendar_component_peek_source_selector): cast to kill warning

2004-03-23 Umesh Tiwari   <tiwariumesh232@rediffmaiil.com>

	For bug#53417

	* gui/e-tasks.c:
	Clear the preview panel after the last task is deleted.

2004-03-23  Alfred Peng <alfred.peng@sun.com>

	* gui/dialogs/alarm-options.c (malarm_widgets_to_alarm): get
	the mail alarm description message from "malarm_description"
	instead of "dalarm_description".

2004-03-23  Alfred Peng <alfred.peng@sun.com>

	* gui/alarm-notify/alarm-queue.c (audio_notification): If there
	is no attachment for a audio reminder, only a message window
	shows up.
	Get a beep sound even without attachment for audio reminder.

2004-03-22  Rodrigo Moya <rodrigo@ximian.com>

	* gui/e-calendar-view.c (e_calendar_view_add_event): get the UID
	from the server on newly created events and set the ECalComponent's
	UID to that, for further operations.

2004-03-20  Rodrigo Moya <rodrigo@ximian.com>

	* gui/e-calendar-view.c: added 'Copy/Move to Calendar' menu entries.
	(on_copy_to, on_move_to): callbacks for new menu items.
	(on_print_event): don't leak selection list.

2004-03-19  JP Rosevear  <jpr@ximian.com>

	Fixes #55716
	
	* gui/e-cal-model.c (remove_client): unset the default if the
	client removed was the default

2004-03-19  Rodrigo Moya <rodrigo@ximian.com>

	* gui/calendar-component.c (update_uris_for_selection): if
	gnome_calendar_add_event_source fails, don't add the client to the
	internal client list.

2004-03-19  JP Rosevear <jpr@ximian.com>

	Fixes #55723
	
	* gui/e-day-view.c (process_component): compare ecalcomponents,
	not icalcomponents (the compare func is borked), check recurrence
	changes better
	(e_day_view_init): just use the model the parent creates

	* gui/e-week-view.c (process_component): create the temporary item
	from the correct icalcomp
	(e_week_view_init): just use the model the parent creates

2004-03-18  Rodrigo Moya <rodrigo@ximian.com>

	* gui/dialogs/select-source-dialog.c (select_source_dialog): create
	an ESourceSelector instead of a ESourceOptionMenu, to be consistent
	with the other components, and create a scrolled window to hold the
	source selector.
	(primary_selection_changed_cb): callback for "primary_selection_changed"
	signal in the ESourceSelector.

2004-03-18  Alfred Peng <alfred.peng@sun.com>

	* Fix #51187 on bugzilla of ximian
	* gui/alarm-notify/alarm-queue.c (query_objects_changed_cb):
	If "alarms" or "alarms->alarms" is NULL after querying a calendar
	for the alarms of a particular object, the reuse of "cqa" will
	probably cause evolution-alarm-notify to crash.
	So remove "cqa" when "alarms" or "alarms->alarms" is NULL. Otherwise
	update it.

2004-03-17  hpnadig  <hp@ndeepak.info>

	* gui/dialogs/task-page.glade: Capitalized words changed. Solves 48115.

	* gui/dialogs/task-details-page.glade: s/Date Completed/Date completed.

	* gui/e-calendar-table.etspec: Capitalization checked. Solves 48130.

2004-03-17 Gary Ekker <gekker@novell.com>

	Fixes #55292
	
	* gui/e-pub-utils.c (e_pub_publish): fix a crash when trying to
	publish a NULL component

2004-03-16  Rodrigo Moya <rodrigo@ximian.com>

	* gui/dialogs/select-source-dialog.[ch]: new dialog for allowing the
	user to select a source.

	* gui/dialogs/copy-source-dialog.c (copy_source_dialog): use the
	select_source_dialog function to ask user for the source to use.
	(source_selected_cb): removed unneeded function.

	* gui/dialogs/Makefile.am: added new files.

2004-03-16  Rodrigo Moya <rodrigo@ximian.com>

	* gui/calendar-commands.c
	(calendar_control_sensitize_calendar_commands): check if the selected
	event has its associated ECalModelComponent.

2004-03-15  JP Rosevear  <jpr@ximian.com>

	* gui/e-tasks.c (search_bar_sexp_changed_cb): set the search query
	(e_tasks_init): set the query to be #t by default

	* gui/e-cal-model.c (redo_queries): use the search query if there
	is one (and no time is set), make sure to dup the #f

2004-03-15  JP Rosevear <jpr@ximian.com>

	* gui/dialogs/comp-editor-page.c (comp_editor_page_fill_widgets):
	use right cast macro

2004-03-15  JP Rosevear  <jpr@ximian.com>

	* Rename e-cal-view to e-calendar-view and fix includes
	
	* gui/dialogs/comp-editor-page.c (comp_editor_page_fill_widgets):
	pre-conditions should return FALS

	* gui/e-cal-model.c (copy_ecdv): return the new struct

	* gui/Makefile.am: build renamed files

2004-03-15  JP Rosevear <jpr@ximian.com>

	Fixes #52253
	
	* gui/print.c (print_week_summary_cb): copy component data

	* gui/gnome-cal.c (get_times_for_views): calculate the time range
	for each view
	(set_search_query): set the search query on the model
	(set_week_start): set the week start day
	(week_start_changed_cb): track if it changes
	(setup_config): set its notification
	(setup_widgets): update the view times and date navigator
	(gnome_calendar_init): remove dead values
	(gnome_calendar_goto_date): just calc the new time and let
	update_view_times handle it
	(gnome_calendar_goto): ditto
	(gnome_calendar_direction): ditto
	(gnome_calendar_set_selected_time_range): ditto
	(gnome_calendar_dayjump): ditto
	(update_view_times): set the time ranges on the models
	(set_view): use the new preserve day setting
	(gnome_calendar_set_view): don't update the view times, just
	switch
	(gnome_calendar_get_selected_time_range): get the time range
	(gnome_calendar_on_date_navigator_selection_changed): don't
	re-update the date navigator, centralize the view setting

	* gui/e-week-view.c (time_range_changed_cb): handle the time range
	changing
	(process_component): move here
	(model_changed_cb): handle the model changing
	(update_row): updated a changed row
	(model_row_changed_cb): update a row
	(model_cell_changed_cb): ditto
	(model_rows_inserted_cb): handle events being added
	(row_deleted_check_cb, remove_uid_cb, model_rows_deleted_cb):
	handle events being deleted
	(timezone_changed_cb): handle timezone changing
	(e_week_view_init): create the model and listen to it
	(e_week_view_new): don't create the model here
	(e_week_view_set_selected_time_range): no need to cast
	(e_week_view_set_first_day_shown): ditto
	(e_week_view_set_weeks_shown): ditto
	(e_week_view_update_event_cb): free and copy the data using new
	routines
	(e_week_view_foreach_event): step through every event
	(e_week_view_remove_event_cb): we no longer track allocated status
	(e_week_view_on_button_release): don't set the seleciton in the
	calendar
	(e_week_view_free_events): free the data with the util
	(e_week_view_add_event): no need to track allocated status
	(e_week_view_on_adjustment_changed): no need to cast

	* gui/e-day-view.c (e_day_view_class_init): update query is no
	longer used via class method
	(time_range_changed_cb): handle the time range changing
	(process_component): move here
	(model_changed_cb): handle the model changing
	(update_row): updated a changed row
	(model_row_changed_cb): update a row
	(model_cell_changed_cb): ditto
	(model_rows_inserted_cb): handle events being added
	(row_deleted_check_cb, remove_uid_cb, model_rows_deleted_cb):
	handle events being deleted
	(timezone_changed_cb): handle timezone changing
	(e_day_view_init): create a model, connect to its signals
	(e_day_view_destroy): we don't have our own query anymore
	(e_day_view_update_event_cb): free and copy the data using new
	routines
	(e_day_view_remove_event_cb): we no longer track allocated status
	(e_day_view_set_selected_time_range): actually set the selection
	(e_day_view_recalc_day_starts): no need to cast
	(e_day_view_recalc_work_week): ditto
	(e_day_view_update_calendar_selection_time): don't call back to
	the main calendar
	(e_day_view_free_event_array): use the free util
	(e_day_view_add_event): don't track allocated status

	* gui/e-calendar-marshal.list: add marshaller

	* gui/e-cal-view.h: remove field

	* gui/e-cal-view.c: no longer listen for model signals
	(e_calendar_view_class_init): make the model arg not construct
	time

	* gui/e-cal-model.h: update/add protos

	* gui/e-cal-model.c (e_cal_model_class_init): set the dispose
	handler and add a time_range_changed signal
	(e_cal_model_init): defaults for queries
	(e_cal_model_dispose): dispose of things
	(e_cal_model_finalize): remove bits that are in dispose now
	(search_by_uid_and_client): allow NULL client to find any uid
	(e_cal_view_objects_added_cb): ref the client
	(update_e_cal_view_for_client): use the full query
	(remove_client): pre change for each row and emit deleted signals
	(redo_queries): relaunch the query for each client
	(e_cal_model_get_time_range): get the time range
	(e_cal_model_set_time_range): set the time range and redo the
	queries
	(e_cal_model_set_search_query): get the search query
	(e_cal_model_set_search_query): set the search query and redo the
	queries
	(e_cal_model_get_component_for_uid): get the component info based
	on uid
	(copy_ecdv): copy and ECellDateEditValue
	(e_cal_model_copy_component_data): copy component data
	(e_cal_model_free_component_data): unref the client

2004-03-15  Rodrigo Moya <rodrigo@ximian.com>

	Fixes #48112

	* gui/calendar-commands.c (calendar_control_sensitize_calendar_commands):
	disable the 'Delete' menu item on recurring meetings, since 'Delete all
	Occurrences' already deals with that.

2004-03-15  Rodrigo Moya <rodrigo@ximian.com>

	Fixes #35577

	* gui/e-cal-view.c (e_calendar_view_delete_selected_occurrence):
	if the component is an instance, pass the recurrence ID to
	e_cal_remove_object_with_mod. Also, make the user confirm the
	deletion, and send the cancellation message for meetings.

2004-03-12  Not Zed  <NotZed@Ximian.com>

	* gui/e-cal-model.c (ecm_initialize_value): return "" instead of
	NULL if there is no default_category set.  Fixes #53419.

2004-03-09  Kidd Wang  <kidd.wang@sun.com>

	* gui/e-day-view.c: (e_day_view_finish_long_event_resize): add a call
	to e_cal_component_commit_sequence since we have changed the property
	of the component. Whether the new event is all day should also be
	set properly according to the value of the original event.

2004-03-08  Rodrigo Moya <rodrigo@ximian.com>

	Fixes #48106

	* gui/dialogs/alarm-page.glade: s/Send an Email/Send an email.

2004-03-05  Rodrigo Moya <rodrigo@ximian.com>

	* gui/alarm-notify/alarm-notify.c (alarm_notify_init): set a GConf
	listener callback to list for changes in selected calendars.
	(alarm_notify_finalize): remove the GConf notification listener.
	(conf_changed_cb): callback to react on configuration changes. Process
	the new selected calendars and remove the unselected ones.
	(process_removal_in_hash): callback to remove unselected calendars.

2004-03-04  Rodrigo Moya <rodrigo@ximian.com>

	Fixes #50294

	* gui/e-tasks.c (setup_widgets): connect to "model_rows_deleted" signal
	on the ETable's model.
	(model_rows_deleted_cb): callback for clearing the preview widget when
	the currently selected task is removed.

2004-03-04  Rodrigo Moya <rodrigo@ximian.com>

	* gui/calendar-commands.c (calendar_control_sensitize_calendar_commands):
	set the sensitivity correctly, depending on whether the command applied
	to the currently selected event or the default client.
	(calendar_control_activate): make sure we start with the menu items
	correctly enabled/disabled.

2004-03-04  Rodrigo Moya <rodrigo@ximian.com>

	Fixes #53496

	* gui/dialogs/cal-prefs-dialog.glade: set the same spacing for all
	tabs in the notebook.

2004-03-04  Rodrigo Moya <rodrigo@ximian.com>

	* gui/dialogs/comp-editor.c (comp_editor_append_page): always add
	the page.

	* gui/dialogs/event-page.c (event_page_fill_widgets): continue filling
	up all other fields even if there are missing ones, and return the
	validation result.

2004-03-04  Rodrigo Moya <rodrigo@ximian.com>

	* gui/alarm-notify/alarm-notify-dialog.c (alarm_notify_dialog):
	don't make the dialog window sticky, the icon on the system tray
	already shows in all workspaces.

2004-03-04  Rodrigo Moya <rodrigo@ximian.com>

	Fixes #54028

	* gui/alarm-notify/alarm-queue.c (query_objects_changed_cb): fixed the
	time range for the alarm query, to include the end of today.

2004-03-04  Rodrigo Moya <rodrigo@ximian.com>

	Fixes #53137

	* gui/dialogs/comp-editor-page.[ch]: made fill_widgets virtual
	method return a gboolean.
	(comp_editor_page_fill_widgets): return value from virtual method
	implementation.

	* gui/dialogs/event-page.c (event_page_fill_widgets):
	* gui/dialogs/meeting-page.c (meeting_page_fill_widgets):
	* gui/dialogs/recurrence-page.c (recurrence_page_fill_widgets):
	* gui/dialogs/schedule-page.c (schedule_page_fill_widgets):
	* gui/dialogs/task-details-page.c (task_details_page_fill_widgets):
	* gui/dialogs/task-page.c (task_page_fill_widgets):
	* gui/dialogs/alarm-page.c (alarm_page_fill_widgets): return value,
	as expected from the virtual method signature.

	* gui/dialogs/comp-editor.c (comp_editor_append_page): dont add the
	page if there was an error calling the fill_widgets method.

2004-03-03  Rodrigo Moya <rodrigo@ximian.com>

	* gui/e-cal-model.c (e_cal_model_add_client): prevent from adding
	the same client more than once.

2004-03-02  Rodrigo Moya <rodrigo@ximian.com>

	* gui/cal-search-bar.c: added support for searching the location
	field also.
	(regen_query): take into account the new search field.

2004-03-02  JP Rosevear <jpr@ximian.com>

	* gui/Makefile.am: remove conduit dir creation

2004-03-02  Larry Ewing  <lewing@ximian.com>

	* gui/calendar-component.c: add untested start of dnd support for
	source selector.

2004-03-01  Dan Winship  <danw@ximian.com>

	* gui/alarm-notify/alarm-notify.c: fix rampant double-freeing.

2004-03-01  Rodrigo Moya <rodrigo@ximian.com>

	* gui/itip-utils.c (comp_server_send): pass the user list and
	returned icalcomponent to e_cal_send_objects().

2004-03-01  Kidd Wang  <kidd.wang@sun.com>

	* gui/print.c: (print_date_label): ignore the timezone info of all-day
	events.

2004-02-27  JP Rosevear <jpr@ximian.com>

	* gui/gnome-cal.h: remove proto

	* gui/gnome-cal.c (set_query): rename from
	gnome_calendar_set_query and make static

	* gui/e-day-view.h: remove proto for dead function

	* gui/e-day-view.c: guard config.h include

2004-02-26  Rodney Dawes  <dobey@ximian.com>

	* gui/e-meeting-time-sel.c (e_meeting_time_selector_construct):
	Create the arrows in these widgets as GTK_SHADOW_NONE, since the
	default arrow type in GTK+ 2.x is flat triangle arrows, and shadow
	types are generally ignored for arrows anyway, and so we don't look
	ugly with themes that handle shadow types on arrows correctly

2004-02-26  Rodney Dawes  <dobey@ximian.com>

	* gui/alarm-notify/GNOME_Evolution_Calendar_AlarmNotify.server.in.in:
	Fix the repo_id to include the evolution base version

2004-02-26  JP Rosevear <jpr@ximian.com>

	* gui/gnome-cal.c (client_cal_opened_cb): make sure we unref the
	task pad client and the calendar clients are unreffed by the hash
	table

2004-02-24  JP Rosevear <jpr@ximian.com>

	* gui/migration.c (migrate_calendars): fix float type pane
	position keys (we migrated these improperly in the past), just use
	the default value

	Fixes #53087

2004-02-18  Rodrigo Moya <rodrigo@ximian.com>

	* gui/alarm-notify/alarm-notify.c (free_client_hash): remove the client
	from the queue also.

	* gui/gnome-cal.c (client_cal_opened_cb): set the task pad client to NULL
	if opening it failed. Show more verbose status bar messages.

2004-02-18  Rodrigo Moya <rodrigo@ximian.com>

	* common/authentication.c (auth_func_cb): call first e_passwords_get_password
	before calling _ask_password.

	* gui/alarm-notify/alarm-queue.c (query_objects_changed_cb): add 1 second
	to the last notification time, or we'll get many times the same notification.

2004-02-18  Kidd Wang  <kidd.wang@sun.com>

	* gui/e-cal-view.c: (e_calendar_view_add_event),
	(clipboard_get_text_cb): make copy & paste and drag & drop behave
	the same way described as follows:
	In day view and work week view
		from main canvas to top canvas
			before copy or drag: short event
			after paste or drop: all-day event
		from main canvas to main canvas
			before copy or drag: short event
			after paste or drop: short event
		from top canvas to top canvas
			before copy or drag: all-day event
			after paste or drop: all-day event			
			before copy or drag: long event
			after paste or drop: long event
		from top canvas to main canvas
			before copy or drag: all-day event
			after paste or drop: short event
			before copy or drag: long event
			after paste or drop: short event
	In week view, month view and list view life is pretty simple since
	there's no top canvas in these three views. We just get what we copy
	or drag after we perform paste or drop.

2004-02-18  Kidd Wang  <kidd.wang@sun.com>

	* gui/itip-utils.c: (itip_send_comp): set the string length properly.

2004-02-16  Rodrigo Moya <rodrigo@ximian.com>

	* gui/alarm-notify/alarm-queue.c (tray_icon_clicked_cb): removed buggy
	characters from menu items' texts.

2004-02-16  Rodrigo Moya <rodrigo@ximian.com>

	* gui/alarm-notify/alarm-notify.c (alarm_notify_add_calendar): open the
	calendars asynchonously.
	(cal_opened_cb): callback for "cal_opened" signal. Add the calendars to
	the alarm queue here.

	* gui/alarm-notify/alarm-queue.c (query_objects_changed_cb): get alarms
	since the last notification, only use current time when there is no
	previous notification time.

	* gui/alarm-notify/notify-main.c (init_session): set session restart
	style to RESTART_IF_RUNNING.

2004-02-16  Rodrigo Moya <rodrigo@ximian.com>

	* gui/alarm-notify/notify-main.c: no need to keep the master client.
	(init_session): just set the daemon's restart style, not the restart
	command. Connect to "save_yourself" signal on the session also.
	(save_session_cb): set the restart command here.

2004-02-12  Hans Petter Jansson  <hpj@ximian.com>

	* gui/dialogs/copy-source-dialog.c (copy_source_dialog): Instead
	of saying "Select destination source", we now say "... calendar" or
	"... task list", based on object type.

2004-02-12  Chris Toshok  <toshok@ximian.com>

	* gui/migration.c (CONTACTS_BASE_URI): rename from
	CONTACT_BASE_URI, and change to contacts:// to match e-d-s.
	(create_calendar_contact_source): CONTACT -> CONTACTS.
	(create_calendar_sources): same.

2004-02-13  Bruce Tao  <bruce.tao@sun.com>
                                                                                
        See #51567
	* gui/dialogs/delete-comp.c (delete_component_dialog):
        use "gtk_dialog_add_buttons" to change the response_id of button
        "YES" and "NO".

2004-02-11  Rodrigo Moya <rodrigo@ximian.com>

	Fixes #53886

	* gui/gnome-cal.c (gnome_calendar_paste_clipboard,
	gnome_calendar_delete_selection, gnome_calendar_cut_clipboard,
	gnome_calendar_copy_clipboard): removed g_assert_if_reached calls
	since we might get a different widget getting the focus.
	(get_focus_location): check the canvas's' focused item.

2004-02-11  Rodrigo Moya <rodrigo@ximian.com>

	Fixes #53271

	* gui/calendar-component.c (delete_calendar_cb): remove the source from
	the GnomeCalendar widget also.

	* gui/tasks-component.c (delete_task_list_cb): ditto.

2004-02-11  Kidd Wang  <kidd.wang@sun.com>

	* gui/print.c: (print_date_label): guarantee we do have some timezone
	before the time convertion.

2004-02-10  JP Rosevear <jpr@ximian.com>

	* importers/icalendar-importer.c: remove useless include

	* importers/Makefile.am: remove executable build cruft

2004-02-09  Rodrigo Moya <rodrigo@ximian.com>

	* gui/gnome-cal.c (client_cal_opened_cb): don't add the clients to the
	internal hash/list here, just remove it if opening the calendar fails.
	(gnome_calendar_add_event_source): add the client to the internal
	hash/list here.

2004-02-09  Kidd Wang  <kidd.wang@sun.com>

	* gui/e-cal-model-tasks.c: (ecmt_set_value_at): refuse to update
	the task info if due date is before start date.

2004-02-05  JP Rosevear <jpr@ximian.com>

	* Convert the calendar_config_get_timezone and
	icaltimezone_get_builtin_timezone pair to just
	calendar_config_get_icaltimezone, this also guarantees we will
	have some timezone (even if its just UTC)

	Fixes #53754
	
2004-02-05  JP Rosevear <jpr@ximian.com>

	* gui/calendar-config.h: add proto

	* gui/calendar-config.c (calendar_config_get_icaltimezone): return
	the icaltimezone based on the location and default to utc if we
	can't find one
	(calendar_config_get_hide_completed_tasks_sexp): use above

2004-02-05  JP Rosevear <jpr@ximian.com>

	* gui/dialogs/cal-prefs-dialog.c (set_color_picker): make failure
	not so draconian - make the color black

	Fixes #53547
	
2004-02-05  Kidd Wang  <kidd.wang@sun.com>

	* gui/goto-dialog.glade: add a mnemonic for the 'Go to Today' button
	in the 'Go To Date' dialog.

2004-02-05  Sarfraaz Ahmed <asarfraaz@novell.com>

        Fixes #53388

        * gui/e-itip-control.c (get_next): added a check for NULL

2004-02-04  JP Rosevear <jpr@ximian.com>

	* importers/icalendar-importer.c (gnome_calendar_import_data_fn):
	use new cal auth functions

	* common/authentication.c (auth_new_cal_from_default): get a
	default calendar with auth

	* common/authentication.h: add proto

2004-02-04  JP Rosevear <jpr@ximian.com>

	* importers/icalendar-importer.c (importer_destroy_cb): we only
	have a single client to free
	(prepare_events): make the vtodo list optional
	(button_toggled_cb): handle the type of thing to import switching
	(primary_selection_changed_cb): handle the selected item switching
	(create_control_fn): create a control with types (events, tasks)
	and corresponding source selectors
	(process_item_fn): only import one type of item at a time
	(load_file_fn): load the ecal as dictated by the source and type
	(vcal_importer_new): pass in control function
	(gnome_calendar_import_data_fn): get the default calendars

	* importers/Makefile.am (importersdir): add lib

2004-02-04  Rodrigo Moya <rodrigo@ximian.com>

	Fixes #52970

	* idl/evolution-calendar.idl: added back the AlarmNotify interface.

	* gui/alarm-notify/GNOME_Evolution_Calendar_AlarmNotify.server.in.in:
	changed to have the AlarmNotify component be created via a factory.

	* gui/alarm-notify/alarm-notify.[ch]: converted to implement the
	AlarmNotify interface.

	* gui/alarm-notify/notify-main.c (main): register the factory with
	bonobo_generic_factory_new, not the object itself. Removed redundant
	call to bonobo_object_unref. Call e_passwords_shutdown on exit.

	* gui/alarm-notify/config-data.c (config_data_get_calendars_to_load):
	get only the selected calendars/task lists.

2004-02-04  Rodrigo Moya <rodrigo@ximian.com>

	* gui/gnome-cal.c (gnome_calendar_add_event_source): don't update the
	date navigator query nor the internal lists here...
	(client_cal_opened_cb): do it here.

2004-02-04  Rodrigo Moya <rodrigo@ximian.com>

	* gui/main.c (launch_alarm_daemon_cb): display the exception message
	on error.

	* gui/gnome-cal.c (open_ecal): open calendars asynchronously.
	(client_cal_opened_cb): on success, add the clients to the models here.
	(gnome_calendar_add_event_source, gnome_calendar_construct): not here.

2004-02-04  Kidd Wang  <kidd.wang@sun.com>

	* gui/dialogs/alarm-page.glade: change the access key for adding a
	reminder from Alt+a to Alt+d to avoid conflict with the menuitem.

2004-02-04 Yong Sun <Yong.Sun@sun.com>

	* gui/print.c: Fix a bug in evolution/calendar/gui/print.c:
	bound_text(). It does not break lines with the correct boundary of UTF-8
	characters. So, for non-latin locales, it will cause printing issues.

2004-02-03  Dan Winship  <danw@ximian.com>

	* gui/tasks-component.h: Fix location of e-activity-handler.h
	#include

	* gui/Makefile.am (INCLUDES): add widgets/misc for
	e-activity-handler.h and e-task-bar.h

	* gui/dialogs/Makefile.am (INCLUDES): Likewise

2004-02-02  JP Rosevear <jpr@ximian.com>

	* importers/icalendar-importer.c (support_format_fn): use
	g_file_get_contents
	(load_file_fn): ditto
	(vcal_support_format_fn): ditto
	(load_vcalendar_file): ditto

2004-01-30  JP Rosevear <jpr@ximian.com>

	* remove dead files

2004-01-29 Gary Ekker <gekker@novell.com>

	Fixes #51871

	* gui/dialogs/calendar-setup.c (calendar_setup_edit_calendar): add
	activate handler for name_entry
	(calendar_setup_edit_task_list): ditto

2004-01-30  JP Rosevear <jpr@ximian.com>

	* gui/tasks-component.c (create_new_todo): remove extraneous ;

	Fixes #53418

2004-01-29  JP Rosevear <jpr@ximian.com>

	* gui/migration.c (create_calendar_contact_source): don't set the
	group to be read only until after the source is added.

2004-01-29  JP Rosevear <jpr@ximian.com>

	* gui/migration.c (migrate_ical_folder_to_source): migrate to a
	specific source
	(migrate_ical_folder): create a new source based on the new source
	name/uid
	(create_calendar_contact_source): use the #define for the base uri
	(create_calendar_sources): try and find the right sources if they
	already exist
	(create_task_sources): ditto
	(migrate_calendars): make sure the personal source is the system
	source
	(migrate_tasks): ditto

2004-01-29  Rodrigo Moya <rodrigo@ximian.com>

	* gui/calendar-view.c (calendar_view_get_type_code): added support for
	the list view also.

2004-01-28  Rodrigo Moya <rodrigo@ximian.com>

	* gui/gnome-cal.c (update_query):
	* gui/e-cal-list-view.c (e_cal_list_view_update_query):
	* gui/e-cal-view.c (e_calendar_view_update_query): stop status bar
	messages madness.

2004-01-27  JP Rosevear <jpr@ximian.com>

	* gui/calendar-component.c (delete_calendar_cb): use e_cal_remove

	* gui/tasks-component.c (delete_task_list_cb): ditto

2004-01-27  Rodrigo Moya <rodrigo@ximian.com>

	Fixes #53276

	* gui/dialogs/copy-source-dialog.c (show_error): new function to
	create an error message dialog.
	(copy_source): check if the destination calendar is read only, and
	if so, don't try to copy components over. Fixed leaks. Call show_error
	to display meaningful error messages.

2004-01-26  JP Rosevear <jpr@ximian.com>

	* gui/migration.c (migrate_ical_folder): add the source to the
	group so it actually shows up

2004-01-26  JP Rosevear <jpr@ximian.com>

	* gui/migration.c (migrate_calendars): get the source name with
	out using freed memory
	(migrate_tasks): ditto

2004-01-26  Rodrigo Moya <rodrigo@ximian.com>

	Fixes #53338

	* gui/dialogs/calendar-setup.c (dialog_to_source): set the relative
	URI on the source for remote sources.

2004-01-26  Rodrigo Moya <rodrigo@ximian.com>

	Fixes #52312

	* gui/dialogs/calendar-setup.c (create_new_source_with_group):
	* gui/migration.c (migrate_ical_folder, create_calendar_sources,
	create_task_sources): set the relative URI for local calendars and
	task lists to be the source UID.

2004-01-24  Rodrigo Moya <rodrigo@ximian.com>

	* gui/calendar-component.[ch]
	(calendar_component_peek_source_selector): new function.

	* gui/tasks-component.[ch]
	(tasks_component_peek_source_selector): new function.

	* gui/e-tasks.c (backend_died_cb):
	* gui/gnome-cal.c (backend_died_cb): don't tell the user to restart
	Evolution, there is no need now, just unselecting and selecting
	back the calendar loads it again. Also, remove the crashed client
	from the list of loaded clients. Also, unselect the source on
	the source selector.

2004-01-24  JP Rosevear <jpr@ximian.com>

	* gui/tasks-component.c (update_primary_selection): use
	e_source_list_peek_source_any
	(setup_create_ecal): ditto
	(create_new_todo): just use the default call directly
	(update_uris_for_selection): just use e-tasks remove/add todo
	source directly

2004-01-24  JP Rosevear <jpr@ximian.com>

	* gui/e-tasks.c (e_tasks_add_todo_source): don't unref and ref,
	the hash table does this
	(e_tasks_remove_todo_source): ditto

	Fixes #53281

2004-01-24  Rodrigo Moya <rodrigo@ximian.com>

	* gui/e-calendar-table.c (e_calendar_table_init): use the colors from
	the model as background, not as foreground.

	* gui/e-cal-model-tasks.c (ecmt_get_color_for_component): return the
	color assigned to each URI if it's not overdue.

2004-01-24  JP Rosevear <jpr@ximian.com>

	* gui/tasks-component.c (delete_task_list_cb): sync the source
	list after the source removal

	* gui/calendar-component.c (delete_calendar_cb): ditto

	Fixes #53271
	
2004-01-24  JP Rosevear <jpr@ximian.com>

	* gui/migration.c (setup_progress_dialog): display a progress
	dialog
	(dialog_close): destroy it
	(dialog_set_folder_name): display the folder being migrated
	(dialog_set_progress): update the progress
	(check_for_conflict): make sure we don't name anything the same
	(get_source_name): create a source name
	(migrate_ical): migrate the events/tasks from one ecal to another
	(migrate_ical_folder): migrate a specific folder
	(migrate_calendars): use above
	(migrate_tasks): ditto

2004-01-23  Rodney Dawes  <dobey@ximian.com>

	* gui/e-itip-control.c: Use PUBLISH if no METHOD defined

	Fixes #45564

2004-01-22  Rodrigo Moya <rodrigo@ximian.com>

	* gui/e-cal-model.c (e_cal_view_objects_removed_cb): don't assert
	if we can't find the component, just continue with next item in
	the list.

2004-01-22  JP Rosevear <jpr@ximian.com>

	* gui/migration.c (process_old_dir): remove useless e_mkdir_hier
	call.

	Fixes #53065

2004-01-22  JP Rosevear <jpr@ximian.com>

	* gui/e-tasks.c (e_tasks_setup_view_menus): Remove debugging
	statement

2004-01-22  JP Rosevear <jpr@ximian.com>

	* gui/gnome-cal.c (setup_widgets): use the calendar component
	config dir
	(gnome_calendar_setup_view_menus): use the calendar component base
	dir for the view storage

	* gui/e-tasks.c (e_tasks_setup_view_menus): use the task component
	base dir for the view storage

	Fixes #53133

2004-01-21  Rodrigo Moya <rodrigo@ximian.com>

	* gui/e-tasks.c (e_tasks_add_todo_source): check return value
	from auth_new_cal_from_source(). Connect to "backend_died"
	signal on the ECal class.
	(backend_died_cb): callback for "backend_died" that displays
	an error message when that happens.

	* gui/gnome-cal.c (backend_died_cb): use a GtkMessageDialog.

2004-01-21  Rodrigo Moya <rodrigo@ximian.com>

	* gui/e-tasks.[ch] (e_tasks_add_todo_uri, e_tasks_remove_todo_uri,
	e_tasks_get_default_uri): renamed to _source and made them work
	with ESource's.

	* gui/tasks-component.c (update_uri_for_primary_selection,
	add_uri_for_source, remove_uri_for_source):
	* gui/tasks-control.c (tasks_control_set_property): updated for
	changes in e-tasks.[ch].

2004-01-21  Rodrigo Moya <rodrigo@ximian.com>

	* gui/dialogs/calendar-setup.c (create_new_source_with_group):
	added 'ECalSourceType' argument to be able to create the
	ECal correctly. Added a call to e_cal_open with 'only_if_exists'
	set to FALSE so that the backend creates the calendar.
	(new_calendar_finish, new_task_list_finish): pass new argument
	to create_new_source_with_group.

2004-01-21  Rodrigo Moya <rodrigo@ximian.com>

	* gui/tasks-component.c (delete_task_list_cb): call
	e_cal_remove_calendar to actually remove the task list via
	the backend.

2004-01-21  Rodrigo Moya <rodrigo@ximian.com>

	Fixes #51705

	* gui/calendar-component.c (delete_calendar_cb): call
	e_cal_remove_calendar to actually remove the calendar via
	the backend.

2004-01-21  JP Rosevear <jpr@ximian.com>

	* gui/dialogs/calendar-setup.c (calendar_setup_new_calendar): just
	use the convienence function for the default gconf client (fixes
	leak)
	(calendar_setup_new_task_list): ditto
	(new_task_list_finish): we don't support task uri's
	
2004-01-21  JP Rosevear <jpr@ximian.com>

	* gui/dialogs/calendar-setup.c (source_to_dialog): only block
	widgets that exist

2004-01-19  JP Rosevear <jpr@ximian.com>

	* gui/e-cal-model-tasks.c (ensure_task_not_complete): correct
	property name c/p error

	Fixes # 52269
	
2004-01-19  JP Rosevear <jpr@ximian.com>

	* gui/tasks-component.c (update_primary_selection): handle the
	case where we have a bogus uid

	* gui/calendar-component.c (update_primary_selection): ditto
	
2004-01-19  Radek Doulik  <rodo@ximian.com>

	* gui/print.c (print_day_add_event): uncomment and use
	ECalModelComponent
	(print_day_details): use e_cal_model_generate_instances
	(print_day_details_cb): use ECalModelGenerateInstancesData
	(print_day_long_event): use event color
	(print_day_event): ditto
	(print_month_small): use e_cal_model_generate_instances
	(instance_cb): use ECalModelGenerateInstancesData

2004-01-18  Radek Doulik  <rodo@ximian.com>

	* gui/print.c (print_border_with_triangles): use rgb color as
	fillcolor
	(print_week_day_event): ditto
	(print_table): set page orientation, it may be changed from last
	printing
	(print_comp): ditto

	* gui/e-cal-model.c (e_cal_model_get_rgb_color_for_component): new
	helper function, gets component color as rgb double values

	* gui/print.c (print_week_summary_cb): uncommented and updated for
	e_cal_model_generate_instances
	(print_week_summary): use e_cal_model_generate_instances
	(print_border_with_triangles): pass rgb fillcolor
	(print_border_rgb): new function to print border with rgb color
	background

	* gui/e-cal-model.c (e_cal_model_generate_instances): new
	function, similar to e_cal_generate_instances. see comments to
	understand how to use cb_data

2004-01-17  JP Rosevear <jpr@ximian.com>

	* gui/e-calendar-table.c (e_calendar_table_delete_selected): don't
	create the component if there is a multiple selection

	Fixes #52266
	
2004-01-17  JP Rosevear <jpr@ximian.com>

	* gui/e-cal-view.c (on_print): we are required to pass in the end
	in-out arg

	Fixes #52972
	
2004-01-17  JP Rosevear <jpr@ximian.com>

	* gui/print.h: update protos

	* gui/print.c (print_title): util routine to print a title
	(print_table): print out an etable

	* gui/calendar-commands.c (print): handle printing the list view

	* gui/e-cal-list-view.etspec: draw the grid to mimic tasks

	* gui/tasks-control.c (tasks_control_print_cmd): use print_table

	Fixes #51751, #52958
	
2004-01-16  JP Rosevear <jpr@ximian.com>

	* gui/calendar-commands.c (print): handle list view by printing
	the month

2004-01-16  JP Rosevear <jpr@ximian.com>

	* gui/e-itip-control.c (find_server): we actually want to not
	return on any error as well (like NOT FOUND)

2004-01-16  JP Rosevear <jpr@ximian.com>

	* gui/e-comp-editor-registry.h: convert to GObject

	* gui/e-comp-editor-registry.c (registry_data_free): routine to
	free the registry data
	(dispose): destroy the registry data
	(finalize): finalize it
	(class_init): setup above
	(init): create full hash table
	(e_comp_editor_registry_add): weak ref the editor and strdup the
	hash table key
	(editor_destroy_cb): we get the registry data now, just remove it

	* gui/dialogs/comp-editor.c (close_dialog): disconnect the signal
	handlers, its a bit of a hack but it is a simple fix

2004-01-16  Radek Doulik  <rodo@ximian.com>

	* gui/print.c (print_calendar): don't set old orientation, preview
	needs right orientation even after everything is printed

2004-01-16  Rodrigo Moya <rodrigo@ximian.com>

	Fixes #52920

	* gui/dialogs/calendar-setup.glade: match label's text with the
	button's text.

2004-01-16  Rodrigo Moya <rodrigo@ximian.com>

	* gui/tasks-component.c (impl_dispose): unref the activity
	handler.

2004-01-16  Rodrigo Moya <rodrigo@ximian.com>

	* gui/tasks-component.[ch]
	(tasks_component_peek_activity_handler): new function.
	(impl_createControls): create a task bar also for the tasks
	component. We can't rely on the calendar component's one.
	(tasks_component_init): create the private activity handler.

	* gui/e-calendar-table.c (e_calendar_table_set_status_message):
	use the tasks component's activity handler.

	* gui/e-tasks.c (on_url_cb): new callback to display status
	bar messages when mousing over links.
	(setup_widgets): connect to "on_url" signal on the HTML widget.

2004-01-15  Rodrigo Moya <rodrigo@ximian.com>

	* gui/dialogs/comp-editor.c: reverted my changes made on Jan 8th.

2004-01-15  Rodrigo Moya <rodrigo@ximian.com>

	* gui/alarm-notify/save.[ch]: removed.

	* gui/alarm-notify/Makefile.am: removed save.[ch].

	* gui/alarm-notify/notify-main.c: removed obsolete headers.

	* gui/alarm-notify/config-data.[ch]
	(config_data_set_last_notification_time,
	config_data_get_last_notification_time,
	config_data_save_blessed_program, config_data_is_blessed_program):
	new functions.

	* gui/alarm-notify/alarm-queue.c: dont use removed functions.
	(alarm_trigger_cb, procedure_notification_dialog,
	alarm_queue_init):
	use config_data_* functions.
	
	* gui/alarm-notify/alarm-notify.c: dont use removed functions.

2004-01-15  JP Rosevear <jpr@ximian.com>

	* gui/tasks-component.h: update protos
	
	* gui/tasks-component.c (impl_finalize): free base dir
	(impl_upgradeFromVersion): just call migrate_tasks
	(tasks_component_init): set base dir value
	(tasks_component_peek_base_directory): accessor
	(tasks_component_peek_source_list): ditto

	* gui/migration.c (process_old_dir): look for a source with the
	name and fallback to creating it
	(create_calendar_contact_source): create the contacts:// source
	(create_calendar_sources): use above and create all the necessary
	sources
	(create_task_sources): create all the necessary sources
	(migrate_calendars): do all the migration logic here, upgrade
	bonobo-conf to gconf
	(migrate_tasks): ditto

	* gui/calendar-component.h: update prototypes

	* gui/calendar-component.c (impl_finalize): free the base
	directory
	(impl_upgradeFromVersion): just call migrate_calendars
	(calendar_component_init): fill in base dir value
	(calendar_component_peek_base_directory): accessor
	(calendar_component_peek_source_list): ditto

2004-01-15  Radek Doulik  <rodo@ximian.com>

	* gui/calendar-component.c (create_new_event): test priv->calendar
	is not NULL before getting current view

	* gui/tasks-component.c (primary_source_selection_changed_cb):
	reset create_ecal

	* gui/calendar-component.c (impl_requestCreateItem): merge with
	JP's changes
	(primary_source_selection_changed_cb): reset create_ecal

2004-01-14  Radek Doulik  <rodo@ximian.com>

	* gui/e-cal-list-view.c (e_cal_list_view_get_selected_time_range):
	new implementation, use time range from selected event

	* gui/e-cal-view.c (e_calendar_view_get_selected_time_range):
	return gboolean, TRUE if requested time was set, FALSE otherwise
	(e_calendar_view_new_appointment_full): use current time if time
	range is unavailable

	* gui/calendar-component.c (impl_requestCreateItem): use
	e_calendar_view_new_appointment_full instead of
	cal_comp_event_new_with_current_time

	* gui/e-cal-view.c (e_calendar_view_new_appointment_full): new
	helper function

	* gui/comp-editor-factory.c (edit_new): use
	cal_comp_event_new_with_current_time

	* gui/calendar-component.c (impl_requestCreateItem): use
	cal_comp_event_new_with_current_time

	* gui/comp-util.c (cal_comp_event_new_with_current_time): new
	function, cut'n'pasted from get_default_event
	(calendar-component.c and comp-editor-factory.c)

2004-01-14  JP Rosevear <jpr@ximian.com>

	* gui/tasks-component.c (impl_requestCreateItem): new utility
	routine to create new tasks
	(create_new_todo): use above so we don't try to set up the
	creation ecal unless we are actually creating a new item

	* gui/calendar-component.c (create_new_event): new utility routine
	to create new events
	(impl_requestCreateItem): use above so we don't try to set up the
	creation ecal unless we are actually creating a new item

2004-01-14  Rodrigo Moya <rodrigo@ximian.com>

	* gui/e-calendar-table.c (e_calendar_table_show_popup_menu):
	use get_selected_objects() instead of get_selected_comp().

2004-01-14  Rodrigo Moya <rodrigo@ximian.com>

	* gui/e-cal-model-tasks.c (get_status): removed assertion.

2004-01-14  Rodrigo Moya <rodrigo@ximian.com>

	* common/authentication.c (auth_new_cal_from_source): check
	return value from e_cal_new().

	* gui/gnome-cal.c (gnome_calendar_construct): if there is no
	default tasks folder, don't create the ECal from it.

2004-01-14  JP Rosevear <jpr@ximian.com>

	* gui/tasks-component.c (impl_requestCreateItem): don't try to set
	up the creation ecal unless we are actually creating a new item

2004-01-13  Rodney Dawes  <dobey@ximian.com>

	* gui/Makefile.am: Only link in libsoup where we need it

2004-01-13  Rodrigo Moya <rodrigo@ximian.com>

	* gui/calendar-component.c (impl_upgradeFromVersion): free 'base_uri'
	at the end of the function, or it will leak, and removed duplicated
	code to create the birthdays backend.

2004-01-12 Gary Ekker <gekker@novell.com>
 
 	* gui/Makefile.am: add e-pub-utils.[ch]
 	for Free/Busy publishing
 	
 	* gui/apps_evolution_calendar.schemas.in.in: add schema for
 	/apps/evo/calendar/free_busy key
 	
 	* gui/calendar-commands.c (publish_freebusy_cmd): change to
 	publish component rather than attach as email
 	
 	* gui/calendar-config-keys.h: add free_busy/urls key definition
 	
 	* gui/calendar-config.[ch] (calendar_config_get_free_busy): new
   	method for retrieving FB gconf key
 	(calendar_config_set_free_busy): new method for saving FB
 	gconf key
 	
 	* gui/e-cal-view.c (on_publish): change to publish component
 	rather than attach as email
 	
 	* gui/itip-utils.[ch] (itip_publish_begin): new method to process 
 	e_cal_components and aggregate the data if we are publishing
 	for multiple calendars
 	(itip_publish_comp): new method to publish the ical data to an
 	http server via libsoup
 	(comp_fb_normalize): new static method to ensure rfc 2446 compliant 
 	data before publishing icalcomponent_get_uid
 	(fb_sort): new static method to sort FB properties in ascending order
 	
 	* gui/dialogs/Makefile.am: add url-editor-dialog.[ch] and 
 	url-editor-dialog.glade for configure FB publishing
 	
 	* gui/dialogs/cal-prefs-dialog.[ch] (cal_prefs_dialog_url_add_clicked):
 	(cal_prefs_dialog_url_edit_clicked):new method for events in FB tab 
 	of cal-prefs-dialog
 	(cal_prefs_dialog_url_remove_clicked): ditto
 	(cal_prefs_dialog_url_enable_clicked): ditto
 	(cal_prefs_dialog_url_url_list_change): ditto
 	(cal_prefs_dialog_url_url_list_enable_toggled): ditto
 	(cal_prefs_dialog_url_url_list_double_click): ditto
 	(show_fb_config): new method for updating dialog with FB specific
 	data in gconf
 	(update_fb_config): new method for updating gconf with FB specific
 	data from dialogs
 	(setup_changes): detect changes in url_list gtk_tree_view
 	(get_widgets): include new dialog widgets for FB config
 	(init_widgets): connect signals for new FB config widgets
 	
 	* gui/dialogs/cal-prefs-dialog.glade: add new widgets for FB config
 	
 	* gui/dialogs/url-editor-dialog.[ch]: add files for FB url-editor dialog
 	
 	* gui/dialogs/url-editor-dialog.glade: ditto
 	
 	* gui/e-pub-utils.[ch]: add files with FB publishing utilities
 
 	* gui/calendar-component.c (init_calendar_publishing): sets up
 	listeners to publish calendar, g_idle_add, and on gconf change
 	(init_calendar_publishing_cb): ditto
 	(conf_changed_callback): ditto
 	(impl_createControls): ditto

2004-01-12  Rodrigo Moya <rodrigo@ximian.com>

	* gui/calendar-component.c (impl_upgradeFromVersion): sync the source
	list after creating the remote source group.

2004-01-12  JP Rosevear <jpr@ximian.com>

	* Revert William McCann's patch of 2003-12-19 until we can get
	consistent across all of evolution

2004-01-12  Hans Petter Jansson  <hpj@ximian.com>

	* gui/dialogs/calendar-setup.c (source_to_dialog): Only update dialog
	widgets if they exist.

2004-01-11  JP Rosevear <jpr@ximian.com>

	* gui/tasks-component.c: Fix copyright notice, its copyright
	Novell not our hackers

	* gui/tasks-component.h: ditto
	
	* gui/calendar-component.c: ditto

	* gui/calendar-component.h: ditto

2004-01-10  Rodrigo Moya <rodrigo@ximian.com>

	* gui/gnome-cal.c (open_ecal): cast the views to E_CALENDAR_VIEW,
	not to E_CAL_VIEW.

2004-01-10  Rodrigo Moya <rodrigo@ximian.com>

	* gui/alarm-notify/notify-main.c: added missing headers.

	* gui/alarm-notify/alarm-notify.c (alarm_notify_remove_calendar):
	use the correct variable when calling alarm_queue_remove_client().

	* gui/calendar-component.c (impl_upgradeFromVersion): removed redundant
	variable declarations.

	* gui/migration.c (process_old_dir):
	* gui/e-timezone-entry.c (e_timezone_entry_mnemonic_activate):
	* gui/e-date-time-list.c (e_date_time_list_finalize):
	* gui/e-alarm-list.c (e_alarm_list_finalize): fixed warnings.

	* gui/e-calendar-table.c: added missing prototypes at the top to
	avoid warnings.

	* gui/e-week-view.c (e_week_view_scroll_a_step):
	* gui/e-day-view.c (e_day_view_event_move): directly return in the
	default: case.

	* gui/e-tasks.c (setup_widgets): connect to changes on the model.
	(model_row_changed_cb): callback to update the HTML detailed view
	when the currently selected task changes.
	(client_obj_updated_cb): removed unused function.
	(set_status_message): changed to accept a variable list of arguments.
	(e_tasks_add_todo_uri): display status messages and get error message
	from backend and display it in a dialog.
	(cal_opened_cb, load_error, method_error, permission_error): removed
	unused functions.

	* gui/gnome-cal.c (open_ecal): added a GnomeCalendar argument, and
	display status messages.
	(gnome_calendar_construct, gnome_calendar_add_event_source):
	adapted to changes in open_ecal().

2004-01-10  Rodrigo Moya <rodrigo@ximian.com>

	* gui/alarm-notify/alarm-queue.c (display_notification): keep
	all the tray icons we create in a list.
	(tray_icon_destroyed_cb): remove the tray icon data from the list.
	(popup_dismiss_cb, popup_dismiss_all_cb): implemented missing
	popup menu items.

2004-01-09  Hans Petter Jansson  <hpj@ximian.com>

	* gui/calendar-component.c (new_calendar_cb): calendar_config ->
	calendar_setup.
	(edit_calendar_cb): Ditto.
	(impl_requestCreateItem): Ditto.

	* gui/tasks-component.c (new_task_list_cb): Use calendar_setup.
	(edit_task_list_cb): Implement properties callback.
	(rename_task_list_cb): Remove.
	(fill_popup_menu_cb): Remove "rename" and add "properties".
	(impl_requestCreateItem): Use calendar_setup.

	* gui/dialogs/Makefile.am (libcal_dialogs_la_SOURCES): calendar_config
	-> calendar_setup. Remove new-task-list.[ch].
	(glade_DATA): calendar_config -> calendar_setup. Remove
	new-task-list.glade.

	* gui/dialogs/new-task-list.[ch]: Remove.

	* gui/dialogs/calendar-config.[ch]: Rename to calendar-setup.[ch].

	* gui/dialogs/calendar-config.glade: Rename to calendar-setup.glade.

2004-01-09  JP Rosevear <jpr@ximian.com>

	* gui/calendar-component.c (impl_upgradeFromVersion): make sure we
	sync the source list when appropriate

	* gui/tasks-component.c (impl_upgradeFromVersion): ditto
	
2004-01-09  ERDI Gergo  <cactus@cactus.rulez.org>

	* gui/calendar-component.c (impl_upgradeFromVersion): Create
	ESource for anniversaries

2004-01-09  Hans Petter Jansson  <hpj@ximian.com>

	* gui/calendar-component.c (new_calendar_cb): Call
	calendar_config_new_calendar().
	(rename_calendar_cb): Remove.
	(edit_calendar_cb): Implement properties callback.
	(fill_popup_menu_cb): Add "Properties..." item and remove "Rename".

	* gui/dialogs/Makefile.am (libcal_dialogs_la_SOURCES): Add
	calendar-config.[ch] and remove new-calendar.[ch].
	(glade_DATA): Add calendar-config.glade and remove new-calendar.glade.

	* gui/dialogs/calendar-config.[ch]: Implement calendar creation and
	editing.

	* gui/dialogs/calendar-config.glade: Add GUI for above.

2004-01-09  JP Rosevear <jpr@ximian.com>

	* gui/tasks-component.c (impl_upgradeFromVersion): return the
	corba values

	* gui/calendar-component.c (impl_upgradeFromVersion): ditto

2004-01-09  Rodrigo Moya <rodrigo@ximian.com>

	* gui/calendar-component.c (impl_upgradeFromVersion): only migrate
	old calendars if migrating from <= 1.4.x.

	* gui/tasks-component.c (impl_upgradeFromVersion): ditto for tasks.

2004-01-09  Andrew Wu <Yang.Wu@sun.com>

	* gui/e-cal-view.c (e_calendar_view_class_init):
	add a new signal "event_move" and its key binding.

	* gui/e-cal-view.h:
	add a new type "ECalViewMoveDirection".
	add a new virtual method "event_move" for ECalView.

	* gui/e-day-view.c
	(e_day_view_event_move), (e_day_view_change_event_time):
	Use "Alt + Arrow" to move a selected event through time lines
	or different days.

	* gui/e-day-view.h:
	add a new property "last_edited_comp_string" for EWeekView.

	* gui/e-week-view.c (e_week_view_class_init), (e_week_view_init),
	(e_week_view_reshape_events), (e_week_view_event_move),
	(e_week_view_get_day_offset_of_event), (e_week_view_scroll_a_step),
	(e_week_view_change_event_time), (e_week_view_do_key_press),
	(e_week_view_move_selection_day),
	(e_week_view_get_adjust_days_for_move_up),
	(e_week_view_get_adjust_days_for_move_down),
	(e_week_view_get_adjust_days_for_move_left),
	(e_week_view_get_adjust_days_for_move_right):
	Use "Alt + Arrow" to move a selected event through different days.

	* gui/e-week-view.h:
	add a new property "last_edited_comp_string" for EWeekView.

2004-01-08  Rodrigo Moya <rodrigo@ximian.com>

	* gui/alarm-notify/alarm-queue.c (display_notification): store
	the ECal's associated ECalView, and connect to its "objects_removed"
	signal.
	(notifiy_dialog_cb): disconnect signals from the ECalView, not the
	ECal.
	(on_dialog_objs_removed_cb): adapted to respond to "objects_removed"
	signal on ECalView. Made it destroy the tray bar icon also.
	(add_popup_menu_item): new function to create the popup items.
	(tray_icon_clicked_cb): remove connection to obsolete signal, and
	made it popup a menu on right-click.
	(popup_open_cb, popup_dismiss_cb, popup_dismiss_all_cb): callbacks
	for popup menu.

	* gui/gnome-cal.c (connect_week_view_focus): don't access the
	widget's private fields if NULL.

2004-01-08  Rodrigo Moya <rodrigo@ximian.com>

	* gui/dialogs/comp-editor.c (save_comp): moved the line that sets
	priv->updating to FALSE up some lines, to avoid getting callbacks
	with an incorrect value on it.
	(obj_modified_cb): check the UIDs of the objects we get passed to
	see if the one being edited is amongst them.

2004-01-08  Kidd Wang  <kidd.wang@sun.com>

	* gui/e-cal-view.h: delete the ECalViewMoveDirection type declaration
        which was added by mistake yesterday.

        * ChangeLog: add a missed entry for calender-commands.c.

2004-01-07  Rodrigo Moya <rodrigo@ximian.com>

	* gui/alarm-notify/alarm-queue.c (load_alarms): call e_cal_view_start
	to actually start the live query.
	(add_component_alarms): check the 'alarms' parameter before using it.

2004-01-07  Rodrigo Moya <rodrigo@ximian.com>

	* gui/alarm-notify/alarm-queue.c: added an ECalQuery for each loaded
	client.
	(load_alarms): use a live query to the calendar instead of calling
	e_cal_get_alarms_in_range().
	(alarm_queue_add_client): set query initially to NULL.
	(query_objects_changed_cb): renamed and made it manage both
	"objects_added" and "objects_modified" signals of ECalView.
	(query_objects_removed_cb): manage the "objects_removed" signal of
	ECalView.
	(alarm_queue_remove_client): unref the live query.

2004-01-06  JP Rosevear  <jpr@ximian.com>

	* gui/gnome-cal.c (gnome_calendar_add_event_source): remove the
	item from the hash last and don't free its members because the
	hash table does that for us

2004-01-06  Rodrigo Moya <rodrigo@ximian.com>

	* gui/calendar-component.c (impl_upgradeFromVersion): new
	method's implementation.
	(calendar_component_class_init): initialize new epv's member.
	(calendar_component_init): moved migration code to
	impl_upgradeFromVersion.
	(update_uri_for_primary_selection): fixed warning.

	* gui/tasks-component.c (impl_upgradeFromVersion): new
	method's implementation.
	(tasks_component_class_init): initialize new epv's member.
	(tasks_component_init): moved migration code to
	impl_upgradeFromVersion.

2004-01-06  JP Rosevear <jpr@ximian.com>

	* gui/e-select-names-renderer.c (esnr_editing_done): disconnect
	the activated signal

2004-01-06  JP Rosevear <jpr@ximian.com>

	* gui/dialogs/comp-editor.c (comp_editor_finalize): we don't put
	any signal handlers on the client or source client now, but we do
	on the view
	(real_set_e_cal): no signal handlers on the client
	(obj_modified_cb): we are guaranteed this is a signal for our
	component
	(obj_removed_cb): ditto
	(listen_for_changes): listen for changes on the object
	(save_comp): use above since the source_client changed
	(real_edit_comp): use above since the comp changed

2004-01-06  JP Rosevear <jpr@ximian.com>

	* gui/e-select-names-renderer.c (esnr_activated): if we are
	de-activated, the editing is done
	(esnr_start_editing): listen for activated signal on the control
	frame

	Fixes #52196
	
2004-01-06  Kidd Wang  <kidd.wang@sun.com>

	* gui/e-calendar-table.[ch] (e_calendar_table_open_selected):
	open a dialog for the selected task.
	* gui/e-tasks.[ch] (e_tasks_open_task): ditto.
	* gui/tasks-control.c (tasks_control_sensitize_commands),
	(tasks_control_open_task_cmd): add a menu item for "Open Task".
	* gui/calender-commands.c: the event should also be allowed to open
	even when it's readonly. 

2004-01-05  Rodrigo Moya <rodrigo@ximian.com>

	* gui/gnome-cal.c (open_ecal): new function to open ECal's, get any
	error information and display it to the user, all-in-one.
	(gnome_calendar_construct, gnome_calendar_add_event_source): use the
	above function, instead of e_cal_open().
	(open_error, method_error, permission_error): removed unneeded
	functions, we just display the error message returned from the
	backend.

2004-01-05  Rodrigo Moya <rodrigo@ximian.com>

	* gui/gnome-cal.c (gnome_calendar_construct): no need to connect to
	the "cal_opened" signal on the task client. Also, added code to
	add the client to the ECalendarTable's model.
	(client_cal_opened_cb, update_e_cal_view_timeout): removed unneeded
	function.

2004-01-05  Rodrigo Moya <rodrigo@ximian.com>

	* gui/gnome-cal.c (gnome_calendar_construct): display the tasks'
	primary selection in the task list, and actually open the tasks
	folder.

	* gui/e-tasks.c (e_tasks_set_default_uri): use the ECalModel to
	get the client for a given URI.

2004-01-04  Rodrigo Moya <rodrigo@ximian.com>

	* gui/calendar-component.c (add_uri_for_source,
	remove_uri_for_source): removed redundant functions.
	(update_uris_for_selection): dont call above functions, use
	gnome_calendar_* directly.

2003-12-29  Kidd Wang  <kidd.wang@sun.com>

	* gui/calendar-commands.c (file_open_event_cb): add a menu item
	for "open appointment".

	* gui/e-cal-view.[ch] (e_calendar_view_open_event): add a signal
	"open_event" and bind it to "ctrl+o". When the signal is delivered,
	a dialog will be opened to edit the selected event.

	* gui/e-calendar-table.c (e_calendar_table_on_key_press): press "ctrl-o"
	to open a dialog.

2003-12-24  JP Rosevear <jpr@ximian.com>

	* gui/e-select-names-renderer.c (esnr_start_editing): fix the
	signal name

	* gui/dialogs/meeting-page.glade: add Add Attendee button

	* gui/dialogs/meeting-page.c (get_widgets): extract add button
	(add_clicked_cb): edit the attendee after we add it
	(init_widgets): listen for add clicked
	(meeting_page_construct): the add button is in the glade file now

	* gui/e-select-names-editable.c (esne_start_editing): activate the
	control
	(e_select_names_editable_get_address): handle null dest
	(e_select_names_editable_get_name): ditto

	* gui/e-meeting-store.h: add proto

	* gui/e-meeting-store.c (e_meeting_store_find_attendee_path):
	create the path to a given attendee

	* gui/e-meeting-list-view.h: add proto

	* gui/e-meeting-list-view.c (e_meeting_list_view_edit): start
	editing the address of a particular

2003-12-22  Rodrigo Moya <rodrigo@ximian.com>

	* gui/gnome-cal.[ch] (gnome_calendar_add_event_source,
	gnome_calendar_remove_event_source): renamed from *_uri, to work with
	ESource's rather than with plain URIs.
	(gnome_calendar_set_default_source): ditto.

	* gui/control-factory.c (set_prop):
	* gui/calendar-component.c (add_uri_for_source, remove_uri_for_source,
	update_uri_for_primary_selection):
	use sources instead of uris with the GnomeCalendar widget.

2003-12-22  Rodrigo Moya <rodrigo@ximian.com>

	* gui/alarm-notify/save.c (get_saved_notification_time): if the setting
	is not in the config database, use the current time, to avoid getting
	hundreds of alarms for past events.

2003-12-22  Rodrigo Moya <rodrigo@ximian.com>

	* common/authentication.[ch]: new files for managing interactive
	authentication with backends.

	* common/Makefile.am: build new private library.

	* gui/alarm-notify/alarm-notify.c (alarm_notify_add_calendar):
	* gui/dialogs/event-page.c (source_changed_cb):
	* gui/dialogs/task-page.c (source_changed_cb):
	* gui/dialogs/copy-source-dialog.c (copy_source):
	* gui/calendar-component.c (setup_create_ecal):
	* gui/calendar-offline-handler.c (backend_go_offline,
	backend_go_online, calendar_offline_handler_init):
	* gui/comp-editor-factory.c (open_client):
	* gui/e-itip-control.c (start_calendar_server):
	* gui/e-tasks.c (e_tasks_add_todo_uri):
	* gui/gnome-cal.c (gnome_calendar_construct,
	gnome_calendar_add_event_uri):
	* gui/tasks-component.c (setup_create_ecal):
	* importers/icalendar-importer.c (load_file_fn, vcal_load_file_fn,
	gnome_calendar_import_data_fn): create the ECal's via the
	auth_new_cal_from* functions in the authentication module.

	* gui/alarm-notify/Makefile.am:
	* gui/Makefile.am:
	* importers/Makefile.am: link new private library.
	
	* Makefile.am: added new directory to the build.

2003-12-21  JP Rosevear <jpr@ximian.com>

	* gui/e-itip-control.[hc]: rewrite for new ecal api, cache all
	ecal's by type and minimize loading.  Switch to using the source
	option menu

	* conduits/todo/todo-conduit.c (start_calendar_server): ditto

	* conduits/calendar/calendar-conduit.c (start_calendar_server):
	use ECalSourceType
	
	* importers/icalendar-importer.c (load_file_fn): ditto
	(vcal_load_file_fn): ditto
	(gnome_calendar_import_data_fn): ditto

	* gui/dialogs/task-page.c (source_changed_cb): ditto

	* gui/dialogs/event-page.c (source_changed_cb): ditto

	* gui/dialogs/copy-source-dialog.h: update proto

	* gui/dialogs/copy-source-dialog.c (copy_source_dialog): ditto

	* gui/alarm-notify/alarm-notify.c (alarm_notify_add_calendar): ditto

	* gui/tasks-component.c (copy_task_list_cb): ditto
	(setup_create_ecal): ditto

	* gui/gnome-cal.c (gnome_calendar_construct): ditto
	(gnome_calendar_add_event_uri): ditto

	* gui/e-tasks.c (e_tasks_add_todo_uri): ditto

	* gui/comp-editor-factory.c (open_client): ditto

	* gui/calendar-offline-handler.c (backend_go_offline): ditto
	(backend_go_online): ditto
	(calendar_offline_handler_init): ditto

	* gui/calendar-component.c (copy_calendar_cb): ditto
	(setup_create_ecal): ditto

	* gui/print.c (print_month_small): don't pass type to
	e_cal_generate_instances	
	(print_day_details): ditto
	(print_week_summary): ditto

	* gui/tag-calendar.c (tag_calendar_by_client): ditto
	
2003-12-19  JP Rosevear <jpr@ximian.com>

	* gui/tasks-control.c (tasks_control_sensitize_commands): make
	sure there is a ui container

	* gui/calendar-commands.c (calendar_control_sensitize_calendar_commands): ditto
	
	* gui/tasks-component.c (impl_createControls): update after the
	signals are connected so that the ecal's are actually loaded

	* gui/calendar-component.c: ditto
	
2003-12-19  William Jon McCann  <mccann@jhu.edu>

	* gui/dialogs/task-page.c (source_changed_cb): 
	* gui/dialogs/send-comp.c (send_component_dialog): 
	* gui/dialogs/save-comp.c (save_component_dialog): 
	* gui/dialogs/recur-comp.c (recur_component_dialog): 
	* gui/dialogs/event-page.c (source_changed_cb): 
	* gui/dialogs/delete-error.c (delete_error_dialog): 
	* gui/dialogs/delete-comp.c (delete_component_dialog): 
	* gui/dialogs/changed-comp.c (changed_component_dialog): 
	* gui/dialogs/cancel-comp.c (cancel_component_dialog): 
	* gui/dialogs/alarm-options.glade:
	* gui/dialogs/alarm-page.glade:
	* gui/dialogs/cal-prefs-dialog.glade:
	* gui/dialogs/e-delegate-dialog.glade:
	* gui/dialogs/event-page.glade:
	* gui/dialogs/new-calendar.glade:
	* gui/dialogs/new-task-list.glade:
	* gui/dialogs/recurrence-page.glade:
	* gui/dialogs/task-details-page.glade:
	* gui/dialogs/task-page.glade:
	* gui/tasks-control.c (confirm_purge): 
	* gui/tasks-component.c (delete_task_list_cb) 
	(rename_task_list_cb, setup_create_ecal): 
	* gui/goto-dialog.glade: 
	* gui/e-cal-model-tasks.c (show_geo_warning): 
	* gui/comp-editor-factory.c (cal_opened_cb): 
	* gui/calendar-component.c (delete_calendar_cb) 
	(rename_calendar_cb, setup_create_ecal, delete_calendar_cb): 
	* gui/calendar-commands.c (purge_cmd):
	Remove separators from dialogs.  Use frame style recommended
	by the HIG.

2003-12-18  Rodrigo Moya <rodrigo@ximian.com>

	* gui/tasks-component.c (impl_createControls):
	* gui/calendar-component.c (impl_createControls): make sure we
	connect to the "changed" signals after setting the initial selections
	on the ESourceSelector. Fixes some nasty warnings because of
	calendar_control_sensitize_calendar_commands being called with
	no container yet for the control.

2003-12-17  Hans Petter Jansson  <hpj@ximian.com>

	* gui/dialogs/comp-editor.c: Add the concept of a source client, where
	the object lives currently. The plain client is where it will be
	stored.
	(comp_editor_finalize): If we have a source client, disconnect from
	and unref it.
	(save_comp): Check if the object is being moved, and if so, remove it
	from the source client, and make the target client the new source.
	(comp_editor_append_page): Connect to client_changed signal.
	(real_set_e_cal): Change an old gtk_signal_disconnect_by_data() to
	the GLib equivalent, and don't cast ECal to GtkObject. If the source
	client is not set, make it equivalent to the target client.
	(page_client_changed_cb): Implement. Handles a client change.

	* gui/dialogs/comp-editor-page.c (comp_editor_page_class_init): Add
	a new signal, "client_changed", that notifies that the ECal client
	was changed from one of the editor pages.
	(comp_editor_page_set_e_cal): Fix two bugs in this function; if the
	same client is set twice, its ref count could drop to 0. Additionally,
	it was unreffing the new client instead of the old one.
	(comp_editor_page_notify_client_changed): Implement.

	* gui/dialogs/event-page.c (event_page_fill_widgets): Fill in the
	source menu.
	(get_widgets): Get the source menu.
	(source_changed_cb): Implement. Try to open a client for the new
	source, and if successful, notify of the change. Show a dialog on
	failure, and revert to last selected source.
	(init_widgets): Connect to source menu.
	(event_page_create_source_option_menu): Implement Glade helper.

	* gui/dialogs/task-page.c (task_page_fill_widgets): Fill in the source
	menu.
	(get_widgets): Get the source menu.
	(source_changed_cb): Implement, similar to the event page, but for
	tasks.
	(init_widgets): Connect to source menu.
	(task_page_construct): Fix a message booboo.
	(task_page_create_source_option_menu): Implement Glade helper.

	* gui/dialogs/event-page.glade: Add source menu widget.

	* gui/dialogs/task-page.glade: Add source menu widget.

2003-12-17  Rodrigo Moya <rodrigo@ximian.com>

	* gui/tasks-component.c (add_popup_menu_item):
	* gui/calendar-component.c (add_popup_menu_item): use g_file_test
	to check if the 'pixmap' argument is a file. If so, get the pixmap
	from it, or gtk_image_new_from_stock will return an empty pixmap.

2003-12-17  Rodrigo Moya <rodrigo@ximian.com>

	* gui/gnome-cal.c (client_cal_opened_cb): set a correct status
	message.

	* gui/tasks-component.c (fill_popup_menu_cb):
	* gui/calendar-component.c (fill_popup_menu_cb): use the folder*.png
	icons for folder operations.

	* gui/Makefile.am: removed cal-client directory from $INCLUDES.

2003-12-17  Harry Lu  <harry.lu@sun.com>
 
 	Fixes #51665.
 
 	* gui/e-week-view.c: (e_week_view_focus): call 
 	e_week_view_check_layout() so that the spans won't be NULL.

2003-12-17  Rodrigo Moya <rodrigo@ximian.com>

	* gui/calendar-commands.c: removed the 'NewCalendar' verb.
	(file_new_calendar_cb): removed callback for 'NewCalendar' verb.

	* gui/calendar-component.c: (impl__get_userCreatableItems): added
	'New Calendar' to the list of user creatable items.
	(impl_requestCreateItem): implemented 'New Calendar'.

	* gui/tasks-component.c (impl__get_userCreatableItems): added
	'New Task List' to the list of user creatable items.
	(impl_requestCreateItem): implemented 'New Task List'.

2003-12-17  Rodrigo Moya <rodrigo@ximian.com>

	* gui/tasks-control.[ch] (tasks_control_sensitize_commands): made
	it public.

	* gui/tasks-component.c (update_uri_for_primary_selection): call
	tasks_control_sensitize_commands() when the primary selection
	changes.

2003-12-17  Rodrigo Moya <rodrigo@ximian.com>

	* gui/calendar-component.c (update_uri_for_primary_selection): call
	calendar_control_sensitize_calendar_commands when the primary selection
	changes.
	(impl_createControls): keep the view_control in the private structure and
	use control_factory_new_control() to create the control.
	(control_activate_cb): removed unneeded function.

	* gui/tasks-component.c (impl_createControls): use tasks_control_new to
	create the tasks view control.
	(control_activate_cb): removed unneeded function.

	* gui/gnome-cal.c (gnome_calendar_add_event_uri): check the return
	value from e_cal_new_from_uri.

2003-12-17  Rodrigo Moya <rodrigo@ximian.com>

	* gui/alarm-notify/alarm-notify.c (alarm_notify_remove_calendar):
	make sure we free the data stored in the hash table.
	(alarm_notify_add_calendar): call alarm_queue_add_client, or we wont
	have alarms at all.

	* gui/alarm-notify/alarm-queue.c: no need to hold a ref count.
	(alarm_queue_add_client, alarm_queue_remove_client): don't use the
	refcount private member.
	(alarm_queue_add_client): don't connect to non-existing ECal signals.
	(display_notification, free_client_alarms_cb): fixed warnings.

2003-12-16  Rodrigo Moya <rodrigo@ximian.com>

	Fixes part of #41237
	
	* gui/e-calendar-table.c: use GtkClipboard instead of GtkInvisible
	for cut/copy/paste.
	(selection_clear_event, selection_received, selection_get): removed
	unneeded functions.
	(e_calendar_table_init): don't create the invisible widget.
	(e_calendar_table_copy_clipboard): use gtk_clipboard_set_text().
	(e_calendar_table_paste_clipboard): use gtk_clipboard_request_text().
	(clipboard_get_text_cb): callback for gtk_clipboard_request_text().

	* gui/e-cal-view.c (e_calendar_view_init, e_calendar_view_destroy,
	e_calendar_view_copy_clipboard): no need anymore to keep the last
	clipboard selection, GtkClipboard does it for us.

2003-12-16  Rodrigo Moya <rodrigo@ximian.com>

	* gui/alarm-notify/notify-main.c (alarm_notify_factory_fn): return
	a reference to the alarm_notify_service, not NULL and ref the object
	before returning it.

2003-12-15  JP Rosevear <jpr@ximian.com>

	* gui/gnome-cal.c (setup_widgets): set the list view config
	properly (so we don't blow away the month view config

2003-12-15  JP Rosevear <jpr@ximian.com>

	* gui/gnome-cal.c (setup_widgets): set the calendar for the day
	view

2003-12-14  JP Rosevear <jpr@ximian.com>

	* gui/calendar-component.c (impl_requestCreateItem): set a proper
	exception if we fail

2003-12-14  JP Rosevear <jpr@ximian.com>
	
	* gui/calendar-config.c
	(calendar_config_get_hide_completed_tasks_units): make sure the
	string is non-null before strcmp'ing it

	Fixes #52033
	
2003-12-10  Rodrigo Moya <rodrigo@ximian.com>

	* gui/gnome-cal.c (gnome_calendar_add_event_uri): remove the client
	from the list if there are errors, instead of re-adding it again.
	Also, unref the ECal object on errors, for not leaking.

2003-12-10  Bolian Yin <bolian.yin@sun.com>

	*gui/e-week-view.c: Fix a event/jump button tabbing bug

2003-12-10  Harry Lu  <harry.lu@sun.com>

        Fix for bugzilla bug #51628.

        * gui/weekday-picker.c: (weekday_picker_class_init): setup focus
        handler.
        (day_clicked): new function to set day_mask when mouse clicked
        or keyboard input of space/enter.
        (handle_key_press_event): new function to handle key press event.
        (day_event_cb): handle key press event too.
        (weekday_picker_init): set widget can be focused.
        (colorize_items): change the box's outline if it is focused.
        (weekday_picker_focus): new function to handler focus event.

2003-12-09  Andrew Wu <Yang.Wu@sun.com>

	* gui/e-week-view-main-item.c (e_week_view_main_item_class_init): init a11y.
	* gui/e-week-view.c: emit signal "selected_time_changed".

2003-12-08  Bolian Yin <bolian.yin@sun.com>

	* gui/e-day-view.c (e_day_view_on_editing_started): remove setting property of "handle_popup".
	* gui/e-week-view.c (e_week_view_on_editing_started): remove setting property of "handle_popup".

2003-12-08 Carl Sun <carl.sun@sun.com>

        Fixes #46351

	* gui/e-timezone-entry.c  (e_timezone_entry_mnemonic_activate):
	new function. override the  member function of GtkWidget to handle
	nemonic_activate signal of custom class ETimezoneEntry.


2003-12-08  Bolian Yin <bolian.yin@sun.com>

	* gui/gnome-cal.c (gnome_calendar_class_init): correct argument mismatch in "goto_date" signal definition.

2003-12-05  Yong Sun <Yong.Sun@Sun.com>

	Fix for #51337

	* gui/dialogs/alarm-page.c
	Change raw string "Action/Trigger" to _("Action/Trigger")
	* gui/dialogs/recurrence-page.c
	Change raw string "Date/Time" to _("Date/Time")

2003-12-04  Harry Lu  <harry.lu@sun.com>

	Fix for bugzilla bug #51627.

	* gui/goto.c: (create_ecal): set calitem's move_selection_when_moving 
	to FALSE so that changing month and year won't send out 
	a "selection_changed" signal.

2003-12-03  Ettore Perazzoli  <ettore@ximian.com>

	* gui/tasks-control.c (tasks_control_activate): Do not call
	control_util_set_folder_bar_label().

	* gui/e-calendar-table.c (e_calendar_table_set_status_message):
	Use e_activity_handler_operation_progressing(), not
	evolution_activity_client_update().

	* gui/e-cal-view.c: Remove settings menu.
	(on_settings): Remove.

	* gui/calendar-commands.c (get_shell_view_interface): Remove.
	(control_util_set_folder_bar_label): Remove.
	(calendar_set_folder_bar_label): Remove.
	(control_util_show_settings): Remove.
	(gcal_calendar_dates_change_cb): Remove.
	(calendar_control_activate): Do not connect, do not call
	calendar_set_folder_bar_label().

2003-12-03  JP Rosevear <jpr@ximian.com>

	* gui/gnome-cal.c (gnome_calendar_destroy): free the notification
	list
	
	* gui/tasks-component.c (impl_dispose): ditto

	* gui/calendar-component.c (impl_dispose): ditto

2003-12-03  JP Rosevear <jpr@ximian.com>

	* gui/tasks-component.c (impl_dispose): free up the notifications
	and the ecal
	(config_create_ecal_changed_cb): clear the create_ecal if the
	primary selection changes
	(setup_create_ecal): find a default ecal to do creation with
	(impl_requestCreateItem): use above

2003-12-03  JP Rosevear <jpr@ximian.com>

	* gui/tasks-component.c (rename_task_list_cb): cast the parent
	(impl_createControls): add notification for primary tasks
	(config_primary_selection_changed_cb): handle primary selection
	changing in gconf

	* gui/calendar-config-keys.h: fix config key for primary tasks

2003-12-03  JP Rosevear <jpr@ximian.com>

	* gui/calendar-component.c (rename_calendar_cb): cast the parent
	(config_primary_selection_changed_cb): handle the primary
	selection changing elsewhere
	(impl_dispose): remove the list of notifications
	(impl_createControls): add primary calendar notification
	(config_create_ecal_changed_cb): clear create_ecal if the primary
	key changes
	(setup_create_ecal): find an ecal to use for creation
	(impl_requestCreateItem): use above

2003-12-03  Ettore Perazzoli  <ettore@ximian.com>

	* importers/icalendar-importer.c: Do not #include shell stuff.

	* gui/main.c: Do not #include <evolution-shell-client.h>.

	* gui/e-itip-control.c: Do not #include
	<e-folder-selector-button.h> nor <evolution-shell-client.h>.
	(start_default_server): Return FALSE.
	(default_server_started_cb): Do not connect the "selected" signal
	on the button since it's now NULL.
	(button_selected_cb): #if 0 out.

	* gui/e-cal-list-view.h: Do not #include
	"evolution-activity-client.h".

	* gui/tasks-component.c (impl_createControls): Give an empty label
	for the status bar.

	* gui/e-day-view.h: Remove all deps on evolution-activity-client.

2003-12-02  Rodney Dawes  <dobey@ximian.com>

	* gui/Makefile.am: Version the schemas
	* gui/apps_evolution_calendar.schemas: Removed
	* gui/apps_evolution_calendar.schemas.in.in: Added

2003-12-02  Rodrigo Moya <rodrigo@ximian.com>

	* gui/dialogs/copy-source-dialog.c (copy_source_dialog): added
	a label to the dialog to make it look less ugly.

2003-12-02  Rodrigo Moya <rodrigo@ximian.com>

	* gui/dialogs/copy-source-dialog.c: converted to use an
	ESourceOptionMenu instead of the ESourceSelector.
	(primary_selection_changed_cb): removed.
	(copy_source_dialog): create the ESourceOptionMenu here.
	(source_selected_cb): callback for the "source_selected"
	signal on the ESourceOptionMenu widget.

2003-12-02  Ettore Perazzoli  <ettore@ximian.com>

	* gui/e-calendar-table.h (struct _ECalendarTable): Replace member
	"activity" with an "activity_id".

	* gui/e-cal-view.c (struct _ECalendarViewPrivate): Replace member
	"activity" with "activity_id".
	(e_calendar_view_destroy): Don't unref activity here anymore.
	(e_calendar_view_set_status_message): Report progress using the
	EActivityHandler off the CalendarComponent.

	* gui/calendar-component.c
	(struct _CalendarComponentPrivate): New member activity_handler.
	(calendar_component_init): Init.
	(calendar_component_peek_activity_handler): New.
	(impl_dispose): Unref.
	(impl_createControls): Return an ETaskBar for the statusbar
	control.

2003-12-01  Ettore Perazzoli  <ettore@ximian.com>

	* gui/calendar-component.c (impl_createControls): Pass a label for
	the status bar control for now.

	* gui/tasks-component.c (impl_createControls): Pass a label for
	the status bar control for now.

2003-12-01  Rodney Dawes  <dobey@ximian.com>

	* gui/GNOME_Evolution_Calendar.server.in.in:
	* gui/calendar-commands.c:
	* gui/e-meeting-list-view.c:
	* gui/e-meeting-model.c:
	* gui/e-select-names-editable.c:
	* gui/itip-bonobo-control.c:
	* gui/itip-utils.c:
	* gui/main.c:
	* gui/alarm-notify/GNOME_Evolution_Calendar_AlarmNotify.server.in.in:
	* gui/alarm-notify/alarm-queue.c:
	* gui/alarm-notify/notify-main.c:
	* gui/dialogs/alarm-options.c:
	* gui/dialogs/e-delegate-dialog.c:
	* importers/GNOME_Evolution_Calendar_Importer.server.in.in:
	* importers/main.c: Use BASE_VERSION for repo_ids and OAFIIDs

2003-12-01  JP Rosevear <jpr@ximian.com>

	* conduits/todo/Makefile.am: put the conduits in their own dir

	* conduits/calendar/Makefile.am: ditto
	
	* conduits/todo/e-todo.conduit.in: subst in correct thing

	* conduits/calendar/e-calendar.conduit.in: ditto

2003-12-01  JP Rosevear <jpr@ximian.com>

	* conduits/todo/Makefile.am: install to privlibdir

	* conduits/calendar/Makefile.am: ditto
	
	* conduits/todo/e-todo.conduit.in: subst in correct thing

	* conduits/calendar/e-calendar.conduit.in: subst in correct thing

2003-12-01  Rodrigo Moya <rodrigo@ximian.com>

	* gui/alarm-notify/alarm-notify.c (add_uri_to_load, remove_uri_to_load):
	removed unneeded functions.
	(alarm_notify_add_calendar, alarm_notify_remove_calendar): no need
	anymore to add/remove URIs to load on startup to the configuration.

2003-12-01  Rodrigo Moya <rodrigo@ximian.com>

	* gui/alarm-notify/save.c (save_calendars_to_load): removed this
	function, since we now use the ESourceList to know what calendars
	to load.
	(get_calendars_to_load): moved to config-data.c.
	(save_notification_time, get_saved_notification_time,
	save_blessed_program, is_blessed_program): use the
	shared GConfClient.

	* gui/alarm-notify/config-data.[ch]: use a GConfClient instead of a
	EConfigListener.
	(config_data_get_conf_client): renamed from _get_listener.
	(config_data_get_timezone, config_data_get_24_hour_format): changed
	to use the GConfClient.
	(config_data_get_calendars_to_load): new function.
	(ensure_inited): create the source lists for calendar and tasks here.
	(do_cleanup): cleanup the source lists here.

	* gui/alarm-notify/notify-main.c (load_calendars): use
	config_data_get_calendars_to_load().

2003-11-28  JP Rosevear <jpr@ximian.com>

	* gui/e-tasks.c (e_tasks_delete_completed): we want to skip if it
	*is* read only

2003-11-28  JP Rosevear <jpr@ximian.com>

	* gui/e-meeting-store.c (e_meeting_store_get_type): allocate the
	type information correctly

2003-11-26  Hans Petter Jansson  <hpj@ximian.com>

	* gui/calendar-offline-handler.c (backend_go_offline): e_cal_new () ->
	e_cal_new_from_uri ().
	(backend_go_online): Ditto.
	(calendar_offline_handler_init): Ditto.

	* gui/comp-editor-factory.c (open_client): Ditto.

	* gui/e-itip-control.c (start_calendar_server): Ditto.
	(object_requested_cb): Ditto.

	* gui/e-tasks.c (e_tasks_add_todo_uri): Ditto.

	* gui/gnome-cal.c (gnome_calendar_construct): Ditto.
	(gnome_calendar_add_event_uri): Ditto.

	* gui/alarm-notify/alarm-notify.c (alarm_notify_add_calendar): Ditto.

	* importers/icalendar-importer.c (load_file_fn): Ditto.
	(vcal_load_file_fn): Ditto.
	(gnome_calendar_import_data_fn): Ditto.

	* gui/dialogs/copy-source-dialog.c (copy_source): Pass sources to
	e_cal_new ().

2003-11-24  Rodrigo Moya <rodrigo@ximian.com>

	* gui/dialogs/copy-source-dialog.c (copy_source): use the correct
	icalcomponent when calling e_cal_create_object.

	* gui/tasks-control.c (sensitize_commands): no need to have a
	selection for Paste to work.

	* gui/e-calendar-table.c (e_calendar_table_show_popup_menu): disable
	editing items if the selected task list is read only, not if it's not.

2003-11-24  Rodrigo Moya <rodrigo@ximian.com>

	* gui/dialogs/new-task-list.glade:
	* gui/dialogs/new-task-list.[ch]: new files containing the
	implementation of the 'New Task List' dialog.

	* gui/dialogs/Makefile.am: added new files.

	* gui/dialogs/new-calendar.c (new_calendar_dialog): use G_STRLOC
	for g_warning messages.

	* gui/tasks-component.c (new_task_list_cb): implemented.

2003-11-24  Rodrigo Moya <rodrigo@ximian.com>

	* gui/dialogs/copy-source-dialog.c (copy_source_dialog): actually
	add the source selector to the dialog's box.

2003-11-23  Rodrigo Moya <rodrigo@ximian.com>

	* gui/tasks-component.c:
	* gui/dialogs/copy-source-dialog.[ch]: fixed compilation errors.

	* gui/dialogs/Makefile.am: added missing header directories.

2003-11-23  Rodrigo Moya <rodrigo@ximian.com>

	* gui/dialogs/new-calendar.[ch]: fixed copyright notices.

	* gui/dialogs/copy-source-dialog.[ch]: implementation of the
	Copy command for sources.

	* gui/dialogs/Makefile.am: added new files.

	* gui/calendar-component.c (fill_popup_menu_cb, copy_calendar_cb):
	added Copy command.

	* gui/tasks-component.c (fill_popup_menu_cb, copy_task_list_cb):
	added Copy command.

2003-11-23  Ross Burton  <ross@burtonini.com>

	* gui/alarm-notify/GNOME_Evolution_Calendar_AlarmNotify.server.in.in:
	Append "_2" to the OAFIID to avoid conflicting with Evo 1.4.
	
	* gui/main.c:
	* gui/alarm-notify/notify-main.c:
	Updated with new OAFIID.

2003-11-20  JP Rosevear <jpr@ximian.com>

	* Remove a bunch of gal includes that are no longer needed

2003-11-19  Rodrigo Moya <rodrigo@ximian.com>

	Fixes #43556

	* gui/e-cal-view.c (selection_get, selection_clear_event,
	selection_received): removed this unneeded functions.
	(e_calendar_view_init): don't create a GtkInvisible anymore.
	(e_calendar_view_destroy): no need to destroy the GtkInvisible.
	(e_cal_view_copy_clipboard, e_cal_view_paste_clipboard):
	use GtkClipboard.

2003-11-19  JP Rosevear <jpr@ximian.com>

	* gui/e-cal-model-tasks.c (get_due): make sure timezone value is
	sane
	(get_completed): ditto

	* gui/e-cal-model.c (get_dtstart): add more guards

	* gui/e-cal-model-calendar.c (get_dtend): ditto
	
2003-11-19  Rodrigo Moya <rodrigo@ximian.com>

	Fixes #51052

	* importers/icalendar-importer.c (prepare_events, prepare_tasks):
	call icalcompiter_next to move the pointer to the next before
	removing a component avoid breaking the link.

2003-11-18  JP Rosevear <jpr@ximian.com>

	* gui/e-cal-model.c (get_dtstart): make sure the timezone value is
	sane

	* gui/e-cal-model-calendar.c (get_dtend): ditto
	
2003-11-18  JP Rosevear  <jpr@ximian.com>

	* gui/calendar-config.h: add protos

	* gui/calendar-config.c (calendar_config_get_primary_calendar):
	get the primary calendar
	(calendar_config_set_primary_calendar): set it
	(calendar_config_add_notification_primary_calendar): set
	notifications for it
	(calendar_config_get_primary_tasks): get the primary task list
	(calendar_config_set_primary_tasks): set it
	(calendar_config_add_notification_primary_tasks): set
	notifications for it

	* gui/calendar-config-keys.h: add primary keys

	* gui/calendar-component.c (find_first_source): find any source
	(update_uri_for_primary_selection): set the default uri and save
	the source uid
	(update_primary_selection): set the primary selection
	(primary_source_selection_changed_cb): use above
	(impl_createControls): set the primary selection

	* gui/tasks-component.c: as above
	
2003-11-18  JP Rosevear <jpr@ximian.com>

	* gui/Makefile.am: remove db3 include

2003-11-18  Rodrigo Moya <rodrigo@ximian.com>

	* gui/calendar-commands.c
	(calendar_control_sensitize_calendar_commands,
	sensitize_taskpad_commands): removed the 'New...' menu items
	from the UI, it's now implemented in the shell.
	(file_new_appointment_cb, file_new_event_cb, file_new_meeting_cb,
	file_new_task_cb): removed.

2003-11-18  Rodrigo Moya <rodrigo@ximian.com>

	* gui/calendar-component.c (add_popup_menu_item): added 'sensitive'
	argument.
	(fill_popup_menu_cb): disable/enable menu items depending on whether
	there is a selection or not.

	* gui/tasks-component.c (add_popup_menu_item, fill_popup_menu_cb):
	ditto.

2003-11-17  JP Rosevear <jpr@ximian.com>

	* Cleanup some ref/unref calls

2003-11-17  Rodrigo Moya <rodrigo@ximian.com>

	* gui/calendar-component.c (delete_calendar_cb, rename_calendar_cb):
	* gui/tasks-component.c (delete_task_list_cb, rename_task_list_cb):
	peek the primary selection.

2003-11-17  Rodrigo Moya <rodrigo@ximian.com>

	* gui/tasks-component.c (fill_popup_menu_cb): added 'Delete' and
	'Rename' menu items.
	(delete_task_list_cb, rename_task_list_cb): callbacks for new
	menu items.

2003-11-17  Rodrigo Moya <rodrigo@ximian.com>

	* gui/calendar-component.c (add_popup_menu_item): try first to
	create the icon from the stock, and then from a file.
	(fill_popup_menu_cb): set callback for 'Rename' menu item.
	(rename_calendar_cb): callback for 'Rename' menu item.
	(new_calendar_cb): fixed arguments.

	* gui/tasks-component.c (impl_createControls): connect to
	"fill_popup_menu" signal on the source selector.
	(fill_popup_menu_cb): callback to create our menu items.

2003-11-17  Rodrigo Moya <rodrigo@ximian.com>

	* idl/evolution-calendar.idl: remove the AlarmNotify service, no
	more need for it, since the alarm daemon will listen for changes
	on the GConf key.

	* gui/gnome-cal.c (add_alarms): removed function to talk to the
	alarm daemon.
	(client_cal_opened_cb): don't call add_alarms().

	* gui/alarm-notify/alarm-notify.[ch]: made it a basic GObject.
	(AlarmNotify_addCalendar, AlarmNotify_removeCalendar): removed
	AlarmNotify interface implementation.
	(alarm_notify_class_init): no epv to initialize.
	(alarm_notify_remove_calendar): new function, copied from the
	CORBA method implementation.
	(alarm_notify_factory_fn): return NULL, since there is no objects
	that can be created via this factory now.

	* gui/alarm-notify/notify-main.c (main): now the factory is the alarm
	notification service itself.
	(load_calendars): no need to use exceptions here.

	* gui/alarm-notify/GNOME_Evolution_Calendar_AlarmNotify.server.in.in:
	now the factory is the alarm notification service itself.

	* gui/main.c (launch_alarm_daemon_cb): dont use the AlarmNotify CORBA
	types.

2003-11-17  Harry Lu  <harry.lu@sun.com>

        * gui/dialogs/recurrence-page.c (make_ending_count_special):
        Make ending count of occurrences of Recurrence tab numeric only.

2003-11-16  JP Rosevear <jpr@ximian.com>

	* gui/tasks-control.c (tasks_control_set_property): add a uri

	* gui/e-tasks.c: kill e_tasks_open

	* gui/e-tasks.h: remove proto

2003-11-16  JP Rosevear <jpr@ximian.com>

	* gui/e-cal-model.c (e_cal_view_objects_added_cb): emit the added
	signal for the correct rows

2003-11-16  JP Rosevear <jpr@ximian.com>

	* gui/tasks-component.c (is_in_uids): copy in here
	(update_uris_for_selection): save the selection
	(update_selection): update the selection when its changed
	somewhere else
	(config_selection_changed_cb): update the selection if the
	configuration changes
	(impl_createControls): store the source selector

	* gui/calendar-config.h: add protos

	* gui/calendar-config.c (calendar_config_get_tasks_selected): get
	the list of task lists selected
	(calendar_config_set_tasks_selected): save it
	(calendar_config_add_notification_tasks_selected): get notified
	about it

2003-11-16  JP Rosevear <jpr@ximian.com>

	* gui/tasks-component.c (add_uri_for_source): add it via e-tasks
	(remove_uri_for_source): remove it via e-tasks
	(get_default_task): provide a default for editing
	(impl_createControls): create the control directly
	(impl_requestCreateItem): implement

	* gui/gnome-cal.c (gnome_calendar_purge): don't let the two list
	iterators clobber each other

	* gui/e-tasks.h: add protos

	* gui/e-tasks.c (e_tasks_destroy): free the client list and the
	hash, disconnect signals
	(e_tasks_new_task): use the default client
	(e_tasks_add_todo_uri): add a uri
	(e_tasks_remove_todo_uri): remove a uri
	(e_tasks_set_default_uri): set default uri
	(e_tasks_get_default_client): get default client
	(e_tasks_delete_completed): expunge from all clients
	(e_tasks_setup_view_menus): use default client uri

	* gui/e-tasks.c (set_timezone): set the timezone for all clients
	(e_tasks_init): set up the clients has table

	* gui/e-calendar-table.etspec: yank some useless display columns

	* gui/e-cal-model.c (remove_client): remove objects in reverse
	order so we don't clobber ourselves

	* gui/calendar-component.c: add FIXME

2003-11-16  JP Rosevear <jpr@ximian.com>

	* gui/calendar-component.c (get_default_event): set up a event to
	be edited
	(impl_requestCreateItem): implement

2003-11-14  JP Rosevear <jpr@ximian.com>

	* gui/*.[hc]: include e-source* from e-d-s

2003-11-14  JP Rosevear <jpr@ximian.com>

	* gui/calendar-config.c (calendar_config_get_calendars_selected):
	config accessor
	(calendar_config_set_calendars_selected): ditto
	(calendar_config_add_notification_calendars_selected): config
	notification

	* gui/calendar-config.h: add protos

	* gui/calendar-config-keys.h: add new key

	* gui/calendar-component.c (is_in_uids): util function
	(update_uris_for_selection): save the selection in the
	configuration
	(update_selection): update the selection from the config info
	(source_selection_changed_cb): only pass one param
	(config_selection_changed_cb): listen for config changes
	(impl_dispose): remove config notification
	(impl_createControls): use bonobo_exception_set; add a config
	notification

2003-11-13  Ettore Perazzoli  <ettore@ximian.com>

	* gui/tasks-component.c (impl__get_userCreatableItems): New.
	(impl_requestCreateItem): New.
	(tasks_component_class_init): Install.

	* gui/calendar-component.c (impl__get_userCreatableItems): New.
	(impl_requestCreateItem): New, for now just a stub.
	(calendar_component_class_init): Install into the EPV.

2003-11-13  Ettore Perazzoli  <ettore@ximian.com>

	* gui/GNOME_Evolution_Calendar.server.in.in: Add a component_alias
	of "calendar" for the calendar and "tasks" for the tasks.

2003-11-12  Hans Petter Jansson  <hpj@ximian.com>

	* gui/calendar-component.c (add_popup_menu_item): Use non-deprecated
	gtk_menu_shell_append ().

2003-11-11  Bolian Yin <bolian.yin@sun.com>
                                                                                
        Fixes #50808
                                                                                
        * gui/goto.c (goto_dialog): set initial selection to current day.
                                                                                
2003-11-11  JP Rosevear <jpr@ximian.com>

	* gui/calendar-offline-handler.c (backend_cal_opened_offline): use
	a standard calendar status
	(backend_cal_opened_online): ditto
	
	* gui/alarm-notify/alarm-queue.c (cal_opened_cb): ditto

	* gui/gnome-cal.c (client_cal_opened_cb): ditto

	* gui/e-tasks.c (cal_opened_cb): ditto

	* gui/e-itip-control.c (default_server_started_cb): ditto

	* gui/e-cal-model.c (cal_opened_cb): ditto

	* gui/comp-editor-factory.c (cal_opened_cb): ditto

2003-11-11  JP Rosevear <jpr@ximian.com>

	* conduits/todo/todo-conduit.c (start_calendar_server): load the
	calendar synchronously

	* conduits/calendar/calendar-conduit.c (start_calendar_server): ditto
	
2003-11-10  JP Rosevear <jpr@ximian.com>

	* importers/icalendar-importer.c (update_single_object): return
	boolean not ECalStatus
	(update_objects): ditto
	(process_item_fn): handle above returns

2003-11-10  JP Rosevear <jpr@ximian.com>

	* gui/e-cal-model-tasks.c (get_due_status): just check the boolean

2003-11-10  JP Rosevear <jpr@ximian.com>

	* conduits/calendar/calendar-conduit.c
	(e_calendar_context_destroy): use proper change list free function
	name
	(post_sync): ditto

	* conduits/todo/todo-conduit.c: same
	
2003-11-10  Dan Winship  <danw@ximian.com>

	* gui/e-tasks.c (e_tasks_delete_completed): Remove get-vtype check
	from the completed-tasks query (and don't leak the sexp string).

	* gui/e-cal-model.c (update_e_cal_view_for_client): Don't adjust
	the sexp to use get-vtype.

	* gui/gnome-cal.c (adjust_e_cal_view_sexp, gnome_calendar_purge):
	Remove get-vtype check from queries

2003-11-07  JP Rosevear <jpr@ximian.com>

	* gui/Makefile.am: remove includes for toplevel libical dir

	* gui/dialogs/Makefile.am: ditto

	* importers/Makefile.am: ditto

2003-11-07  JP Rosevear <jpr@ximian.com>

	* In the gui this is a search and replace commit for moving the
	calendar to evolution-data-server; it also deletes the old backend
	files; e-cal-view was rename to e-calendar-view to remove name
	conflict
	
2003-11-05  JP Rosevear <jpr@ximian.com>

	* gui/migration.c: fix typo

2003-11-05  Larry Ewing  <lewing@ximian.com>

	* gui/migration.c (process_old_dir): add a unimplemented warning
	so we at least avoid relocation errors.

2003-11-04  Rodrigo Moya <rodrigo@ximian.com>

	* gui/calendar-component.c (fill_popup_menu_callback): added more
	menu items.
	(delete_calendar_cb): callbacks for new popup menu items.
	(impl_createControls): add the source selector widget to the
	CalendarComponentPrivate structure.

	* gui/migration.[ch] (migrate_old_tasks): new function to migrate
	old tasks setups.
	(process_old_dir): renamed and added a "filename" argument, so that
	the same function can be used for tasks and calendar directories.
	(migrate_old_calendars): added new argument when calling
	process_old_dir().

	* gui/tasks-component.c (tasks_component_init): call
	migrate_old_tasks() if there are no groups defined.

2003-11-04  Bolian Yin <bolian.yin@sun.com>

	* gui/e-cal-view.c: add new signal "selected_time_changed" 
	* gui/e-day-view-main-item.c (e_day_view_main_item_class_init):
	a11y initialization
	* gui/e-day-view-top-item (e_day_view_top_item_get_day_label):
	new public function.
	* gui/e-day-view.c (e_day_view_ensure_rows_visible,
	e_day_view_update_calendar_selection_time): make static functions public
	(e_day_view_cursor_key_up, e_day_view_cursor_key_down,
	e_day_view_cursor_key_left, e_day_view_cursor_key_right): emit
	"selected_time_changed".

2003-11-03  Ettore Perazzoli  <ettore@ximian.com>

	* gui/e-meeting-model.c (SELECT_NAMES_OAFID): Append "_2".
	* gui/e-select-names-editable.c (SELECT_NAMES_OAFIID): Likewise.
	* gui/e-meeting-list-view.c (SELECT_NAMES_OAFID): Likewise.
	* gui/dialogs/alarm-options.c (SELECT_NAMES_OAFID): Likewise.
	* gui/dialogs/e-delegate-dialog.c (SELECT_NAMES_OAFID): Likewise

2003-11-03  Ettore Perazzoli  <ettore@ximian.com>

	* gui/GNOME_Evolution_Calendar.server.in.in: use
	"evolution2:config_item" properties instead of
	"evolution:config_item" ones.

2003-11-03  Harry Lu  <harry.lu@sun.com>

	Fix for #50387.

	* importers/icalendar-importer.c (support_format_fn):
	Call icalcomponent_is_valid() to check whether the returned
	icalcomponent is valid.

2003-10-31  Hans Petter Jansson  <hpj@ximian.com>

	* gui/calendar-component.c (calendar_component_init): Add the webcal
	source group.

	* gui/dialogs/new-calendar.c (print_uri_noproto): Implement.
	(group_is_remote): Implement.
	(create_new_source_with_group): Implement webcal case.
	(new_calendar_dialog): Get optional location from dialog.

	* gui/dialogs/new-calendar.glade: Add location entry.

	* pcs/Makefile.am: Build http backend.

	* pcs/cal-backend-http.[ch]: Add skeleton based on cal-backend-file.

2003-10-31  Dan Winship  <danw@ximian.com>

	* cal-util/cal-util.h: Add CAL_STATIC_CAPABILITY_NO_THISANDFUTURE
	and CAL_STATIC_CAPABILITY_NO_THISANDPRIOR

	* gui/dialogs/recur-comp.c (recur_component_dialog): Add a
	CalClient argument. Use cal_client_get_static_capability to decide
	whether or not to offer THISANDFUTURE and THISANDPRIOR options

	* gui/dialogs/comp-editor.c (prompt_to_save_changes, save_cmd,
	save_close_cmd): Pass a CalClient to recur_component_dialog.

	* gui/e-day-view.c (e_day_view_finish_long_event_resize,
	e_day_view_finish_resize, e_day_view_on_editing_stopped,
	e_day_view_on_top_canvas_drag_data_received,
	e_day_view_on_main_canvas_drag_data_received): Likewise

	* gui/e-week-view.c (e_week_view_on_editing_stopped): Likewise

	* gui/calendar-component.c (impl_createControls): set an exception
	if we fail, so evo won't crash.

2003-10-31  Rodrigo Moya <rodrigo@ximian.com>

	* gui/e-calendar-table.c (e_calendar_table_show_popup_menu): fixed
	mismatched condition in if/else statement.

2003-10-30  Rodrigo Moya <rodrigo@ximian.com>

	* gui/e-tasks.[ch] (e_tasks_get_cal_client): removed.

	* gui/tasks-control.c (sensitize_commands): fixed to work correctly
	with the ECalView's model.
	(tasks_control_set_property): don't use e_tasks_get_cal_client.

	* gui/alarm-notify/alarm-notify.c (free_client_hash): new function
	to remove items from the CalClient's hash table.
	(alarm_notify_finalize): call free_client_hash() for each item
	in the hash table.

2003-10-30  Rodrigo Moya <rodrigo@ximian.com>

	* gui/alarm-notify/notify-main.c (client_die_cb): use
	bonobo_main_quit, not gtk_main_quit.

	* gui/alarm-notify/alarm-queue.c (free_client_alarms_cb): callback
	for freeing ClientAlarms stored in the hash table.
	(alarm_queue_done): call free_client_alarms_cb() for each opened
	client.

2003-10-30  Rodrigo Moya <rodrigo@ximian.com>

	* pcs/cal-backend-file.c (mark_dirty, save_idle): removed, since
	we dont save the file anymore in idle callbacks.
	(cal_backend_file_dispose): removed all traces of the idle saving.
	(check_dup_uid, create_cal, cal_backend_file_add_timezone,
	cal_backend_file_create_object, cal_backend_file_modify_object,
	cal_backend_file_remove_object, cal_backend_file_receive_objects):
	call save() directly instead of mark_dirty().

2003-10-30  Rodrigo Moya <rodrigo@ximian.com>

	* pcs/cal-backend-file.c (cal_backend_file_modify_object):
	implemented THIS and ALL recurrences cases, blowing away or detaching
	recurrences from the main component as required.
	(get_rid_string): make it return const.
	(get_rid_timetype): new convenience function for getting
	libical's recurrence ID from a CalComponent.
	(cal_backend_file_is_read_only, remove_recurrence_cb,
	remove_component): fixed warnings.
	(remove_object_instance_cb): callback to remove the instances
	from the hash on the THISANDPRIOR and THISANDFUTURE cases.
	(cal_backend_file_remove_object): replaced mismatched if/else
	statement with proper management of each of the recurrence cases.

2003-10-29  JP Rosevear <jpr@ximian.com>

	* gui/Makefile.am: build new files

	* gui/dialogs/comp-editor-util.c (date_edit_destroy_cb): unref the
	config manager
	(comp_editor_new_date_edit): set up a config manager for the date
	editor

	* gui/e-date-edit-config.[hc]: config manager for e-date-edit

2003-10-29  JP Rosevear <jpr@ximian.com>

	* gui/dialogs/cal-prefs-dialog.c (update_config): no need to
	update config settings everywhere explicitly

	* gui/tasks-component.c (update_uris_for_selection): cast the
	widget

	* gui/gnome-cal.h: remove proto

	* gui/gnome-cal.c (setup_widgets): don't update config settings
	explicitly
	(gnome_calendar_update_config_settings): kill

	* gui/e-week-view.c: remove null chars

	* gui/e-tasks.h: remove proto

	* gui/e-tasks.c (set_timezone): set the timezone on the client
	(timezone_changed_cb): changed timezone callback
	(setup_config): setup config stuff
	(e_tasks_init): setup config and widgets here
	(e_tasks_new): construct is dead, no need to track all widgets
	(cal_opened_cb): set the timezone upon opening
	(e_tasks_update_all_config_settings): kill

	* gui/control-factory.c (control_factory_new_control): create the
	calendar ourselves

	* gui/calendar-config.c (on_timezone_set): don't update the
	settings everywhere here, we have config managers now

	* gui/calendar-component.c (impl_createControls): create the
	calendar ourselves

	* gui/calendar-commands.h: remove protos

	* gui/calendar-commands.c: remove dead functions

2003-10-29  JP Rosevear <jpr@ximian.com>

	* gui/e-day-view-config.c (set_twentyfour_hour): set the format on
	the cal view

	* gui/e-week-view-config.c (set_twentyfour_hour): ditto
	
	* gui/e-cal-list-view-config.c (set_twentyfour_hour): set the 24
	hour format on the view
	(twentyfour_hour_changed_cb): 24 hour format change callback
	(e_cal_list_view_config_set_view): handle 24 hour format changes

2003-10-29  JP Rosevear <jpr@ximian.com>

	* gui/dialogs/recurrence-page.c (recurrence_page_finalize): unref
	config manager
	(init_widgets): create config manager for the e-calendar

	* gui/e-tasks.c (setup_widgets): create config manager for the
	table view
	(e_tasks_destroy): unref config manager
	(e_tasks_open): return FALSE not NULL
	(e_tasks_update_all_config_settings): don't configure the calendar
	table here, we have a manager

	* gui/calendar-config.c: remove dead config functions (handled by
	config managers now)

2003-10-29  JP Rosevear <jpr@ximian.com>

	* gui/gnome-cal.c (set_timezone): set the timezone for all clients
	(timezone_changed_cb): callback for changes
	(setup_config): setup the configuration
	(setup_widgets): setup up configuration managers for the list
	view, task list and date navigator
	(gnome_calendar_init): setup config
	(gnome_calendar_destroy): destroy configuration managers and
	notifications
	(gnome_calendar_update_config_settings): remove dead bits

	* gui/e-mini-calendar-config.[hc]: manage configuration of an
	e-calendar

	* gui/e-day-view-config.h: remove extraneous comment, type the
	parent class correctly

	* gui/e-week-view-config.h: ditto
	
	* gui/e-day-view-config.c (e_day_view_config_class_init): type the
	class correctly
	(set_timezone): set timezone
	(timezone_changed_cb): timezone changed callback
	(e_day_view_config_set_view): track timezone changes

	* gui/e-week-view-config.c: ditto
	
	* gui/e-cell-date-edit-config.[hc]: manage configuration of a date
	edit cell

	* gui/e-calendar-table-config.[hc]: manage configuration of a
	e-calendar-table

	* gui/e-cal-list-view.c (get_current_time_cb): use the view
	timezone to compute

	* gui/e-cal-list-view-config.[hc]: manage configuration of a
	list view

	* gui/calendar-config.h: update protos

	* gui/calendar-config.c
	(calendar_config_add_notification_timezone): notify of timezone
	change
	(calendar_config_add_notification_dnav_show_week_no): notify of
	show week number setting change

	* gui/calendar-component.c (calendar_component_peek): remove bad
	comma

	* gui/Makefile.am: build new config classes

2003-10-29  Rodrigo Moya <rodrigo@ximian.com>

	* gui/calendar-component.c (fill_popup_menu_callback): fixed
	typo in menu item label.

	* gui/e-cal-model.[ch] (e_cal_model_get_use_24_hour_format): new
	function.

	* gui/e-cal-view.[ch]: no need to keep the 'use_24_hour' setting,
	it's already in the model.
	(e_cal_view_get_use_24_hour_format,
	e_cal_view_set_use_24_hour_format): new functions.

	* gui/e-day-view.[ch] (e_day_view_get_24_hour_format,
	(e_day_view_set_24_hour_format): removed.
	(e_day_view_convert_time_to_display, e_day_view_update_event_label,
	e_day_view_get_time_string_width): use the ECalView's function to
	get the 24 hour format.

	* gui/e-week-view.[ch] (e_week_view_get_24_hour_format,
	e_week_view_set_24_hour_format): removed.
	(e_week_view_convert_time_to_display,
	e_week_view_get_time_string_width): use the ECalView's function
	to get the 24 hour format.

	* gui/e-day-view-top-item.c (e_day_view_top_item_draw_long_event):
	* gui/e-day-view-time-item.c (e_day_view_time_item_draw):
	* gui/e-week-view-event-item.c (e_week_view_draw_time):
	don't use the view's use_24_hour_format, but the ECalView method.

2003-10-28  Rodrigo Moya <rodrigo@ximian.com>

	* gui/calendar-component.c (impl_createControls): connect to
	"fill_popup_menu" on the ESourceSelector.
	(fill_popup_menu_callback): add popup menu items here.
	(add_popup_menu_item): new function to add items to the
	popup menu.
	(new_calendar_cb): callbacks for the popup menu items.

2003-10-28  Rodrigo Moya <rodrigo@ximian.com>

	* gui/e-cal-view.c: no need to keep the timezone here, it is
	already stored in the model.
	(e_cal_view_get_timezone): call e_cal_model_get_timezone().
	(e_cal_view_set_timezone): call e_cal_model_set_timezone().
	(e_cal_view_new_appointment_for): use the model's timezone.

2003-10-27  Dan Winship  <danw@ximian.com>

	* pcs/cal-backend.c (cal_backend_notify_object_created,
	cal_backend_notify_object_modified,
	cal_backend_notify_object_removed): New; tell each query about a
	created/modified/removed object.

	* pcs/cal.c (cal_notify_object_created): Use
	cal_backend_notify_object_created.
	(cal_notify_object_modified, cal_notify_object_removed): Likewise
	for modified/removed
	(cal_notify_objects_received): we need both the before and after
	forms for the modified objects so they can be resolved as
	adds/modifies/removes per-query. But the caller can just call the
	cal_backend_* routines for each object anyway, so just remove the
	created/modified/removed lists.

	* pcs/cal-backend-sync.c (cal_backend_sync_receive_objects):
	Remove created/modified/removed list arguments.
	(_cal_backend_receive_objects): Likewise.

	* pcs/cal-backend-file.c (cal_backend_file_receive_objects):
	Remove created/modified/removed list arguments. Replace the one
	use of *removed with a call to cal_backend_notify_object_removed.

2003-10-27  JP Rosevear <jpr@ximian.com>

	* gui/gnome-cal.c (setup_widgets): store config objects as well
	(gnome_calendar_set_default_uri): return FALSE if the
	pre-condition fails
	(gnome_calendar_update_config_settings): remove settings that are
	now handled by the config objects

	* gui/e-week-view.c (e_week_view_set_compress_weekend): queue a
	draw

	* gui/e-itip-control.c (start_default_server): comment out

	* gui/e-day-view-config.[hc]: a class to track config changes of
	interest to day views

	* gui/e-week-view.[hc]: ditto for week views
	
	* gui/calendar-config.h: add protos

	* gui/calendar-config.c: use the #defines for the keys and add
	notification routines

	* gui/calendar-config-keys.h: a list of defines for gconf keys

	* gui/Makefile.am: build new files

2003-10-27  Rodrigo Moya <rodrigo@ximian.com>

	* gui/e-cal-model.h: changed fill_component_from_model virtual
	method to get an ETableModel, not an ECalModel.

	* gui/e-cal-model.c (ecm_append_row): the source model sent from
	ETable is an ETableModel, not an ECalModel.

	* gui/e-cal-model-calendar.c (ecmc_fill_component_from_model):
	get an ETableModel for the 'source_model' argument.

	* gui/e-cal-model-tasks.c (ecmt_fill_component_from_model): ditto.

2003-10-27  Rodrigo Moya <rodrigo@ximian.com>

	* gui/tasks-component.c (add_uri_for_source): pass FALSE as the
	'only_if_exists' parameter, so that the calendar gets created when
	it still does not exist.

2003-10-24  Rodrigo Moya <rodrigo@ximian.com>

	* gui/tasks-component.c (tasks_component_init): initialize private
	structure on TasksComponent.

2003-10-24  Rodrigo Moya <rodrigo@ximian.com>

	* gui/calendar-component.c (calendar_component_class_init): removed
	repeated initialization.
	(calendar_component_peek): use G_STRLOC for g_warning's.

	* gui/tsaks-control.[ch] (tasks_control_activate,
	tasks_control_deactivate): made these 2 functions public.

	* gui/tasks-component.[ch]: implementation of the tasks component.

	* gui/Makefile.am:
	* gui/GNOME_Evolution_Calendar.server.in.in: added tasks component.

	* gui/main.c: ditto.
	(factory): added code to create the tasks component when requested.

2003-10-24  Dan Winship  <danw@ximian.com>

	* cal-client/cal-client.c (cal_client_get_changes): Remove type arg

	* conduits/calendar/calendar-conduit.c (pre_sync, post_sync):
	Update for that

	* conduits/todo/todo-conduit.c (pre_sync, post_sync): Likewise

	* idl/evolution-calendar.idl (getChanges): Remove type arg.

	* pcs/cal.c (impl_Cal_getChanges): Likewise

	* pcs/cal-backend.c (cal_backend_get_changes): Likewise

	* pcs/cal-backend-sync.c (cal_backend_sync_get_changes): Likewise

	* pcs/cal-backend-file.c (cal_backend_file_get_changes): Update
	for that

	* pcs/Makefile.am: build libpcs.la and libpcsfile.la instead of
	just .a.
	(libpcs_la_LIBADD): depend on libcal-util.la and libeutil.la
	(libpcsfile_la_LIBADD): depend on libpcs.la

2003-10-24  Rodrigo Moya <rodrigo@ximian.com>

	* cal-util/cal-util.[ch] (cal_util_construct_instance,
	cal_util_remove_instances): new functions for individual
	instances management.

	* pcs/cal-backend-file.c (cal_backend_file_get_object): if we
	dont have a recurrence in our hash table, generate one for the
	specified recurrence ID.
	(match_recurrence_sexp): new function to match recurrences on
	regular expresessions.
	(match_object_sexp): call match_recurrence_sexp() for all recurrences.
	(cal_backend_file_modify_object): handle mod_types.
	(cal_backend_file_remove_object): handle mod_types.

2003-10-24  JP Rosevear <jpr@ximian.com>

	* gui/gnome-cal.h: update protos

	* gui/gnome-cal.c (gnome_calendar_set_default_uri): set the
	default client based on uri

	* gui/calendar-component.c (add_uri_for_source): rename from
	load_uri_for_source and take a calendar
	(remove_uri_for_source): utility routine to remove the source's
	uri from the calendar
	(is_in_selection): checks to see if the uid of the given source
	matches any of those in the given selection
	(update_uris_for_selection): remove any uris no longer in the
	selection, add those that still exist
	(source_selection_changed_callback): call above
	(primary_source_selection_changed_callback): we have the calendar
	easily now; set the default by uri
	(control_activate_cb): handle activation and de-activation
	(impl_createControls): create the calendar control ourselves so we
	have access to the calendar
	(impl_dispose): release the source selection

2003-10-23  Rodrigo Moya <rodrigo@ximian.com>

	* pcs/cal-backend-file.c (add_component): if the component received
	is an instance, add it to the recurrences hash table.
	(free_recurrence): callback for g_hash_table_foreach() to free
	the recurrences in the CalBackendFileObject structure.
	(free_object): call free_recurrence for each recurrence.
	(remove_recurrence_cb): g_hash_table_foreach() callback to
	remove recurrences from the calendar.
	(remove_component): remove all recurrences.
	(cal_backend_file_open): check write access on the file, and
	set read_only flag appropriately.
	(cal_backend_file_is_read_only): return the private flag.
	(cal_backend_file_init): initialize read_only flag.
	(cal_backend_file_get_object): deal with recurrences.

	* gui/alarm-notify/notify-main.c (main): unref the alarm
	notification service when terminating.
	(client_die_cb): call bonobo_main_quit instead of gtk_main_quit.

2003-10-23    <jpr@ximian.com>

	* gui/gnome-cal.c (gnome_calendar_get_current_view_widget): just
	uses the views array and the current view type
	(setup_widgets): ditto
	(set_view): ditto
	(backend_died_cb): ditto
	(gnome_calendar_get_calendar_model): ditto
	(gnome_calendar_update_config_settings): ditto

2003-10-23  Rodrigo Moya <rodrigo@ximian.com>

	* gui/e-day-view.c: accept also text/calendar for D&D.

2003-10-23  JP Rosevear <jpr@ximian.com>

	* gui/e-day-view.c (e_day_view_on_top_canvas_drag_data_received):
	fix typo
	(e_day_view_on_main_canvas_drag_data_received): fix C99 issue, fix
	typo

2003-10-23  JP Rosevear <jpr@ximian.com>

	* gui/gnome-cal.c (update_query): use the internal client list to
	create the queries
	(gnome_calendar_destroy): use the internal client list to
	disconnect signal handlers
	(gnome_calendar_add_event_uri): add the client to the internal
	list
	(gnome_calendar_remove_event_uri): remove the client from the
	internal list and lookup the client
	(gnome_calendar_update_config_settings): use the internal client
	list to update the config settings

2003-10-23  Harry Lu  <harry.lu@sun.com>

	* cal-client/cal-client.c: (cal_client_get_timezone): remove and free
	op before return.

	* gui/e-cal-view.c (e_cal_view_add_event): modified from
	selection_received_add_event() so that it call be called out of
	e-cal-view.c.
	(selection_received): modified to call e_cal_view_add_event().

	* gui/e-cal-view.h: add declaration for e_cal_view_add_event().

	* gui/e-day-view.c (e_day_view_on_drag_data_get): Provide a
	icalcomponent for both TARGET_CALENDAR_EVENT and TARGET_VCALENDAR.
	(e_day_view_on_top_canvas_drag_data_received): If dragging between
	different windows, make it works like a copy and paste.
	(e_day_view_on_main_canvas_drag_data_received): ditto.

2003-10-23  JP Rosevear <jpr@ximian.com>

	* cal-util/cal-recur.c: update g_date calls to non-deprecated
	calls

	* cal-util/Makefile.am: turn off deprecated funcs

	* cal-client/Makefile.am: turn off deprecated funcs

	* cal-client/cal-client.c (cal_client_get_error_message): add OK
	message

	* pcs/cal-backend.[hc]: remove dead funcs

	* pcs/query.c: tidy headers

2003-10-23  JP Rosevear <jpr@ximian.com>

	* pcs/query.c (query_notify_objects_removed_1): Fix c/p typo -
	call removed instead of modify

2003-10-23  Rodrigo Moya <rodrigo@ximian.com>

	* gui/e-cal-view.c (e_cal_view_init): connect also to ETableModel's
	"model_cell_changed" signal.
	(e_cal_view_set_model): likewise.
	(model_cell_changed_cb): callback for "model_cell_changed".
	(e_cal_view_destroy): use g_signal_handlers_disconnect_matched instead
	of g_signal_handlers_disconnect_by_func, so that all handlers are
	disconnected.

2003-10-23  JP Rosevear <jpr@ximian.com>
 
 	* pcs/cal.c (cal_notify_object_modified): guard against irrelevant
 	args (ie if there was an error) 
 	(cal_notify_object_removed): ditto
 	(cal_notify_timezone_added): ditto
 
 	* pcs/cal-backend-sync.c (_cal_backend_is_read_only): init value
 	to something known
 	(_cal_backend_get_cal_address): ditto
 	(_cal_backend_get_alarm_email_address): ditto
 	(_cal_backend_get_ldap_attribute): ditto
 	(_cal_backend_get_static_capabilities): ditto
 	(_cal_backend_modify_object): ditto
 	(_cal_backend_remove_object): ditto
 	(_cal_backend_get_object_list): ditto
 
2003-10-22  JP Rosevear <jpr@ximian.com>
 
 	* gui/e-cal-list-view.c (e_cal_list_view_new): create a model and
 	pass it as an arg during creation
 
 	* gui/e-day-view.c (e_day_view_new): unref the model
 
 	* gui/e-week-view.c (e_week_view_new): ditto
	
2003-10-22  JP Rosevear <jpr@ximian.com>
 
 	* cal-client/cal-client.c (cal_client_get_object): only change to
 	invalid object error code if we got the object but couldn't parse
 	it, and only check for timezones if we had success
 
 	* gui/comp-util.c (cal_comp_is_on_server): don't throw a warning
 	if the object simply does not exist
	
2003-10-22  Rodrigo Moya <rodrigo@ximian.com>

	* gui/gnome-cal.[ch] (gnome_calendar_remove_event_uri): new
	function to remove calendars from the views.

2003-10-22  Ettore Perazzoli  <ettore@ximian.com>

	* gui/GNOME_Evolution_Calendar.server.in.in: Add an
	"evolution:button_icon" attribute.

2003-10-22  Ettore Perazzoli  <ettore@ximian.com>

	* gui/GNOME_Evolution_Calendar.server.in.in: Add an
	"evoution:button_sort_order" attribute.

2003-10-22  Ettore Perazzoli  <ettore@ximian.com>

	* gui/calendar-component.c (impl_createControls): Make the
	scrolled window have a GTK_SHADOW_IN shadow.
	* gui/dialogs/meeting-page.c (meeting_page_construct): Likewise.

2003-10-22  Ettore Perazzoli  <ettore@ximian.com>

	* gui/calendar-component.c (impl_createControls): Set the
	scrollbar policy to "automatic" for both the horizontal and
	vertical scrollbars around the source selector.

2003-10-22  Ettore Perazzoli  <ettore@ximian.com>

	* gui/GNOME_Evolution_Calendar.server.in.in: Add an
	"evolution:button_label" property on the component for use in the
	shell.

2003-10-21  Rodney Dawes  <dobey@ximian.com>

	* cal-client/Makefile.am: Fix typo in libcal_client_la_SOURCES
	
2003-10-21  Rodrigo Moya <rodrigo@ximian.com>

	* gui/calendar-component.c (calendar_component_init): fixed
	a leak caused by only freeing 'base_uri' in some cases.

2003-10-21  JP Rosevear <jpr@ximian.com>

	* gui/control-factory.c (get_prop): fix parse error
	(set_prop): gnome_calendar_open was renamed

	* conduits/todo/todo-conduit.c (start_calendar_server): adapt to
	the cal_client_new changes and the lack of a default calendar
	routine
	(pre_sync): don't have to pass a type for the default object any
	more

	* conduits/calendar/calendar-conduit.c (start_calendar_server):
	adapt to the cal_client_new changes and the lack of a default
	calendar routine
	(pre_sync): don't have to pass a type for the default object any
	more

	* cal-client/cal-client.c (cal_client_open_async): add FIXME
	comment

2003-10-21  Rodrigo Moya <rodrigo@ximian.com>

	* pcs/cal-backend-file.c: store recurrences per object.
	(free_object): free correctly the CalBackendFileObject's
	contained in 'priv->comp_uid_hash'.
	(lookup_component, check_dup_uid, add_component, remove_component,
	match_object_sexp):
	adapted to changes in comp_uid_hash.
	
2003-10-20  Rodrigo Moya <rodrigo@ximian.com>

	* gui/gnome-cal.[ch] (gnome_calendar_add_event_uri): renamed
	from gnome_calendar_open.

	* gui/calendar-component.c (load_uri_for_source): call
	gnome_calendar_add_event_uri instead of setting the URI property on
	the Bonobo control.

2003-10-17  Rodrigo Moya <rodrigo@ximian.com>

	* gui/migration.c (process_calendar_dir): process subfolders.

2003-10-17  Rodrigo Moya <rodrigo@ximian.com>

	* gui/migration.[ch] (migrate_old_calendars): new function.

	* gui/calendar-component.c (calendar_component_init): call
	the above function to migrate from old setups.

	* gui/Makefile.am: added new files.

2003-10-17  Jeffrey Stedfast <fejj@ximian.com>
	
	* conduits/calendar/Makefile.am: Fixed for libical build changes.

	* conduits/todo/Makefile.am: Same.

2003-10-17  Rodrigo Moya <rodrigo@ximian.com>

	* gui/e-cal-view.c (on_print): call
	e_cal_view_get_visible_time_range, not the gnome_calendar_
	version.
	(e_cal_view_new_appointment_for, e_cal_view_new_appointment,
	e_cal_view_edit_appointment): new functions.

	* gui/gnome-cal.[ch] (gnome_calendar_new_appointment_for,
	gnome_calendar_new_appointment, gnome_calendar_edit_object):
	removed these functions, now available in e-cal-view.

	* gui/calendar-commands.c:
	* gui/e-day-view.c:
	* gui/e-week-view-event-item.c:
	* gui/e-week-view.c: replaced calls to gnome_calendar_* with
	e_cal_view_* equivalents.

2003-10-17  Rodrigo Moya <rodrigo@ximian.com>

	* gui/e-cal-view.[ch] (e_cal_view_get_default_category):
	(e_cal_view_set_default_category): new functions.
	(e_cal_view_destroy): free the default_category field.

	* gui/e-day-view.[ch] (e_day_view_set_default_category):
	removed obsolete function.
	(e_day_view_init, e_day_view_destroy, e_day_view_do_key_press):
	use the ECalView's default_category.

	* gui/e-week-view.[ch] (e_week_view_set_default_category):
	removed obsolete function.
	(e_week_view_init, e_week_view_destroy, e_week_view_do_key_press):
	use the ECalView's default_category.

	* gui/gnome-cal.c (gnome_calendar_set_query): set the query
	also on the list view by using the priv->views array.
	(search_bar_category_changed_cb, gnome_calendar_set_default_client):
	use the priv->views array.
	(gnome_calendar_get_calendar_model): return the model for the
	current view widget.
	(gnome_calendar_open): removed tasks opening code.

2003-10-16  Rodrigo Moya <rodrigo@ximian.com>

	* gui/dialogs/new-calendar.c (new_calendar_dialog): if the user
	presses Cancel, just terminate.

2003-10-16  Rodrigo Moya <rodrigo@ximian.com>

	* gui/calendar-component.c (calendar_component_init): create
	directories for the newly-created calendars.

	* gui/dialogs/new-calendar.c (create_new_source_with_group): use
	e_mkdir_hier instead of mkdir.

2003-10-16  Rodrigo Moya <rodrigo@ximian.com>

	* gui/calendar-component.c (calendar_component_init): if no groups
	are present in the configuration, create the "On This Computer"
	group and the "Personal" and "Work" calendars on it.

	* gui/dialogs/new-calendar.c (new_calendar_dialog): moved the
	source creation...
	(create_new_source_with_group): ...here, and made the code create
	the directory for the new calendar.

2003-10-15  Hans Petter Jansson  <hpj@ximian.com>

	* gui/e-select-names-editable.c (e_selct_names_editable_get_address):
	EDestination -> EABDestination.

	* gui/gnome-cal.c (setup_widgets): evolution_dir -> ".evolution".

2003-10-15  Rodrigo Moya <rodrigo@ximian.com>

	* gui/e-select-names-editable.c (e_select_names_editable_get_address):
	use EABDestination instead of EDestination.

	* gui/gnome-cal.c (gnome_calendar_open): disabled tasks opening code.

2003-10-15  Rodrigo Moya <rodrigo@ximian.com>

	* gui/e-meeting-list-view.c: adapted to new addressbook API.

	* gui/e-meeting-store.c: adapted to new addressbook API.
	(find_zone): fixed usage of icalcomponent where an icalproperty
	is expected.
	(refresh_busy_periods): fixed call to cal_client_get_free_busy().

	* gui/e-meeting-time-sel.c (e_meeting_time_selector_construct):
	added missing variable.
	
2003-10-15  Jeffrey Stedfast  <fejj@ximian.com>

	* gui/dialogs/meeting-page.c: #include <gal/e-table/e-table.h>

2003-10-15  Rodrigo Moya <rodrigo@ximian.com>

	* gui/e-meeting-list-view.c (start_addressbook_server):
	updated to new addressbook API.
	(book_open_cb): removed unneeded function, since we load
	the local addressbook synchronously.

2003-10-15  Rodrigo Moya <rodrigo@ximian.com>

	* pcs/Makefile.am: added missing header directories.

	* pcs/cal-factory.h: include <libical/ical.h>, not <ical.h>.

	* gui/dialogs/meeting-page.c: added missing headers.
	(meeting_page_construct): free 'backend_address' as returned
	by cal_client_get_cal_address(). Removed code to create the
	meeting model's ETable not removed with the merge.

	* gui/e-meeting-list-view.c: updated addressbook headers.

	* gui/gnome-cal.h: added missing ',' in the GnomeCalendarViewType
	enum.
	
2003-10-14  Rodrigo Moya <rodrigo@ximian.com>

	* gui/e-day-view.c (e_day_view_update_query): dont set status
	messages here, already set in e_cal_view_update_query.
	(update_query): removed this function.
	(e_day_view_recalc_day_starts): call e_day_view_update_query,
	not update_query.

	* gui/e-week-view.c (e_week_view_update_query): dont set status
	messages here, already set in e_cal_view_update_query.

	* gui/gnome-cal.c (adjust_query_for_view): new function to adjust
	the query for the visible time range on a given view.
	(gnome_calendar_set_query): call adjust_query_for_view for each
	one of the views.

2003-10-14  Rodrigo Moya <rodrigo@ximian.com>

	* gui/e-cal-view.c (e_cal_view_init): connect to signals on the
	model we create here, so that we get notifications for changes.

	* gui/gnome-cal.c (gnome_calendar_set_query): set the query
	on all models.
	(gnome_calendar_open): update the date navigator query.

2003-10-14  Rodrigo Moya <rodrigo@ximian.com>

	* pcs/cal.c (cal_notify_timezone_requested): never send NULL
	strings to ORBit.

	* gui/e-cal-view.c (e_cal_view_create_popup_menu): removed
	unneeded variables. Also, fixed a typo that was making the
	menu options be disabled when they should be enabled.

2003-10-13  Rodrigo Moya <rodrigo@ximian.com>

	* gui/e-cal-model.[ch] (e_cal_model_get_client_for_uri): new function.

	* gui/gnome-cal.[ch] (gnome_calendar_set_default_client): new function.

	* gui/calendar-component.c (primary_source_selection_changed_callback):
	set the default client on the calendar view to be the primary
	selection on the source list.

2003-10-13  Rodrigo Moya <rodrigo@ximian.com>

	* gui/dialogs/new-calendar.c (new_calendar_dialog): set a default group
	on the calendar group option menu and create the source if all checks
	are passed.

2003-10-12  Rodrigo Moya <rodrigo@ximian.com>

	* gui/dialogs/new-calendar.c (new_calendar_dialog): set up widgets
	loaded from the Glade file.

2003-10-10  Hans Petter Jansson  <hpj@ximian.com>

	* gui/Makefile.am (etspec_DATA): Add e-cal-list-view.etspec.
	(libevolution_calendar_la_SOURCES): Add e-cal-list-view.[ch].

	* gui/calendar-commands.c (show_list_view_clicked): Implement.
	(calendar_get_text_for_folder_bar_label): Add case for list view.
	Use month case and tweak it so it doesn't show "%d - %d" if the
	time span contains only one day.
	(verbs): Add list view.
	(pixmaps): Add list view.

	* gui/calendar-view-factory.c (calendar_view_factory_get_title):
	Add list view case.
	(calendar_view_factory_get_type_code): Add list view case.

	* gui/control-factory.c (get_prop): Add list view case.

	* gui/e-cal-model.c (get_classification): Fix to conform to updated
	libical.
	(ecm_set_value_at): Add missing break statements.
	(ecm_get_color_for_component): Add braces for clarity.

	* gui/gnome-cal.c (gnome_calendar_get_current_view_widget): Add
	list view case.
	(get_focus_location): Add list view case.
	(connect_list_view_focus): Implement.
	(setup_widgets): Set up list view.
	(gnome_calendar_direction): Add list view case.
	(set_view): Add list view case.
	(gnome_calendar_setup_view_menus): Add list view factory.
	(gnome_calendar_construct): Account for list view.
	(gnome_calendar_update_config_settings): Account for list view.
	(get_days_shown): Implement list view case.

	* gui/gnome-cal.h (GnomeCalendarViewType): Add list view.

	* gui/e-cal-list-view.[ch]: Implement ECalListView, subclassing
	ECalView.

2003-10-10  Rodrigo Moya <rodrigo@ximian.com>

	* gui/dialogs/new-calendar.[ch]: added new widget, which implements
	the dialog to create new calendars.

	* gui/dialogs/new-calendar.glade: basic mockup of the dialog.

	* gui/dialogs/Makefile.am: added new files.

	* gui/calendar-commands.c (file_new_calendar_cb): open the new calendar
	dialog to allow user to create a new cal.

2003-10-10  Rodrigo Moya <rodrigo@ximian.com>

	* gui/control-factory.c (calendar_properties_init): pass the
	BonoboControl to get_prop/set_prop.
	(get_prop): obtain the GnomeCalendar from the control.
	(set_prop): ditto, and when the URI property is changed,
	sensitize the UI as approppriate.

	* gui/calendar-commands.c (calendar_control_sensitize_calendar_commands):
	made this function public.

	* gui/calendar-commands.h: added new prototype.

2003-10-10  Rodrigo Moya <rodrigo@ximian.com>

	* gui/calendar-commands.c (file_new_calendar_cb,
	file_new_appointment_cb, file_new_event_cb, file_new_meeting_cb,
	file_new_task_cb): callbacks for "New..." verbs.
	(sensitize_calendar_commands): sensitize new verbs, and made it
	sensitize correctly based on the set of clients currently loaded.
	(sensitize_taskpad_commands): likewise.

2003-10-09  Hans Petter Jansson  <hpj@ximian.com>

	* gui/e-cal-model.c (get_classification): Adapt to libical API changes.
	(ecm_set_value_at): Break after each case, so we don't set the passed value
	in more than one field.

2003-10-09  Rodrigo Moya <rodrigo@ximian.com>

	* gui/e-cal-view.c (e_cal_view_delete_selected_occurrence):
	* cal-client/cal-client.c (cal_client_remove_object): added missing
	argument when calling cal_client_remove_object_with_mod().

2003-10-09  Rodrigo Moya <rodrigo@ximian.com>

	* idl/evolution-calendar.idl: added missing 'rid' argument to the
	removeObject method.

	* cal-client/cal-client.c (cal_client_remove_object_with_mod):
	* pcs/cal-backend.h:
	* pcs/cal-backend.c (cal_backend_remove_object):
	* pcs/cal-backend-sync.h:
	* pcs/cal-backend-sync.c (cal_backend_sync_remove_object,
	_cal_backend_remove_object):
	* pcs/cal-backend-file.c (cal_backend_file_remove_object):
	* pcs/cal.c (impl_cal_removeObject): adapted to changes in IDL.

2003-10-09  Jeffrey Stedfast  <fejj@ximian.com>

	* cal-client/Makefile.am: INCLUDE path fixes for changes made to
	libical build.

	* cal-util/Makefile.am: INCLUDE path fixes for changes made to
	libical build.

	* cal-util/*.[c,h]: #include <libical/ical.h> instead of <ical.h>

	* gui/Makefile.am: INCLUDE path fixes for changes made to libical
	build.

	* gui/*.[c,h]: #include <libical/ical.h> instead of <ical.h>

	* gui/alarm-notify/Makefile.am: INCLUDE path fixes for changes
	made to libical build.

	* gui/alarm-notify/config-data.h: #include <libical/ical.h>
	instead of <ical.h>

	* gui/dialogs/Makefile.am: INCLUDE path fixes for changes made to
	libical build.

	* gui/dialogs/comp-editor-util.c: #include <libical/ical.h>
	instead of <ical.h>

	* gui/dialogs/e-delegate-dialog.c: #include <libical/ical.h>
	instead of <ical.h>

	* importers/Makefile.am: INCLUDE path fixes for changes made to
	libical build.

	* pcs/Makefile.am: INCLUDE path fixes for changes made to libical
	build.

	* pcs/cal.c: #include <libical/ical.h> instead of <ical.h>

2003-10-08  Harry Lu  <harry.lu@sun.com>

	* gui/dialogs/alarm-options.glade: Make repeat-quantity and
	repeat-value of alarm option dialog numeric only.

	* gui/dialogs/task-details-page.glade: Make percent-complete of
	task details dialog numeric only.

2003-10-08  Chris Toshok  <toshok@ximian.com>

	* gui/dialogs/e-delegate-dialog.c (e_delegate_dialog_construct):
	EDestination => EABDestination, and e_destination =>
	eab_destination.
	(e_delegate_dialog_get_delegate): same.
	(e_delegate_dialog_get_delegate_name): same.

	* gui/dialogs/comp-editor-util.c: remove unnecessary #include of
	e-destination.h.

	* gui/dialogs/alarm-options.c (alarm_to_malarm_widgets):
	EDestination => EABDestination, and e_destination =>
	eab_destination.
	(malarm_widgets_to_alarm): same.

	* gui/e-meeting-model.c (book_open_cb): track change to error
	return codes.
	(start_addressbook_server): use
	e_book_async_get_default_addressbook.
	(contacts_cb): rename cursor_cb to this, as we no longer get
	passed a cursur, and we don't need to check the email address
	since the query is now "is" instead of "contains".
	(refresh_busy_periods): use an "is" query, and use
	e_book_async_get_contacts instead of getting a CardCursor.
	(process_section): this takes an EABDestination** instead of a
	SimpleCardList*, which is gone.
	(select_names_ok_cb): get "destinations" instead of
	"simple_card_list".

2003-10-08  Rodrigo Moya <rodrigo@ximian.com>

	* cal-client/cal-client.c (cal_client_is_read_only): fixed
	documentation comments.

	* gui/calendar-commands.c (sensitize_calendar_commands): figure
	out read-only menu items to disable based on the currently
	selected object's CalClient.

2003-10-08  Rodrigo Moya <rodrigo@ximian.com>

	* cal-client/cal-client.c: set better error m,essages on the
	E_CALENDAR_CHECK_STATUS macro.
	(cal_client_get_error_message): new function.

	* cal-client/cal-client.h: added new prototype.

	* gui/dialogs/comp-editor.c (save_comp): use the GError argument
	for the cal_client_create/_modify_object calls, and display the
	error message coming from the backend.

	* gui/comp-util.c (cal_comp_is_on_server): likewise.

2003-10-07  Dan Winship  <danw@ximian.com>

	* idl/evolution-calendar.idl (getDefaultObject): Remove the "type"
	arg; the backend knows what type it is

	* pcs/cal.c (impl_Cal_getDefaultObject): Likewise

	* pcs/cal-backend.c (cal_backend_get_default_object): Likewise

	* pcs/cal-backend-sync.c (cal_backend_sync_get_default_object,
	_cal_backend_get_default_object): Likewise

	* pcs/cal-backend-file.c (cal_backend_file_get_default_object):
	Likewise. (Use cal_backend_get_kind() instead.)

	* cal-client/cal-client.c (cal_client_get_default_object):
	Likewise

	* gui/comp-util.c (cal_comp_event_new_with_defaults,
	cal_comp_task_new_with_defaults): Update calls to
	cal_client_get_default_object().

	* pcs/cal-backend-sync.c (_cal_backend_get_static_capabilities):
	Use the right cal notification

2003-10-07  Rodrigo Moya <rodrigo@ximian.com>

	* gui/e-cal-model.c (e_cal_model_create_component_with_defaults):
	dont clone NULL icalcomponent's.

2003-10-07  Rodrigo Moya <rodrigo@ximian.com>

	* gui/e-cal-model.c (e_cal_model_get_default_client): make sure we
	always return a default client, if possible, since we rely on having
	a default client in many places.

	* gui/e-day-view.c (e_day_view_do_key_press): dont create event if
	e_cal_model_create_component_with_defaults returns NULL.

	* gui/e-week-view.c (e_week_view_do_key_press): dont create event if
	e_cal_model_create_component_with_defaults returns NULL.
	
2003-10-06  Rodrigo Moya <rodrigo@ximian.com>

	* gui/e-cal-model.c (e_cal_model_create_component_with_defaults):
	make sure the component has always an UID.

	* gui/e-day-view.c  (e_day_view_find_event_from_uid):
	* gui/e-week-view.c (e_week_view_find_event_from_uid): check
	pointers passed to strcmp().

2003-10-06  Rodrigo Moya <rodrigo@ximian.com>

	* gui/gnome-cal.c (gnome_calendar_open): added missing call to
	cal_client_open().

	* cal-client/cal-client.c (cal_client_new): fixed documentation
	comments.
	(cal_client_open): emit CAL_OPENED signal with appropriate status codes.
	(open_sync): dont emit CAL_OPENED signal, it's already emitted in
	cal_client_open().

2003-10-06  Rodrigo Moya <rodrigo@ximian.com>

	* gui/comp-editor-factory.c (open_client):
	* gui/gnome-cal.c (gnome_calendar_open, gnome_calendar_construct):
	* gui/calendar-offline-handler.c (backend_go_offline, backend_go_online,
	calendar_offline_handler_init): adapted to changes in cal_client and
	manage GError's returned by cal_client_open.

	* gui/e-itip-control.c: dont run anymore sub event loops.
	(start_calendar_server): use synchronous interface for opening calendars.
	(start_default_server): renamed it from *_async.
	(start_calendar_server_cb): removed unneeded function.
	(object_requested_cb): use sync interface.

	* gui/e-tasks.c (e_tasks_construct): dont create the CalClient here.
	(e_tasks_open): do it here, where we've got all the info needed.

	* importers/icalendar-importer.c (update_single_object): killed warning.
	(ical_importer_new, vcal_importer_new): don't create CalClient's here.
	(load_file_fn): create them here.
	(vcal_load_file_fn): and here.
	(gnome_calendar_import_data_fn): fixed usage of cal_client_*.

	* */*: integrated JP's changes for synchronous open's in cal_client
	and one model per view instead of one model for all views.
	
2003-10-02  Rodrigo Moya <rodrigo@ximian.com>

	* cal-client/cal-client.c (cal_client_modify_object): return FALSE
	if the icalcomponent is NULL.

	* gui/e-day-view.c (e_day_view_finish_resize): commit sequence on
	CalComponent after changing start/end dates.

2003-10-01  Rodrigo Moya <rodrigo@ximian.com>

	* gui/e-day-view.c (process_component):
	* gui/e-week-view.c (process_component): expand recurrences here.

2003-09-30  Rodrigo Moya <rodrigo@ximian.com>

	* pcs/cal-backend-file.c (match_recurrence_sexp): removed.
	(match_object_sexp): dont expand recurrences here.

2003-09-30  Mike Kestner <mkestner@ximian.com>

	* cal-util/cal-util-marshal.list : new VOID:STRING,STRING,STRING
	* gui/Makefile.am : build the new view/store/renderer/editable
	* gui/e-select-names-renderer.* : new completion cell renderer
	* gui/e-select-names-editable.* : new completion cell editable
	* gui/e-meeting-model.* : killed. code reused in list-view/store
	* gui/e-meeting-store.* : port of EMeetingModel to GtkTreeModel
	* gui/e-meeting-list-view.* : GtkTreeView subclass for attendee lists
	* gui/e-meeting-time-sel.c : Use the new store/view
	* gui/e-meeting-time-sel-item.c : Use the new store/view
	* gui/dialogs/Makefile.am : don't install the etspec anymore.
	* gui/dialogs/event-editor.c : Use the new store/view.
	* gui/dialogs/meeting-page.c : Use the new store/view.
	* gui/dialogs/shedule-page.c : Use the new store/view.
	* gui/dialogs/task-editor.c : Use the new store/view.

2003-09-29  JP Rosevear <jpr@ximian.com>

	* conduits/todo/Makefile.am: link to libical-evolution

	* conduits/calendar/Makefile.am: ditto	
	
2003-09-26  JP Rosevear <jpr@ximian.com>

	* pcs/cal-backend.c (cal_backend_class_init): remove cal_added
	signal

2003-09-26  JP Rosevear <jpr@ximian.com>

	* pcs/cal.h: add protos

	* pcs/cal.c (cal_get_backend): accessor
	(cal_get_listener): ditto

	* pcs/cal-factory.c (impl_CalFactory_getCal): update to new
	routine name

	* pcs/cal-backend.h: add protos
	
	* pcs/cal-backend.c (cal_backend_init): init client mutex
	(cal_backend_finalize): destroy client mutex
	(cal_destroy_cb): just remove the client
	(listener_died_cb): remove the client, the listener died so it
	can't really do anything
	(last_client_gone): signal the last client gone
	(cal_backend_add_client): add a client with locking and listen for
	the death of the listener
	(cal_backend_remove_client): remove client

2003-09-26  Rodrigo Moya <rodrigo@ximian.com>

	* pcs/cal-backend-sync.c (_cal_backend_create_object): only free the
	returned UID if it's not NULL.

	* pcs/cal.c (cal_notify_object_created): dont send NULL strings to
	ORBit code.

2003-09-26  Rodrigo Moya <rodrigo@ximian.com>

	* gui/comp-util.c (cal_comp_is_on_server): free the icalcomponent
	returned from cal_client_get_object, and return TRUE if we find
	the component on the backend.

	* gui/e-day-view.c (process_component):
	* gui/e-week-view.c (process_component): added missing case, so that
	we also display recurrent meetings starting before the time range and
	ending after the time range.

	* cal-client/cal-listener.c (impl_notifyReadOnly): pass the
	'read_only' argument to the signal callback correctly (a gboolean
	not a 'gboolean *').

	* gui/comp-editor-factory.c (resolve_pending_requests): removed
	the g_assert on 'oc->pending != NULL', since there are now cases
	(local calendar) where we get to call this function (cal_opened_cb)
	with no pending requests yet.

2003-09-25  JP Rosevear <jpr@ximian.com>

	* gui/calendar-commands.c (publish_freebusy_cmd): adapt to new
	get_free_busy api

	* conduits/calendar/calendar-conduit.c (post_sync): ditto
	(pre_sync): ditto

	* conduits/todo/todo-conduit.c (pre_sync): ditto
	(post_sync): ditto

	* gui/e-meeting-model.c (refresh_busy_periods): ditto

	* gui/e-itip-control.c (send_freebusy): ditto

	* gui/e-cal-view.c (on_publish): ditto

	* cal-client/cal-listener.h: add signals

	* cal-client/cal-listener.c (build_change_list): move here from
	cal-client.c
	(impl_notifyChanges): implement
	(build_free_busy_list): util to create the GList of free busy
	objects
	(impl_notifyFreeBusy): implement
	(cal_listener_class_init): set free busy and changes epv methods,
	add signals

	* cal-client/cal-client.h: update protos

	* cal-client/cal-client.c (cal_get_changes_cb): get changes call
	back
	(cal_get_free_busy_cb): get free busy call back
	(cal_client_init): listen for free busy and changes signals
	(cal_client_get_changes): convert to new threaded sync api
	(cal_client_get_free_busy): ditto

	* pcs/cal.h: add protos

	* pcs/cal.c: remove dead type conversion function
	(impl_Cal_getChanges): implement by just calling, no return stuff
	(impl_Cal_getFreeBusy): ditto
	(cal_notify_changes): do getChanges callback
	(cal_notify_free_busy): do getFreeBusy callback

	* pcs/cal-backend.h: update protos, vmethods
	
	* pcs/cal-backend.c (cal_backend_get_free_busy): call through
	(cal_backend_get_changes): ditto

	* pcs/cal-backend-sync.h: add vmethods, protos

	* pcs/cal-backend-sync.c (cal_backend_sync_get_changes): call
	through
	(cal_backend_sync_get_free_busy): ditto
	(_cal_backend_get_changes): backend implementation, notify
	(_cal_backend_get_free_busy): ditto
	(cal_backend_sync_class_init): set free busy and changes
	implementations

	* pcs/cal-backend-file.c (cal_backend_file_get_free_busy): convert
	to sync backend method
	(cal_backend_file_compute_changes_foreach_key): remove from the
	hash here
	(cal_backend_file_compute_changes): no need to build the sequence
	here
	(cal_backend_file_get_changes): convert to sync backend method
	(cal_backend_file_class_init): set sync backend methods for free
	busy and changes

	* idl/evolution-calendar.idl: convert getChanges and getFreeBusy
	to new async api

2003-09-25  JP Rosevear  <jpr@ximian.com>

	* pcs/cal-backend.h: remove dead result enums

	* pcs/cal-backend.c: fix comments

	* idl/evolution-calendar.idl: remove dead exceptions

2003-09-25  JP Rosevear <jpr@ximian.com>

	* pcs/cal.c (cal_notify_default_object): send back the empty
	string if the object is NULL
	(cal_notify_object): ditto

2003-09-25  JP Rosevear <jpr@ximian.com>

	* gui/comp-editor-factory.c (edit_existing): convert to api
	changes

	* conduits/todo/todo-conduit.c (local_record_from_uid): ditto
	(pre_sync): ditto

	* conduits/calendar/calendar-conduit.c (local_record_from_uid):
	ditto
	(pre_sync): ditto

	* importers/icalendar-importer.c (update_single_object): ditto

	* gui/dialogs/comp-editor.c (obj_updated_cb): ditto

	* gui/e-itip-control.c (get_real_item): ditto
	(find_server): ditto

	* gui/comp-util.c (cal_comp_is_on_server): ditto
	(cal_comp_event_new_with_defaults): ditto
	(cal_comp_task_new_with_defaults): ditto

	* cal-client/cal-listener.h: add signals

	* cal-client/cal-listener.c (impl_notifyDefaultObjectRequested):
	implement
	(impl_notifyObjectRequested): ditto
	(cal_listener_class_init): set above epv implementations, add signals

	* cal-client/cal-client.h: update protos

	* cal-client/cal-client.c (cal_default_object_requested_cb): get
	default object callback
	(cal_object_requested_cb): get object callback
	(cal_client_init): listen for get and get default object signals
	(cal_client_get_default_object): convert to new sync api
	(cal_client_get_object): ditto

	* pcs/cal.h: add protos

	* pcs/cal.c (impl_Cal_getDefaultObject): just call the backend, it
	does the notification now
	(impl_Cal_getObject): ditto
	(cal_notify_default_object): do getDefaultObject response
	(cal_notify_object): do getObject response

	* pcs/cal-backend.h: remove vmethods, protos

	* pcs/cal-backend.c: remove a couple of dead functions
	(cal_backend_class_init): get_object_component is no longer a
	vmethod
	(cal_backend_get_default_object): call through
	(cal_backend_get_object): ditto

	* pcs/cal-backend-sync.h: add protos, vmethods

	* pcs/cal-backend-sync.c (cal_backend_sync_get_default_object):
	call through
	(cal_backend_sync_get_object): ditto
	(_cal_backend_discard_alarm): pass correct params to
	cal_notify_discard_alarm
	(_cal_backend_get_default_object): call through and notify
	(_cal_backend_get_object): ditto
	(cal_backend_sync_class_init): set backend implementations

	* pcs/cal-backend-file.c (cal_backend_file_get_default_object):
	convert to sync backend method
	(cal_backend_file_get_object): ditto
	(cal_backend_file_compute_changes_foreach_key): just look up the
	component rather than using the backend vmethod
	(cal_backend_file_remove_object): return valid sync status codes
	(cal_backend_file_class_init): move get_object, get_default_object
	to sync class

	* idl/evolution-calendar.idl: convert getObject and
	getDefaultObject to new async idl

2003-09-25  JP Rosevear  <jpr@ximian.com>

	* pcs/cal.c (impl_Cal_discardAlarm): just call the backend
	function, it does the notification
	(cal_notify_alarm_discarded): notify of discard alarm call

	* pcs/cal-backend.h: update proto

	* pcs/cal-backend.c (cal_backend_discard_alarm): call through

	* pcs/cal-backend-sync.h: add proto, vmethod

	* pcs/cal-backend-sync.c (cal_backend_sync_discard_alarm): call
	through
	(_cal_backend_discard_alarm): call through and notify
	(cal_backend_sync_class_init): set discard alarm implementation

	* pcs/cal-backend-file.c (cal_backend_file_discard_alarm): match
	sync backend vmethod
	(cal_backend_file_class_init): set alarm vmethod implementation

	* idl/evolution-calendar.idl: switch discardAlarm to new api

	* gui/alarm-notify/alarm-queue.c (remove_queued_alarm): match new
	api

	* cal-client/cal-listener.h: add signal

	* cal-client/cal-listener.c (impl_notifyAlarmDiscarded): implement
	(cal_listener_class_init): add alarm, send, receive epv functions,
	alarm signal

	* cal-client/cal-client.h: update proto

	* cal-client/cal-client.c (cal_alarm_discarded_cb): discardAlarm
	callback
	(cal_client_init): listen to discard alarm signal
	(cal_client_discard_alarm): implement with new threaded sync api

2003-09-25  JP Rosevear <jpr@ximian.com>

	* idl/evolution-calendar.idl: remove unused user exceptions

2003-09-24  Rodrigo Moya <rodrigo@ximian.com>

	* pcs/cal-backend-util.[ch] (cal_backend_util_fill_alarm_instances_seq):
	removed unneeded function.

2003-09-24  JP Rosevear  <jpr@ximian.com>

	* conduits/*/*.c: adjust to new timezone api calls

	* gui/*.c: ditto

	* gui/dialogs/*.c: ditto

	* cal-client/cal-listener.h: add new signals

	* cal-client/cal-listener.c (convert_status): convert invalid
	object as well
	(impl_notifyTimezoneRequested): implement
	(impl_notifyDefaultTimezoneSet): ditto
	(cal_listener_class_init): set epv implementations for timezone
	functions
	(cal_listener_class_init): create timezone response signals

	* cal-client/cal-client.h: update protos

	* cal-client/cal-client.c: fix return values all over the place
	(cal_get_timezone_cb): getTimezone response
	(cal_query_cb): setDefaultTimezone response
	(cal_client_init): listen for new response signals
	(cal_client_get_timezone): implement using new thread sync api
	(cal_client_ensure_timezone_on_server): use add timezone call
	(cal_client_set_default_timezone): oimplement using new thread sync
	api

	* cal-client/cal-client-types.h: add invalid object status code

	* idl/evolution-calendar.idl: getQuery no longer raises any user
	exceptions, remove dead types and exceptions

2003-09-24  JP Rosevear <jpr@ximian.com>

	* pcs/cal.h: new protos

	* pcs/cal.c (impl_Cal_getTimezone): call backend implementation
	(impl_Cal_addTimezone): ditto
	(impl_Cal_setDefaultTimezone): ditto
	(cal_class_init): set epv implementations of timezone functions
	(cal_notify_timezone_requested): notify of get timezone response
	(cal_notify_default_timezone_set): notify of default timezone
	being set

	* pcs/cal-backend.h: new vmethods, protos

	* pcs/cal-backend.c (cal_backend_class_init): init new timezone
	vmethods
	(cal_backend_get_timezone): call through
	(cal_backend_set_default_timezone): ditto
	(cal_backend_add_timezone): ditto
	(cal_backend_internal_get_default_timezone): ditto
	(cal_backend_internal_get_timezone): ditto

	* pcs/cal-backend-sync.h: add vmethods, protos

	* pcs/cal-backend-sync.c (cal_backend_sync_get_timezone): call
	through
	(cal_backend_sync_set_default_timezone): ditto
	(_cal_backend_set_default_timezone): call through and notify
	(_cal_backend_get_timezone): ditto
	(cal_backend_sync_class_init): set backend implementations for new
	funcs

	* pcs/cal-backend-object-sexp.c (func_occur_in_time_range): get
	time_t values based on the zone

	* pcs/cal-backend-file.c: reorg so we don't have to prototype
	everything
	(cal_backend_file_get_timezone): implement the sync backend way
	(cal_backend_file_add_timezone): ditto
	(cal_backend_file_set_default_timezone): ditto
	(cal_backend_file_internal_get_default_timezone): internal method,
	for sexp comparison
	(cal_backend_file_internal_get_timezone): ditto

	* idl/evolution-calendar.idl: convert timezone routines to async
	api

2003-09-23  Rodrigo Moya <rodrigo@ximian.com>

	* pcs/cal-backend-object-sexp.c (func_occur_in_time_range): dont expand
	recurrences, since they are supposed to be expanded in the backends.
	(instance_occur_cb, resolve_tzid): removed unneeded functions.

	* pcs/cal-backend-file.c (cal_backend_file_add_timezone): guard against
	adding the timezone if it's already there.

2003-09-23  JP Rosevear <jpr@ximian.com>

	* pcs/cal.c (cal_notify_object_created): notify with the object,
	not the uid

	* gui/e-cal-model.c (add_new_client): don't listen for
	non-existent signal

2003-09-23  JP Rosevear <jpr@ximian.com>

	* cal-client/cal-client.h: remove dead proto

2003-09-23  JP Rosevear <jpr@ximian.com>

	* cal-client/cal-client.h: remove send result enum

	* gui/itip-utils.c (comp_server_send): use the new send_objects
	routine

2003-09-23  JP Rosevear <jpr@ximian.com>

	* cal-client/cal-client.h: remove send result enum

2003-09-23  JP Rosevear <jpr@ximian.com>

	* cal-client/cal-client.h: remove enum, protos

	* cal-client/cal-client.c: remove remove status enum typing

2003-09-23  Rodrigo Moya <rodrigo@ximian.com>

	* importers/icalendar-importer.c (update_objects): new function
	to manage the update of components, taking into account
	VTIMEZONE components.
	(process_item_fn, gnome_calendar_import_data_fn): use
	update_objects instead of cal_client_update_objects.

2003-09-23  JP Rosevear <jpr@ximian.com>

	* pcs/cal.h: update proto

	* pcs/cal.c (impl_Cal_addTimezone): just call add_timezone, it
	does the notification
	(cal_notify_object_created): only notify the query if the object
	matches
	(cal_notify_object_removed): ditto

	* pcs/cal-backend.h: update proto, vmethod

	* pcs/cal-backend.c (cal_backend_add_timezone): returns void

	* pcs/cal-backend-sync.h: update proto, vmethod

	* pcs/cal-backend-sync.c (cal_backend_sync_remove_object): add the
	object as an out param
	(_cal_backend_remove_object): get the object and pass it in the
	notification

	* pcs/cal-backend-file.c (cal_backend_file_create_object): kill
	cal_backend_file_update_objects call, its more efficient to create
	the comp ourselves; stamp the creation time, add the component to
	the toplevel
	(cal_backend_file_modify_object): kill the
	cal_backend_file_update_objects call, add the component to the
	toplevel
	(cal_backend_file_remove_object): pass back the object when
	removing

2003-09-23  JP Rosevear  <jpr@ximian.com>

	* cal-client/cal-query.c (cal_query_finalize): disconnect the
	signal handlers

	* cal-client/cal-client.c (cal_client_get_query): unref the
	listener when done

2003-09-23  Rodrigo Moya <rodrigo@ximian.com>

	* gui/e-cal-view.c (selection_received): add VTIMEZONE components
	contained in the clipboard data to the backend.

2003-09-22  JP Rosevear <jpr@ximian.com>

	* gui/dialogs/comp-editor.c (save_comp): modify and create instead
	of update, simplify mod code

2003-09-22  JP Rosevear <jpr@ximian.com>

	* gui/e-day-view.c (e_day_view_finish_long_event_resize): modify
	the object instead of update, simplify the instance handling
	(e_day_view_finish_resize): ditto
	(e_day_view_on_top_canvas_drag_data_received): ditto
	(e_day_view_on_main_canvas_drag_data_received): ditto

2003-09-22  Rodrigo Moya <rodrigo@ximian.com>

	* cal-client/cal-client.c (cal_client_get_alarms_in_range): use
	'has-alarms' function in the search expression.

	* pcs/cal-backend-object-sexp.c (func_has_alarms): new SExp function.

2003-09-22  JP Rosevear <jpr@ximian.com>

	* gui/e-day-view.c (e_day_view_on_editing_stopped): create the
	object if its not on the server or modify it if it is

	* gui/e-week-view.c (e_week_view_on_editing_stopped): we return if
	there is no text and it *not* on the server

2003-09-22  JP Rosevear <jpr@ximian.com>

	* gui/e-week-view.c (e_week_view_on_editing_stopped): create the
	object if its not on the server or modify it if it is

2003-09-22  JP Rosevear <jpr@ximian.com>

	* gui/gnome-cal.h: remove proto

	* gui/gnome-cal.c: remove gnome_calendar_unrecur_selection

	* gui/e-week-view.h: remove proto

	* gui/e-week-view.c: remove e_week_view_unrecur_appointment

	* gui/e-day-view.h: remove proto

	* gui/e-day-view.c: remove e_day_view_unrecur_appointment

	* gui/e-cal-view.c: remove on_unrecur_appointment (this is handled
	better via recurrence id's now)

2003-09-22  JP Rosevear <jpr@ximian.com>

	* gui/e-itip-control.c (update_attendee_status): ifdef out, leave
	temporarily for reference, but otherwise it shouldn't be needed
	(update_item): switch to using receive objects
	(ok_clicked_cb): update item when receiving a reply

	* gui/e-calendar-table.c (selection_received): switch to using
	create object from update_objects

	* gui/e-cal-view.c (selection_received_add_event): util routine to
	prevent duplication
	(selection_received): use above

	* gui/e-cal-model.c (ecm_set_value_at): switch to using modify
	object from update_objects
	(ecm_append_row): switch to using create object from
	update_objects

	* gui/e-cal-model-calendar.c (ecmc_set_value_at): switch to using
	modify object from update_objects

	* gui/e-cal-model-tasks.c (ecmt_set_value_at): ditto

2003-09-22  Hans Petter Jansson  <hpj@ximian.com>

	* cal-util/Makefile.am (libical_util_la_LIBADD):
	libical.la -> libical-evolution.la

	* importers/Makefile.am (libevolution_calendar_importers_la_LIBADD):
	libicalvcal.la -> libicalvcal-evolution.la

	
2003-09-19  Rodrigo Moya <rodrigo@ximian.com>

	* idl/evolution-calendar.idl: removed getAlarmsInRange and
	getAlarmsForObject methods.

	* pcs/cal.c (impl_Cal_getAlarmsInRange, impl_Cal_getAlarmsForObject):
	removed unneeded CORBA methods.
	(cal_class_init): dont set removed methods in the epv.

	* pcs/cal-backend.[ch]: removed get_alarms_in_range and
	get_alarms_for_object virtual methods.
	(cal_backend_get_alarms_in_range, cal_backend_get_alarms_for_object):
	removed.
	(cal_backend_class_init): dont set removed virtual methods.

	* pcs/cal-backend-file.c (cal_backend_file_get_alarms_in_range,
	cal_backend_file_get_alarms_for_object): removed.
	(cal_backend_file_class_init): dont set removed virtual methods.

2003-09-19  Rodrigo Moya <rodrigo@ximian.com>

	* cal-client/cal-client.c (cal_client_get_alarms_in_range): changed
	to use queries.
	(build_component_alarms_list): create the alarm list from a list
	of iCalendar strings.
	(build_alarm_instance_list): removed.
	(cal_client_get_alarms_for_object): dont call the CORBA methods,
	just get alarms by itself.

2003-09-18  Rodrigo Moya <rodrigo@ximian.com>

	* cal-client/cal-listener.[ch]: added "add_timezone" signal.
	(impl_notifyTimezoneAdded): implemented new CalListener method.
	(cal_listener_class_init): create "add_timezone" signal for the class.

	* cal-client/cal-client.[ch] (cal_client_add_timezone): new function.
	(cal_client_init): connect to "add_timezone" signal on the
	CalListener.
	(cal_add_timezone_cb): callback for the "add_timezone" signal.

2003-09-18  Rodrigo Moya <rodrigo@ximian.com>

	* idl/evolution-calendar.idl: added 'notifyTimezoneAdded' method
	to the Calendar::Listener interface.

	* pcs/cal-backend-sync.[ch] (cal_backend_sync_add_timezone):
	(_cal_backend_add_timezone): new functions for the new virtual
	method implementation.

	* pcs/cal.[ch] (cal_notify_timezone_added): new function.

	* pcs/cal-backend-file.c (cal_backend_add_timezone): converted to
	return a CalBackendSyncStatus.
	(cal_backend_file_class_init): the 'add_timezone' method we implement
	is the one in the CalBackendSync class.
	(cancel_receive_object): added missing 'return'.
	(free_cal_component): removed unused function.

2003-09-17  Rodrigo Moya <rodrigo@ximian.com>

	* pcs/cal-backend-file.c (cal_backend_add_timezone): added new
	virtual method implementation.

	* pcs/cal.c (impl_Cal_addTimezone): check return value from
	cal_backend_add_timezone, and set an exception if an error is
	returned.

2003-09-16  Rodrigo Moya <rodrigo@ximian.com>

	* idl/evolution-calendar.idl: added addTimezone method.

	* pcs/cal.c (impl_Cal_addTimezone): implemented new method.
	(cal_class_init): set new method on the epv.

	* pcs/cal-backend.[ch]: added 'add_timezone' virtual method.
	(cal_backend_add_timezone): implemented new virtual method.

	* pcs/cal-backend-file.c (cal_backend_file_modify_object): it's
	cal_component_get_as_string, not cal_component_as_string.

	* cal-client/cal-client.c (cal_client_ensure_timezone_on_server):
	dont use anymore updateObjects method, use addTimezone instead.
	
2003-09-16  Rodrigo Moya <rodrigo@ximian.com>

	* conduits/todo/Makefile.am: removed libwombat reference.

2003-09-15  Rodrigo Moya <rodrigo@ximian.com>

	* pcs/cal-backend-file.c (cal_backend_file_create_object): return
	the UID of the added object.
	(cal_backend_file_remove_object): ditto for old_object.

2003-09-15  JP Rosevear <jpr@ximian.com>

	* conduits/todo/todo-conduit.c (replace_record): switch to modify
	object
	(add_record): switch to using create object

	* conduits/calendar/calendar-conduit.c (process_multi_day): switch
	to using create object
	(add_record): switch to using create object
	(replace_record): switch to modify object

	* cal-client/cal-listener.h: add signals

	* cal-client/cal-listener.c (impl_notifyObjectsReceived):
	implement listener method
	(build_object_list): ditto
	(cal_listener_class_init): create receive_objects and send_objects
	signals

	* cal-client/cal-client.h: add, update protos

	* cal-client/cal-client.c (cal_objects_received_cb):
	receive_objects callback
	(cal_objects_sent_cb): send_objects callback
	(cal_client_init): listen for above signals
	(cal_client_create_object): pass back uid
	(cal_client_receive_objects): implement
	(cal_client_send_objects): ditto

	* idl/evolution-calendar.idl: add receive/send objects methods and
	yank updateObjects

	* pcs/cal.h: add protos

	* pcs/cal.c (impl_Cal_receiveObjects): implement
	(impl_Cal_sendObjects): ditto
	(cal_class_init): add epv methods
	(cal_notify_objects_received): notify of objects received call,
	updating queries
	(cal_notify_objects_sent): notify of objects sent

	* pcs/cal-backend.h: remove proto

	* pcs/cal-backend.c (cal_backend_class_init): remove obj_updated
	signal
	(cal_backend_class_init): init vmethods properly
	(cal_backend_receive_objects): call through
	(cal_backend_send_objects): ditto

	* pcs/cal-backend-sync.h: add protos, vmethods

	* pcs/cal-backend-sync.c (cal_backend_sync_receive_objects): call
	through
	(cal_backend_sync_send_objects): ditto
	(_cal_backend_receive_objects): call backend method and notify
	(_cal_backend_send_objects): ditto
	(cal_backend_sync_class_init): override send/receive object
	vmethods

	* pcs/cal-backend-file.c (cal_backend_file_class_init): set
	remove/send objects sync vmethods
	(cal_backend_file_create_object): remove call to dead method
	(cal_backend_file_remove_object): ditto
	(cal_backend_file_modify_object): ditto
	(cancel_received_object): cancel an object
	(check_tzids): check we have all the tzid's for the object
	(cal_backend_file_receive_objects): receive a bunch of objects via
	itip
	(cal_backend_file_send_objects): skeleton implementation

2003-09-15  Rodrigo Moya <rodrigo@ximian.com>

	* idl/evolution-calendar.idl: added InvalidObject CallStatus.

	* pcs/cal-backend-file.c (cal_backend_file_create_object): implemented.
	(cal_backend_file_modify_object): implemented.

2003-09-15  Harry Lu  <harry.lu@sun.com>

	* gui/apps_evolution_calendar.schemas: change last_notification_time's
	type from string to int.

2003-09-12  Bolian Yin <bolian.yin@sun.com>

	* e-week-view.c (e_week_view_focus): make jump button focusable
	 (e_week_view_on_jump_button_event): key_press and focus event for jump button
	 (e_week_view_jump_to_button_item): new function, jump to the day view.
	 (e_week_view_is_jump_button_visible): new function.

	
2003-09-12  Rodrigo Moya <rodrigo@ximian.com>

	* pcs/cal.c (cal_notify_cal_address, cal_notify_alarm_email_address,
	cal_notify_ldap_attribute, cal_notify_static_capability):
	make sure we always notify listeners, regardless of whether the
	string is empty or not.

	* cal-client/cal-client.c (check_capability): guard against using
	NULL strings with strstr.

2003-09-12  JP Rosevear <jpr@ximian.com>

	* cal-client/client-test.c (cal_opened_cb): listen for other query
	signals

	* cal-client/cal-listener.h: add signals

	* cal-client/cal-listener.c (impl_notifyObjectCreated): implement
	(impl_notifyObjectModified): implement
	(cal_listener_class_init): assign epv implementations
	(cal_listener_class_init): add create/modify object signals

	* cal-client/cal-client.h: add protos

	* cal-client/cal-client.c (cal_object_created_cb): object created
	callback
	(cal_object_modified_cb): object modified callback
	(cal_client_init): listen for create/modify object signals from
	the listener
	(cal_client_create_object): call the create object method
	(cal_client_modify_object): call the modify object method

	* cal-client/client-test.c (cal_opened_cb): listen for all the
	query signals, tidy

2003-09-12  JP Rosevear <jpr@ximian.com>

	* pcs/cal.c (impl_Cal_createObject): implement
	(impl_Cal_modifyObject): ditto
	(cal_class_init): set epv methods for create/modify

	* pcs/cal-backend.h: add protos, vmethod

	* pcs/cal-backend.c (cal_backend_class_init): init new vmethods
	(cal_backend_create_object): call through
	(cal_backend_modify_object): ditto

	* pcs/cal-backend-sync.h: add protos, vmethods

	* pcs/cal-backend-sync.c (cal_backend_sync_create_object): call
	through
	(cal_backend_sync_modify_object): ditto
	(_cal_backend_create_object): create object and notify
	(_cal_backend_modify_object): modify object and notify

	* pcs/cal-backend-file.c (cal_backend_file_create_object):
	skeleton routine for creating objects
	(cal_backend_file_modify_object): ditto for modifying

	* idl/evolution-calendar.idl: add createObject and modifyObject
	calls

2003-09-12  JP Rosevear  <jpr@ximian.com>

	* pcs/cal.c (cal_notify_object_removed): its uid, not uids

2003-09-12  JP Rosevear <jpr@ximian.com>

	* pcs/query.h: add protos

	* pcs/query.c (query_object_matches): use the sexp to check for a
	match
	(query_notify_objects_added_1): notify of one object added to
	query
	(query_notify_objects_modified_1): ditto for modification
	(query_notify_objects_removed_1): ditto for removal

	* pcs/cal.h: add protos

	* pcs/cal.c (cal_notify_object_created): notify of object creation
	(cal_notify_object_modified): notify of object modification
	(cal_notify_object_removed): use the _1 routines

	* pcs/cal-backend-file.c (match_recurrence_sexp): this returns a
	boolean
	(cal_backend_file_update_objects): don't signal removals here now

	* idl/evolution-calendar.idl: add object created and modified
	responses

	
2003-09-11  JP Rosevear <jpr@ximian.com>

	* pcs/cal.h: update proto

	* pcs/cal.c (cal_notify_object_removed): notify relevant queries
	of removal

	* pcs/cal-backend.c (cal_backend_get_queries): ref the list before
	passing it back

	* pcs/cal-backend-sync.c (_cal_backend_remove_object): pass uid to
	notification

2003-09-11  JP Rosevear <jpr@ximian.com>

	* pcs/cal-backend-file.c (match_recurrence_sexp): don't unref the
	component

	* cal-client/client-test.c (cal_opened_cb): listen to objects
	added signal
	(objects_added_cb): print the object uid
	
2003-09-11  JP Rosevear <jpr@ximian.com>

	* pcs/cal-backend-object-sexp.c (cal_backend_object_sexp_text):
	return the base text

2003-09-11  JP Rosevear <jpr@ximian.com>

	* gui/gnome-cal.c (update_query): fix c/p typo

2003-09-11  JP Rosevear <jpr@ximian.com>

	* gui/gnome-cal.c (update_query): start the query

	* gui/e-cal-model.c (update_query_for_client): ditto

	* cal-client/client-test.c (cal_opened_cb): ditto
	
2003-09-11  JP Rosevear <jpr@ximian.com>

	* cal-client/cal-query.h: add proto

	* cal-client/cal-query.c (cal_query_start): start the query

2003-09-11  JP Rosevear <jpr@ximian.com>

	* gui/dialogs/delete-error.c (delete_error_dialog): accept GError
	and base error messages on that

	* gui/dialogs/delete-error.h: update proto

	* gui/e-tasks.c (e_tasks_delete_completed): pass extra param to
	cal_client_remove_object

	* conduits/todo/todo-conduit.c (delete_record): ditto

	* conduits/calendar/calendar-conduit.c (process_multi_day): ditto
	(delete_record): ditto
	
	* gui/gnome-cal.c (gnome_calendar_purge): ditto

	* gui/dialogs/comp-editor.c (delete_comp): ditto
	
	* gui/e-cal-view.c (e_cal_view_cut_clipboard): pass the error to
	delete_error_dialog
	(delete_event): ditto
	(e_cal_view_delete_selected_occurrence): ditto
	
	* gui/e-itip-control.c (remove_item): ditto

	* gui/e-calendar-table.c (delete_selected_components): ditto

	* cal-client/cal-listener.h: add signal

	* cal-client/cal-listener.c (impl_notifyObjectRemoved): implement
	(cal_listener_class_init): set object removed implementation and
	create signal

	* cal-client/cal-client.h: update protos

	* cal-client/cal-client.c (cal_object_removed_cb): object removal
	callback
	(cal_client_init): listen for object removal signal
	(cal_client_remove_object_with_mod): make call synchronous
	(cal_client_remove_object): pass new params

	* pcs/cal.h: add proto

	* pcs/cal.c (impl_Cal_removeObject): just call the backend
	function
	(cal_notify_object_removed): notify of removal

	* pcs/cal-backend.h: remove and update protos, remove signal

	* pcs/cal-backend.c (cal_backend_class_init): kill obj_removed
	signal
	(cal_backend_remove_object): there is no return value now

	* pcs/cal-backend-sync.h: add vmethod, proto

	* pcs/cal-backend-sync.c (cal_backend_sync_remove_object): call
	through
	(_cal_backend_remove_object): remove the object and then do the
	notification

	* pcs/cal-backend-file.c (cal_backend_file_class_init): remove
	object is not part of the sync class
	(cal_backend_file_update_objects): there is no more removed signal
	(cal_backend_file_remove_object): return sync status codes

	* idl/evolution-calendar.idl: make removeObject oneway and and a
	notification method in the listener

2003-09-11  Rodrigo Moya <rodrigo@ximian.com>

	* pcs/query.[ch] (query_get_text): new function.
	(query_get_object_sexp): new function.

	* pcs/cal-backend-file.c (cal_backend_file_start_query): implemented.

2003-09-11  Hans Petter Jansson  <hpj@ximian.com>

	* cal-util/Makefile.am (libcal_util_la_LIBADD):
	libical-evolution.la -> libical.la

	* cal-util/cal-component.c (cal_component_get_classification)
	(cal_component_set_classification)
	(get_text_list)
	(get_icaltimetype)
	(get_datetime)
	(get_period_list)
	(get_recur_list)
	(cal_component_get_transparency)
	(cal_component_set_transparency): Adapt to new libical.

	* cal-util/cal-util.c (cal_util_event_dates_match): Ditto.

	* pcs/cal-backend-file.c (create_user_free_busy): Ditto.

	* gui/e-cal-model-tasks.c (get_completed)
	(get_due)
	(get_due_status): Ditto.

	* gui/e-cal-model.c (get_dtstart)
	(set_classification): Ditto.

	* gui/e-cal-model-calendar.c (get_dtend)
	(get_transparency)
	(set_transparency): Adapt to new libical and fix a comparison bug.

	* importers/Makefile.am (libevolution_calendar_importers_la_LIBADD):
	libical-evolution.la -> libical.la

2003-09-11  Dan Winship  <danw@ximian.com>

	* cal-util/Makefile.am (privlib_LTLIBRARIES): Remove
	libcal-util-static.la

	* cal-client/Makefile.am (noinst_LTLIBRARIES): Remove
	libcal-client-static.la

	* conduits/calendar/Makefile.am (libecalendar_conduit_la_LIBADD):
	use non-static libraries. The static ones were only needed for
	libtool 1.3.

	* conduits/todo/Makefile.am (libetodo_conduit_la_LIBADD): Likewise

        * gui/Makefile.am (IDL_GENERATED): Don't compile the calendar idl
        here. It's already in libcal-client.

2003-09-11  Frederic Crozat  <fcrozat@mandrakesoft.com>

	* conduits/todo/Makefile.am:
	Statically link with wombat. Fix ETodo conduit.
	(Mdk bug #5348)

	
2003-09-10  JP Rosevear  <jpr@ximian.com>

	* pcs/cal.h: update proto

	* pcs/cal.c (impl_Cal_getObjectList): just call the backend, it
	will do the notification now
	(cal_notify_object_list): the list is a list of strings

	* pcs/cal-backend.h: update vmethod, proto

	* pcs/cal-backend.c (cal_backend_get_object_list): call through

	* pcs/cal-backend-sync.h: add proto, vmethod

	* pcs/cal-backend-sync.c (cal_backend_sync_get_object_list): call
	through
	(_cal_backend_get_object_list): get the list of objects from the
	sync backend and do the notification
	(cal_backend_sync_class_init): set vmethod implementation

	* pcs/cal-backend-file.c (cal_backend_file_class_init): the get
	object list call is now part of the sync backend
	(cal_backend_file_get_object_list): return a status and put the
	object list in the passed in param

2003-09-10  JP Rosevear  <jpr@ximian.com>

	* pcs/cal-backend.c (cal_backend_finalize): unref the elist
	(cal_backend_init): init the query elist

2003-09-10  JP Rosevear <jpr@ximian.com>

	* gui/gnome-cal.c (dn_query_objects_added_cb): match new query
	signals - just tag here
	(dn_query_objects_modified_cb): always retag
	(dn_query_objects_removed_cb): ditto
	(update_query): connect to new signals
	(gnome_calendar_destroy): we don't keep a list of expunging
	queries
	(gnome_calendar_purge): no need to do the
	expunge async, just get the object list immediately

	* gui/e-tasks.c (e_tasks_delete_completed): no need to do the
	expunge async, just get the object list immediately

	* gui/e-cal-model.c (query_objects_added_cb): callback for objects
	added to the query
	(query_objects_modified_cb): ditto for modifications
	(query_objects_removed_cb): ditto for removed
	(query_progress_cb): progress of the query
	(query_done_cb): query is done
	(update_query_for_client): connect to the new signals

	* cal-client/client-test.c (cal_opened_cb): run a query

	* cal-client/cal-query.c: we are given the listener now - listen
	for signals from the listener and emit signals matching the api
	changes

	* cal-client/query-listener.[hc]: rewrite to match new query
	listener methods and emit signals rather than using function
	callbacks

	* cal-client/cal-marshal.list: add to marshallers

	* cal-client/cal-listener.h: add query signal

	* cal-client/cal-listener.c (impl_notifyQuery): implement
	(cal_listener_class_init): set notifyQuery method
	(cal_listener_class_init): add query signal

	* cal-client/cal-client.h: update protos

	* cal-client/cal-client.c (cal_query_cb): handle response to
	getQuery
	(cal_client_init): listen for query signal
	(cal_client_get_query): get a query from the calendar

	* pcs/query.h: update protos

	* pcs/query.c: rewrite to implement the query start method and
	provide notification calls

	* pcs/cal.h: add proto

	* pcs/cal.c (impl_Cal_getQuery): re-implement so the backend
	doesn't create the query for us
	(cal_notify_query): respond with the query

	* pcs/cal-factory.c: re-order includes

	* pcs/cal-common.h: add types

	* pcs/cal-backend.h: update protos, vmethods

	* pcs/cal-backend.c (cal_backend_class_init): init start_query
	vmethod
	(cal_backend_finalize): free mutex
	(cal_backend_start_query): call through
	(cal_backend_add_query): add a query to the list the backend is
	running
	(cal_backend_get_queries): get the query list

	* pcs/cal-backend-object-sexp.h: add proto

	* pcs/cal-backend-file.c (cal_backend_file_start_query): skeleton
	for new backend implementation

	* pcs/Makefile.am: don't build dead files

	* idl/evolution-calendar.idl: make the getQuery call async, make
	the query listener calls oneway and match the addressbook

2003-09-09  Rodrigo Moya <rodrigo@ximian.com>

	* pcs/cal-backend-file.c (cal_backend_file_get_object_component):
	added case for getting the individual recurrences if 'rid' is
	not NULL,

2003-09-09  Rodrigo Moya <rodrigo@ximian.com>

	* pcs/cal-backend-file.c (match_object_sexp): expand recurrences
	for recurrent objects.
	(match_recurrence_sexp): add the recurrences that match the query
	expression to the object list.

2003-09-08  Rodrigo Moya <rodrigo@ximian.com>

	* pcs/cal-backend-file.c: don't store all recurrences in the
	private structure.
	
2003-09-04  Rodrigo Moya <rodrigo@ximian.com>

	* gui/e-day-vie
